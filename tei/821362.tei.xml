<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="file:///home/joseph/Desktop/grobid/grobid-home/schemas/rng/Grobid.rng" schematypens="http://relaxng.org/ns/structure/1.0"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Upper limits from counting experiments with multiple pipelines</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2010-04-07">7 Apr 2010</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName>
								<forename type="first">Patrick</forename>
								<forename type="middle">J</forename>
								<surname>Sutton</surname>
							</persName>
							<email>E-mail: patrick.sutton@astro.cf.ac.uk</email>
							<affiliation>
								<orgName type="department">School of Physics and Astronomy</orgName>
								<orgName type="institution">Cardiff University</orgName>
								<address>
									<postCode>CF24 3AA</postCode>
									<settlement>Cardiff</settlement>
									<country key="GB">United Kingdom</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Upper limits from counting experiments with multiple pipelines</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2010-04-07">7 Apr 2010</date>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords scheme="pacs">PACS numbers: 0620Dk, 0480Nn</keywords>
			</textClass>
			<abstract>
				<p>In counting experiments, one can set an upper limit on the rate of a Poisson process based on a count of the number of events observed due to the process. In some experiments, one makes several counts of the number of events, using different instruments, different event detection algorithms, or observations over multiple time intervals. We demonstrate how to generalize the classical frequentist upper limit calculation to the case where multiple counts of events are made over one or more time intervals using several (not necessarily independent) procedures. We show how different choices of the rank ordering of possible outcomes in the space of counts correspond to applying different levels of significance to the various measurements. We propose an ordering that is matched to the sensitivity of the different measurement procedures and show that in typical cases it gives stronger upper limits than other choices. As an example, we show how this method can be applied to searches for gravitational-wave bursts, where multiple burst-detection algorithms analyse the same data set, and demonstrate how a single combined upper limit can be set on the gravitational-wave burst rate.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
			<div>
				<head n="1">Introduction</head>

				<p>One of the most familiar applications of classical confidence intervals is to the counting experiment, in which one attempts to measure or place a limit on the rate of a physical Poisson process by counting the number of occurrences of the process observed during some period of time. For example, for a single measurement (a single count of events) with low background and an expected physical rate comparable to or lower than the background, one typically sets an upper limit; i.e., a one-sided confidence interval. Given a count n, the upper limit is that value of the physical rate such that the a priori probability of measuring more than n events in the experiment exceeds some chosen confidence level. Various issues may complicate the procedure for setting the upper limit. For example, if the background is large, there is a well-known problem that the upper confidence limit may be the empty set when the observed number of events is much lower than that expected from the background. Another more subtle issue is that the decision to report an upper limit versus a two-sided confidence interval can, if based on the data, cause undercoverage, rendering the procedure invalid. Techniques for addressing these issues have been presented in the literature, for example, by the Feldman-Cousins technique [1] and the loudest event technique [2, 3]. These can also be addressed by Bayesian methods; see for example [3, 4, 5, 6, 7, 8].</p>

				<p>In this paper we are concerned with a different complication: when more than one count is made of the number of events. One example of where this situation arises is searches for gravitational-wave (GW) bursts with LIGO and similar detectors [9, 10, 11].</p>

				<p>In this scenario the GW signals are expected to have amplitudes near the noise floor of the detectors, and the rate of detectable events is expected to be of order the inverse of the observation time or less. To improve chances of detection, multiple algorithms are used to analyse the data [12, 13, 14], each producing its own list of candidate GW bursts. The event lists produced by these algorithms, however, are not completely independent. They will generally show some correlation between which foreground events they detect, and may also show some correlation between the background noise fluctuations they detect. Furthermore, the data set itself typically is not of uniform sensitivity. For example, the longest data-collection run to date for the LIGO-GEO- Virgo network lasted more than two years [15]. Over this time the sensitivity of each of the instruments changed, and at any given time during the run, anywhere between 1 and 5 detectors may have been operating. The challenge to the data analyst in such an experiment is this: given multiple counts of events collected from processing several data sets of different sensitivities and with different algorithms, how does one set a single limit on the physical event rate? There are many options. The simplest is to take the union of all of the event lists and observation time, effectively converting the multiple observations into a single observation, and computing the upper limit using a standard technique. This approach ignores differences in the quality of the data from the different epochs, and in the algorithms themselves. Alternatives include discarding results from select data sets or algorithms (presumably the less sensitive ones), again with the aim of reducing the observations to effectively a single count. These approaches invariably involve loss of information from the experiment. Intuitively, one expects to be able to set stronger limits if one uses all of the information from the experiment rather than only a subset of the information.</p>

				<p>In this article we propose a general formalism for setting classical upper limits on experiments involving multiple pipelines, where a pipeline denotes the analysis of a single data set by a single algorithm. We characterize the observational results and the sensitivities of the experiment in terms of logical combinations of pipelines. We show that various choices such as taking the union of data sets correspond to particular choices of weighting of measurements. We propose a specific weighting choice based on the efficiencies (sensitivities) of the logical combinations, and show that it gives stronger upper limits than other choices in typical cases. Furthermore, the efficiency weighting choice makes use of all of the experiment results, naturally handles correlated measurements, and tends to be robust against occasional background contamination of counts. This paper is organized as follows. In Section 2 we review how one sets a classical upper limit on the rate of a Poisson-distributed process in a counting experiment. In Section 3 we generalize the single-count procedure to the case of multiple counts. We discuss various choices of the weighting to obtain upper limits, including our sensitivitybased proposal. We demonstrate each procedure for the case of a counting experiment using two pipelines, with and without background. In Section 4 we demonstrate how the same procedure naturally handles multiple data sets. Section 5 contains a few brief remarks on the applicability of the method.</p>

			</div>
			<div>
				<head n="2">Single-Pipeline Case</head>

				<p>We briefly review how one sets a classical upper limit (a one-sided confidence interval) on the rate of a Poisson-distributed process via a counting experiment. Consider an experiment that measures the number of events of a specific random process that occurs in a time T . We assume that the foreground events occur independently of one another, with a mean rate µ that is unknown a priori. We further assume that the experiment has a probability ǫ of successfully detecting (counting) any given event. Finally, we assume that the mean number of background events (due to &quot; noise &quot; or effects other than the physical effect of interest) in time T is b. Then the actual total number of events (foreground plus background) that will be counted in a given time T is Poisson distributed, as is easily demonstrated.</p>

				<p>Let us divide the observation time T into M equal sub-intervals of length T /M.</p>

				<p>In the limit of large M, the probability of one event being detected in any given subinterval is (ǫµT + b)/M ≪ 1, and the probability of more than one event in the same interval is negligible. The probability of detecting a total of N events over the full time T is derived from binomial statistics as the probability of N &quot; successes &quot; in M &quot; trials &quot; . Defining λ ≡ µT as the expected mean number of foreground events occurring, we have</p>

				<figure>
					<trash>P (N|ǫλ + b) = lim M →∞ M N ǫλ + b M N 1 − ǫλ + b M M −N = (ǫλ + b) N N! e −(ǫλ+b) . (1)</trash>


				</figure>

				<p>This is the familiar Poisson distribution for a process with mean number of detected events ǫλ + b. Given an actual measured number n, the Poisson distribution (1) can be used to set an upper limit on the value of λ, or equivalently on µ. Heuristically, values of λ much larger than (n − b)/ǫ are unlikely to produce only n detected events. More formally, we select a confidence level α ∈ (0, 1). The frequentist upper limit λ α at confidence level α given n measured events is that value of λ at which there is an a priori probability α of measuring more than n events. Implicitly, λ α is given by</p>

				<figure>
					<trash>α = ∞ N =n+1 P (N|ǫλ α + b) = 1 − n N =0 P (N|ǫλ α + b) . (2)</trash>


				</figure>

				<p>We define the cumulative probability C(n|ǫλ + b) as the a priori probability of detecting n or fewer events:</p>

				<figure>
					<trash>C(n|ǫλ + b) ≡ n N =0 P (N|ǫλ + b) . (3)</trash>


				</figure>

				<p>We can write the upper limit formula for λ α as C(n|ǫλ α + b) = 1 − α . (4)</p>

				<p>For example, the 90% confidence level (α = 0.9) upper limit for zero observed events (n = 0) and zero background (b = 0) is</p>

				<figure>
					<trash>0.1 = C(0|ǫλ 90% ) = e −ǫλ 90% , λ 90% = 2.30 ǫ . (5) For n = 1 observed events the upper limit is higher (weaker): 0.1 = (1 + ǫλ 90% )e −ǫλ 90% , λ 90% = 3.89 ǫ . (6)</trash>


				</figure>

				<p>To be rigorous, one must prove that the upper limit formula (4) has a coverage of at least α. The coverage is defined as the fraction of measurements in an ensemble of identical experiments for which the derived upper limit is greater than or equal to the true rate λ true . To be a valid upper limit with confidence level α, one must show that λ α ≥ λ true in a fraction ≥ α of experiments for any possible value of λ true . It is straightforward to prove that the upper limit formula (4) has the coverage α.</p>

				<p>First, we note two properties ‡ of C(n|ǫλ + b):</p>

				<figure>
					<trash>C(n|ǫλ + b) &gt; C(m|ǫλ + b) for n &gt; m ; (7) dC(n|ǫλ + b) dλ &lt; 0 . (8)</trash>


				</figure>

				<p>Let us suppose that the true value of the rate is λ true . Let m be the largest integer such that C(m|ǫλ true + b) ≤ 1 − α. By definition of m, in a fraction ≥ α of experiments the measured number of events n will be larger than m. For these cases C(n|ǫλ true + b) &gt; 1 − α. Applying the upper limit formula (4) and noting (8), we see that in these cases the derived upper limit λ α will be greater than λ true . The coverage is thus established. We should note that one has the freedom to ignore the experimental background when computing the upper limit; i.e., one may use the approximation b = 0. Since the background will increase n above the value due to the physics of interest, the upper limit derived using b = 0 remains valid (provides minimum coverage), though it will be higher than if we had accounted for the background. We will use this approximation in some of our worked examples.</p>

				<p>We also note the well-known phenomenon that the classical one-sided confidence interval procedure can produce an empty upper limit when the number of observed events is much lower than the background. For example, for n = 0 observed events and b = 3 the 90% upper limit is the solution of</p>

				<figure>
					<trash>0.1 = C(0|ǫλ 90% + 3) = e −ǫλ 90% −3 . (9)</trash>


				</figure>

				<p>This has no solution with λ 90% ≥ 0. Methods for handling this issue have been proposed, for example, by Feldman and Cousins [1]. In this paper we consider only one-sided confidence intervals, and therefore we will restrict ourselves to case where b 1.</p>

			</div>
			<div>
				<head n="3">Multiple-Pipeline Case 3.1. Formulation</head>

				<p>The simplest example of a multiple-pipeline experiment is one in which two different methods or &quot; pipelines &quot; are used to count events (by processing the same data, watching the same sky, etc.) over the same epoch T . (We&apos;ll consider the case of disjoint data sets in Section 4.) Denote the pipelines by A and B. Any given event may be detected by pipeline A only, by pipeline B only, by both A and B, or by neither pipeline. We characterize the sensitivity of the experiment by the three numbers ǫ A , ǫ B , and ǫ AB : ǫ A : The probability that any given foreground event will be detected by pipeline A but not detected by pipeline B; ǫ B : The probability that any given foreground event will be detected by pipeline B but not detected by pipeline A; ǫ AB : The probability that any given foreground event will be detected by both pipeline A and pipeline B.</p>

				<p>We denote the expected background by the three numbers b A , b B , and b AB :</p>

				<p><formula>b</formula></p>

				<figure>
					<figDesc>A : The expected number of background events detected by pipeline A but not detected by pipeline B; b B : The expected number of background events detected by pipeline B but not detected by pipeline A; and b AB : The expected number of background events detected by both pipeline A and pipeline B.</figDesc>

				</figure>

				<p>Finally, the outcome of the counting experiment is the set of three numbers n A , n B , and n AB :</p>

				<p><formula>n</formula></p>

				<figure>
					<figDesc>A : The number of events detected by pipeline A but not detected by pipeline B; n B : The number of events detected by pipeline B but not detected by pipeline A; and n AB : The number of events detected by both pipeline A and pipeline B.</figDesc>

				</figure>

				<p>To interpret (n A , n B , n AB ) in terms of an upper limit on λ, we first need to compute the joint probability P ((n A , n B , n AB |λ, ǫ A , ǫ B , ǫ AB , b A , b B , b AB ). This is straightforward; repeating the logic of the single-pipeline case, it is easy to see that</p>

				<figure>
					<trash>P (N A , N B , N AB |λ, ǫ A , ǫ B , ǫ AB , b A , b B , b AB ) = lim M →∞ M N A M − N A N B M − N A − N B N AB × ǫ A λ + b A M N A ǫ B λ + b B M N B × ǫ AB λ + b AB M N AB 1 − ǫ T OT λ + b T OT M M −N T OT = P (N A |ǫ A λ + b A )P (N B |ǫ B λ + b B )P (N AB |ǫ AB λ + b AB ) . (10) Here we have defined the total number of events detected, N T OT ≡ N A + N B + N AB , (11) the total number of events expected from background, b T OT ≡ b A + b B + b AB , (12) and the probability of a given foreground event being detected by any combination of pipelines, ǫ T OT ≡ ǫ A + ǫ B + ǫ AB . (13)</trash>


				</figure>

				<p>We see that by choosing to characterize the outcome of the experiment by the number of events detected by logical combinations of pipelines, the joint probability factorizes to the product of single-pipeline probabilities (1). The measurements of N A , N B , and N AB can therefore be regarded as statistically independent experiments. This is a key simplification that makes deriving a combined upper limit straightforward.</p>

				<p>In the general case of p pipelines, there are q ≡ 2 p − 1 distinct combinations by which an event may be detected. Using the vector notation N , ǫ, and b, where the vector index i ∈ [1,</p>

				<figure>
					<trash>. . . , q] labels the distinct combinations, we have P ( N|λ ǫ + b) = q i=1 P (N i |λǫ i + b i ) . (14) 3.2. Defining an Upper Limit</trash>


				</figure>

				<p>To set an upper limit we need first to define a cumulative probability distribution C( n|λ ǫ + b) corresponding to (14), analogous to (3). Since the space of observation { N} is multi-dimensional, we have a great deal of freedom in how we choose to sum over { N} to define the cumulative distribution. Put another way, we must chose a rank ordering of { N}. (For an unbiased limit, this must be done before the measurement of n.) To construct a confidence belt, we choose a one-parameter family of surfaces S(ζ) that foliates the observation space { N}. This family is chosen so that for every value of the parameter ζ, the surface S(ζ) divides the space { N} into two regions: a acceptance region of low number of events (including the origin, and the surface S(ζ) itself), and a rejection region of high number of events. Our choice of the family S(ζ) is arbitrary, except that the outward normal to each surface must have non-negative components everywhere; this is required to prove coverage, as shown below. As we shall see, our freedom in the choice of the S(ζ) corresponds to how the various pipelines are &quot; weighted &quot; in contributing to the upper limit. Because of the foliation, every point N in the observation space lies on exactly one such surface, which we refer to as an exclusion surface. Hence, each point N can be associated with a single parameter value, ζ( N). This gives us a rank ordering of the N defining whether a given N ′ contains &quot; more, &quot; the &quot; same, &quot; or &quot; fewer &quot; events than N ′′ .</p>

				<p>The family S(ζ) therefore maps the multi-dimensional space { N} to a one-dimensional space. This allows us to define a cumulative probability C S ( n|λ ǫ + b) by</p>

				<figure>
					<trash>C S ( n|λ ǫ + b) ≡ N |ζ( N)≤ζ( n) P ( N|λ ǫ + b) , (15)</trash>


				</figure>

				<p>where the sum is taken over all N for which ζ( N) ≤ ζ( n); i.e., over all N that contain as few events or fewer than n. Given a family of exclusion surfaces S(ζ) and a measured number of events n, we may use the cumulative probability C S to set an upper limit on λ in the same way as is done for the single-pipeline case. Specifically, for a measured number of events n, the upper limit λ α at confidence level α is C S ( n|λ α ǫ + b) = 1 − α . (16)</p>

				<p>That is, the upper limit λ α on the rate is that value for which in a fraction α of an ensemble of experiments one would measure a number of events that falls in the rejection region of S(ζ( n)). Put another way, the upper limit is the rate for which one should measure &quot; more &quot; than n events (a value of ζ larger than ζ( n)) in a fraction α of an ensemble of experiments. We will consider various simple choices of families S(ζ) and their interpretations shortly. First, however, we prove that the algorithm (16) has coverage α.</p>

			</div>
			<div>
				<head n="3.3">Coverage</head>

				<p>We now prove that the upper limit formula (16) has a coverage of at least α. The proof follows that for the single-pipeline case in Section 2. Again, we note two properties of</p>

				<figure>
					<trash>C S ( n|λ ǫ + b): C S ( n|λ ǫ + b) &gt; C S ( m|λ ǫ + b) for ζ( n) &gt; ζ( m) ; (17) dC S ( n|λ ǫ + b) dλ &lt; 0 . (18)</trash>


				</figure>

			</div>
			<div>
				<head>(See Appendix</head>

				<p>Appendix A for the proof of (18).) Let us suppose that the true value of the rate is λ true . Let m be the vector with nonnegative integer components and with the largest value of ζ( m) such that C S ( m|λ true ǫ + b) ≤ 1 − α. By definition of m, in a fraction ≥ α of experiments the measured number of events n will have ζ( n) &gt; ζ( m). For these cases C S (ζ( n)|λ true ǫ + b) &gt; 1 − α. Applying the upper limit formula (16) and noting (18), we see that in these cases the derived upper limit λ α will be greater than λ true . The coverage is thus established. As stated before, our choice of exclusion surfaces is arbitrary except that the outward normal to the contour must have non-negative components everywhere. This restriction ensures that equation (18) is valid, which in turn is required to prove coverage. As in the single-pipeline case, we may chose to ignore the background and use b = 0 when computing upper limits. Since a non-zero background contribution will increase the measured ζ over its zero-background value, from (16)-(18) it follows that the limit will be higher than that computed accounting for the background, but coverage will be maintained.</p>

			</div>
			<div>
				<head n="3.4">Choosing Exclusion Surfaces</head>

				<p>We now turn to the question of how to select the family of exclusion surfaces to obtain the strongest limits. For simplicity, we restrict ourselves henceforth to the simple case of plane surfaces. In this case, a family of exclusion surfaces is set by choosing the vector k that is normal to the planes. The parameter for the family is then ζ( N) = k · N (the magnitude of k is irrelevant). For a given observation n the upper limit λ α is given by</p>

				<figure>
					<trash>C k ( n|λ α ǫ + b) ≡ N |( n− N )· k≥0 P ( N|λ α ǫ + b) = 1 − α . (19) Note that the sum is taken over all N satisfying the condition ( n − N) · k ≥ 0 . (20)</trash>


				</figure>

				<p>We now explore several simple choices of exclusion surfaces with ready physical interpretations: taking the logical AND or OR combinations of pipelines, and using only the most sensitive pipeline. We then propose a new choice of exclusion surfaces: k = ǫ; i.e., we weight the measurements by the relative sensitivity of their pipelines.</p>

				<p>We show that this efficiency-weighted approach has several advantages over the other choices discussed. In particular, it gives upper limits that are better than those from the other common choices for most outcomes of the experiment.</p>

			</div>
			<div>
				<head n="3.4.1">OR combination</head>

				<p>One obvious way to orient the exclusion surfaces is to set the normal vector k = (1, 1, . . . , 1). This choice treats all distinct pipeline combinations equally. For a given observation n the upper limit on λ is then given by (16) with the sum taken over all N satisfying the condition</p>

				<figure>
					<trash>i N i ≤ i n i , (21) or simply N T OT ≤ n T OT . (22)</trash>


				</figure>

				<p>That is, the upper limit depends only on the total number of events detected, regardless of which pipelines or combinations of pipelines detected them. We see that this choice of exclusion contour is equivalent to setting an upper limit based on a single pipeline which is formed by taking the &quot; OR &quot; combination of all events detected by all pipelines or combinations of pipelines. For example, consider the case of two pipelines A and B. Let us assume for simplicity that the background is negligible (b A , b B , b AB ≃ 0). If no events are detected, the upper limit at confidence level α = 0.9 is given by</p>

				<figure>
					<trash>0.1 = C k ((0, 0, 0)|λ 90% ǫ) = e −ǫ T OT λ 90% , (23) where ǫ T OT ≡ ǫ A + ǫ B + ǫ AB . This has the solution λ 90% = 2.30 ǫ T OT . (24)</trash>


				</figure>

				<p>This has the same form as in the single-pipeline case, (5), with the replacement ǫ → ǫ T OT .</p>

				<p>Now consider the case of one event detected (it does not matter whether the lone event is detected by A, by B, or by both). The upper limit is given by</p>

				<figure>
					<trash>0.1 = P ((0, 0, 0)|λ 90% ǫ) + P ((1, 0, 0)|λ 90% ǫ) + P ((0, 1, 0)|λ 90% ǫ) + P ((0, 0, 1)|λ 90% ǫ) = (1 + ǫ T OT λ 90% )e −ǫ T OT λ 90% , (25) which has the solution λ 90% = 3.89 ǫ T OT . (26)</trash>


				</figure>

				<p>This again has the same form as in the single-pipeline case, (6), with the replacement ǫ → ǫ T OT .</p>

				<p>The OR combination has the advantage that it has the largest efficiency of any combination, since an event is counted if any of the pipelines detect it. This leads to strong upper limits when no events are detected. The disadvantage is that the background is also summed over all pipeline combinations, potentially leading to a high false alarm rate and poor limits if any of the pipeline samples are contaminated by background. 3.4.2. AND combination A &quot; conservative, &quot; choice for detecting events is to demand that all pipelines observe an event for it to be counted as a possible signal. It is easy to see that this is equivalent to choosing contours with normal vector k = (0, . . . , 0, 1). The upper limit for observation n is then given by (16) with the sum is taken over all N satisfying the condition N q ≤ n q , (27)</p>

				<p>Upper limits from counting experiments with multiple pipelines 10 where n q is the number of events detected in coincidence by all pipelines. Because of the factorization of the joint probability (14), the upper limit becomes</p>

				<figure>
					<trash>1 − α = ∞ N 1 =0 · · · ∞ N q−1 =0 nq Nq=0 P ( N|λ α ǫ + b) = ∞ N 1 =0 P (N 1 |ǫ 1 λ α + b 1 ) · · · ×   ∞ N q−1 =0 P (N q−1 |ǫ q−1 λ α + b q−1 )   × nq Nq=0 P (N q |ǫ q λ α + b q ) = nq Nq=0 P (N q |ǫ q λ α + b q ) , (28)</trash>


				</figure>

				<p>We see that the upper limit reduces to that for an effective single pipeline formed by taking the AND combination of all pipelines. This has the same form as in the singlepipeline case, (5), with the replacement ǫ → ǫ q .</p>

				<p>Consider again the case of two pipelines A and B with low background. Suppose we had decided a priori to compute an AND upper limit. If no events were detected by any pipeline, then the 90% confidence upper limit is given by (5) with ǫ → ǫ AB .</p>

				<figure>
					<trash>λ 90% = 2.30 ǫ AB . (29)</trash>

					<figDesc>Since ǫ AB ≤ ǫ T OT , the AND combination gives a weaker limit for a given number of measured events.</figDesc>

				</figure>

				<p>Now consider the case in which one event is detected. The limit now depends on which pipeline combination detected the event. If only one of the pipelines detected the event, then n q = 0, and the 90% confidence upper limit is given by (29). If both pipelines detected the event then n q = 1 and</p>

				<figure>
					<trash>λ 90% = 3.89 ǫ AB . (30)</trash>


				</figure>

				<p>These have the same form as in the single-pipeline case, (5), (6), with the replacement ǫ → ǫ AB .</p>

				<p>The AND combination has the advantage of being the combination least susceptible to background contamination, since an event is only counted if it is detected by all pipelines. For example, the AND combination is particularly robust if the pipelines have different responses to the background noise. The disadvantage is that the efficiency is also the lowest of any combination, for the same reason. In particular, the AND sensitivity is limited by the least sensitive pipeline.</p>

			</div>
			<div>
				<head n="3.4.3">SINGLE combination</head>

				<p>Another simple choice for setting the upper limit is to consider only the measurement by the single most sensitive pipeline, and ignoring all of the others. The most sensitive pipeline is the one with the largest detection efficiency computed when ignoring the other pipelines; e.g., for the two-pipeline case it is the larger of ǫ A + ǫ AB (for A) or ǫ B + ǫ AB (for B). The procedure for computing the upper limit in this case is simply to apply (4). We note here that it is another special case of the multiple-pipeline procedure. For example, for two pipelines where A is the more sensitive, the SINGLE limit is equivalent to choosing</p>

				<figure>
					<trash>k = (1, 0, 1) . (31)</trash>


				</figure>

				<p>If no events are detected by A, then the 90% confidence upper limit is given by (5) with ǫ → ǫ A + ǫ AB :</p>

				<figure>
					<trash>λ 90% = 2.30 ǫ A + ǫ AB . (32) If one event is detected by A, the limit is λ 90% = 3.89 ǫ A + ǫ AB . (33) The efficiency and background of the SINGLE combination are intermediate between those of the OR and AND combinations.</trash>

					<figDesc>In general, ǫ T OT ≥ ǫ A + ǫ AB ≥ ǫ AB , so for a given number of measured events (for example, 0), OR will give the strongest limit, AND the weakest, and SINGLE an intermediate value. On the other hand, the background is highest for OR and lowest for AND, so there is a greater chance of having n &gt; 0 events in the OR combination. Unfortunately, for an unbiased analysis one must choose the upper limit method before counting events, so it is difficult to make the best choice between the AND, OR, and SINGLE options a</figDesc>
					<trash>priori. 3.4.4. Efficiency-weighted combination The AND, OR, and SINGLE options are just three examples of how one may select the exclusion surfaces for the multiple-pipeline counting experiment. As just discussed, the relative strength of the upper limits one can achieve with these options depends on the number of events detected by each pipeline combination, which one does not know a priori in a blind analysis. An obvious drawback of the AND and OR examples is that the exclusion surfaces are selected without regard to the known sensitivities ǫ of the various pipeline combinations. One expects that the strongest upper limits should involve use of this information.</trash>


				</figure>

				<p>As a trivial example, a pipeline combination with zero detection probability (ǫ i = 0) should be ignored when setting upper limits (n i should be ignored). The SINGLE combination makes some limited use of the known sensitivities, but throws away all of the information produced by the less-sensitive pipelines, even if they are only slightly less sensitive than the best one. A more natural way to incorporate the efficiency information in the upper limit procedure is to orient the exclusion surfaces according to the measured efficiencies. For plane exclusion surfaces, the simplest choice is k = ǫ . (34)</p>

				<p>We term this choice the efficiency weighted combination, or EFF. Heuristically, the efficiency weighted combination is an intelligent choice because it places the largest emphasis on the measurements made by the most sensitive combinations of pipelines. To see one of the desirable properties of this choice, consider a repeated experiment. In an ensemble of experiments, the expected number of detections by each pipeline combination i is n = λ true ǫ + b .</p>

			</div>
			<div>
				<head>(35)</head>

				<p>Suppose the observed number of events is n ′ in one experiment, and n ′′ in a second. Which measurement should give the higher upper limit? If ( n ′′ − n ′ ) · ǫ &gt; 0, then the second measurement is consistent with a higher limit on λ. If ( n ′′ − n ′ ) · ǫ = 0, then the two measurements imply the same upper limit on λ. The choice k = ǫ for the exclusion contours enforces these requirements.</p>

			</div>
			<div>
				<head>3</head>

				<figure>
					<figDesc>.5. Example: Rate Limit vs. Amplitude Consider once more the case of two pipelines A and B. Let us suppose that the target signals are characterized by an amplitude ρ, and that the detection efficiencies of A and B separately, E A = ǫ A + ǫ AB , E B = ǫ B + ǫ AB , and their logical combinations ǫ A , ǫ B , ǫ AB , are as shown in Figure 1</figDesc>

				</figure>

				<p>. This scenario is typical of searches for gravitational-wave bursts by LIGO and similar detectors [12, 16, 17, 18, 14]. Our objective is to set an upper limit on λ as a function of the signal amplitude ρ. Since both E A and E B → 1 at large ρ, ǫ AB → 1 as well, while ǫ A and ǫ B are nonzero for only a limited range of signal amplitudes. In this toy model, A is sensitive to slightly weaker signals than B, so ǫ A &gt; ǫ B . However, since both ǫ A and ǫ B are nonzero, each pipeline is able to detect some signals that the other pipeline misses. Therefore, one expects that combining the measurements of the two pipelines should be able to provide more information on the event rate than either pipeline alone.</p>

				<figure>
					<figDesc>Let us now compare the performance of four different choices of exclusion surfaces: AND, OR, SINGLE, and EFF. For the moment, let us ignore any background when computing the upper limits; i.e., we will use b = 0. (We will compare limits including background in the next section.) Consider first the case where no events are detected. The upper limits from each combination are shown in Figure 2</figDesc>

				</figure>

				<p>. All combinations give λ 90% = 2.3 at high amplitude, where ǫ AB → 1. In particular, the EFF upper limit is</p>

				<figure>
					<trash>0.1 = C k ((0, 0, 0)|λ 90% ǫ) = e −ǫ T OT λ 90% , (36) λ 90% = 2.30 ǫ T OT , (37)</trash>


				</figure>

				<p>identical to the OR limit. The EFF and OR combinations give the strongest limits for weak signals because of their better efficiency (which is ǫ T OT , the sum of the efficiencies of all pipeline combinations).</p>

				<p>Upper limits from counting experiments with multiple pipelines</p>

				<p><formula>13 10 −1 10 0 10 1 10 2 0 0.2 0.4 0.6 0.8 1 signal amplitude efficiency E A E B ε A ε B ε AB</formula></p>

				<figure>
					<head>Figure 1.</head>

					<figDesc>Efficiencies for two pipelines A and B. In our toy model, the signal is characterized by an amplitude ρ. The dotted lines E A = ǫ A + ǫ AB , E B = ǫ B + ǫ AB show the efficiencies of the two pipelines considered separately. The continuous lines show the efficiencies of the logical combinations of the pipelines: ǫ A (A not B), ǫ B (B not A), and ǫ AB (A and B).</figDesc>

				</figure>

				<p>Now consider the case of one event detected by the weaker pipeline B: n = (0, 1, 0).</p>

				<p>The upper limits are shown in Figure 3. The OR combination does poorly at high amplitudes because of the detected event. The AND limit is much better at high amplitudes because A did not see the event, but still poor at low amplitudes because ǫ AB → 0. The SINGLE combination performs well, giving the same result as the n = 0 case, because it ignores the event counted by the less sensitive pipeline. The EFF upper limit is computed by summing over N · ǫ ≤ n · ǫ = ǫ B . (38)</p>

				<p>For signal amplitudes ρ 1, ǫ B is the smallest efficiency, so the allowed terms are N ∈ {(0, 0, 0), (0, 1, 0)}. The EFF limit is then given by</p>

				<figure>
					<trash>0.1 = P ((0, 0, 0)|λ 90% ǫ) + P ((0, 1, 0)|λ 90% ǫ) = (1 + ǫ B λ 90% )e −ǫ T OT λ 90% . (39)</trash>


				</figure>

				<p>The extra ǫ B λ term makes the EFF upper limit only slightly higher than the 2.3/ǫ T OT value obtained in the n = 0 case, as can be seen from Figure 3. For ρ 1, ǫ B &gt; ǫ AB and the upper limit includes additional (ǫ AB λ) N AB terms. This causes the EFF limit to increase, but again only slightly, as ǫ AB is typically much smaller than ǫ A , ǫ B at these low amplitudes.</p>

				<p>Upper limits from counting experiments with multiple pipelines</p>

				<p><formula>14 10 −1 10 0 10 1 10 2 0 2 4 6 8 10</formula></p>

				<p>signal amplitude upper limit at 90% confidence AND SINGLE EFF, OR Figure 2. Upper limits as a function of signal amplitude when no events are detected.</p>

				<p>All methods give the asymptotic limit 2.3 for large amplitudes. The EFF and OR combinations give the strongest limits at low amplitude because they have better detection efficiency than the AND and SINGLE combinations.</p>

				<p>We see that the EFF combination effectively ignores the event counted by the insensitive pipeline combination B, and gives a limit as good as or even slightly better than that from the SINGLE combination.</p>

				<p>Now turn to the case in which one event is detected by the more sensitive pipeline, A: n = (1, 0, 0). The upper limits are shown in Figure 4. Again, the OR combination does poorly at high amplitudes because of the detected event. The SINGLE combination does even worse, since the event was found by the more sensitive pipeline, and the SINGLE combination has lower efficiency than the OR combination. The AND combination again performs well at high amplitudes and poorly at low amplitudes. The EFF upper limit is computed by summing over N · ǫ ≤ n · ǫ = ǫ A . (40)</p>

				<p>The number of terms in the sum depends on the relative values of ǫ A , ǫ B , and ǫ AB .</p>

				<p>In this simple example, for ρ &gt; 1.4, ǫ A = 2ǫ B &lt; ǫ AB and the allowed terms are</p>

				<figure>
					<trash>N ∈ {(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 2, 0)}. The EFF limit is given by 0.1 = (1 + ǫ A λ 90% + ǫ B λ 90% + ǫ B 2 λ 2 90% )e −ǫ T OT λ 90% . (41)</trash>


				</figure>

				<p>Since ǫ A and ǫ B are small at high amplitudes, the upper limit is again similar to the n = 0 value of 2.3/ǫ T OT . For ρ &lt; 1.4, ǫ A &gt; ǫ AB and the cumulative distribution C k ( n|λ α ǫ) in (19) includes additional (ǫ AB λ) N AB terms. This causes the EFF limit to increase, becoming similar to that from the OR combination. In short, the EFF combination Upper limits from counting experiments with multiple pipelines</p>

				<p><formula>15 10 −1 10 0 10 1 10 2 0 2 4 6 8 10</formula></p>

				<p>signal amplitude upper limit at 90% confidence AND SINGLE OR EFF n=(0,0,0) Figure 3. Upper limits as a function of signal amplitude when one event is detected by the less sensitive pipeline (B). The OR combination asymptotes to the singleevent value 3.9. The lone event is not counted by the AND, SINGLE combinations, which give the n = 0 limit 2.3. The EFF combination ignores the event at high amplitudes (where ǫ B → 0), while at lower amplitudes the EFF limit is very close to the SINGLE limit as ǫ B ≪ ǫ A . The thin dashed line is the best possible upper limit from the counting experiment: that for zero observed events using the EFF or OR combinations (see Figure 2).</p>

				<p>gives the strongest limits at high amplitudes because pipeline B should have seen a real event there and did not, and it gives the strongest limits at low amplitudes because it has better efficiency than the AND combination.</p>

				<p>Finally, consider the case of a single event detected by both pipelines: n = (0, 0, 1).</p>

				<p>In this case all combinations give the asymptotic limit of 3.9 at large amplitudes, as seen in Figure 5. The relative limits of the AND, OR, and SINGLE combinations are the same as in the n = 0 case. We see, however, that the EFF combination outperforms all other combinations (including OR) in the low-amplitude limit. In fact, the EFF limit reaches nearly the n = 0 value at low signal amplitudes. This counter-intuitive result has a simple explanation: at low amplitudes (ρ &lt; 1), the probability ǫ AB of a real event being detected jointly by A and B is much smaller than the probabilities ǫ A , ǫ B of it being detected by either pipeline alone. The observation n AB &gt; 0 is therefore inconsistent with the hypothesis of a low-amplitude signal. The efficiency weighted combination therefore ignores this measurement for the low-amplitude upper limits, and the limit is dominated by the measurements n A = 0 = n B .</p>

				<p>It is worth noting that the upper limits obtained from the efficiency-weighted procedure are neither monotonic nor continuous; this is most evident in Figure 5.</p>

			</div>
			<div>
				<head>The</head>

				<p>Upper limits from counting experiments with multiple pipelines</p>

				<figure>
					<trash>16 10 −1 10 0 10 1 10 2 0 2 4 6 8 10 signal amplitude upper limit at 90% confidence AND SINGLE OR EFF n=(0,0,0) Figure 4</trash>


				</figure>

				<p>. Upper limits as a function of signal amplitude when one event is detected by the more sensitive pipeline (A). The OR and SINGLE combinations asymptote to the single-event value 3.9. The lone event is not counted by the AND combination, which gives the n = 0 limit 2.3. The EFF combination ignores the event at high amplitudes (where ǫ A → 0), while at lower amplitudes the EFF limit is very close to the OR limit for n = 1. The thin dashed line is the best possible upper limit from the counting experiment: that for zero observed events using the EFF or OR combinations (see Figure 2).</p>

				<p>limits are not monotonic because the efficiencies ǫ A , ǫ B , ǫ AB of the logical combinations of pipelines are not monotonic, as shown in Figure 1. The origin of the discontinuities is slightly more subtle; it arises from the need to sum over a discrete set of N in (19). For the efficiency-weighted combination, the condition (20) depends on the assumed signal amplitude through the efficiencies, k = ǫ(ρ). Therefore, the sum may include different numbers of terms for different signal amplitudes. The discontinuities occur at signal amplitudes where another term satisfies the condition to be included in the sum in (19), N · ǫ ≤ n · ǫ. In turn, this happens when the ratio of efficiencies equals a rational number. We stress that these discontinuities are a general feature of using efficiencies to weight the pipeline combinations, and that they are not indicative of any problem with the procedure. The upper limits at different ρ values are limits on different signal models, and therefore they need not be continuous or monotonic functions of ρ. Indeed, this behaviour is advantageous, as seen in Figure 5, where the efficiency-weighted upper limit is able to drop below the OR limit at low amplitudes.</p>

				<p>In each of the cases considered, efficiency weighting gives upper limits as approximately as strong as or stronger than any of the other choices. Without efficiency weighting, the best remaining combination is different for the different cases: AND,</p>

				<figure>
					<trash>10 −1 10 0 10 1 10 2 0 2 4 6 8 10 signal amplitude upper limit at 90% confidence AND SINGLE OR EFF n=(0,0,0) Figure 5</trash>


				</figure>

				<p>. Upper limits as a function of signal amplitude when a single event is detected by both pipelines (A and B). All combinations give the asymptotic limit of 3.9 at large amplitudes. The EFF combination ignores this event at low amplitudes (where ǫ AB ≪ ǫ A , ǫ B ) and tends to the zero-event limit for ρ &lt; 1. The thin dashed line is the best possible upper limit from the counting experiment: that for zero observed events using the EFF or OR combinations (see Figure 2).</p>

				<p>OR, and SINGLE each perform best for at least one of the cases tested. While we must chose the weighting before measuring n for the upper limit procedure to have the proper coverage, there is no way to know a priori whether to choose AND, OR, or SINGLE. The efficiency-weighted combination, however, gives optimal or near-optimal performance in all cases. We can gain insight into the strong performance of the efficiency weighting choice by examining the form of the upper limit equation (</p>

				<figure>
					<trash>19): 1 − α = (1 + ǫ 1 λ α + ǫ 2 1 λ 2 α 2 + . . . + ǫ 2 λ α + . . .)e −(ǫ 1 +...)λα . (42)</trash>

					<figDesc>The set of efficiencies ǫ i appearing in the exponential is determined by the choice of pipeline combination used for the upper limit. The set of ǫ i terms appearing in the factor in front of the exponential depends on the set of measured events n as well as the pipeline combination chosen. As a rule, adding efficiency terms in the exponential decreases the upper limit. Adding efficiency terms to the factor in front of the exponential increases the upper limit. For the AND and SINGLE combinations, only some of the efficiencies appear in the exponential. With the OR and EFF combinations, the efficiencies for all pipeline combinations appear in the exponential, giving the maximum efficiency possible (ǫ T OT ). Between these two, the EFF combination will typically give fewer terms in the prefactor when events are detected with the less sensitive pipeline combinations. This will result in a lower limit than the OR combination.</figDesc>

				</figure>

				<p>It may have more terms when the most sensitive combination sees the event, thus giving a higher limit than the OR combination in these cases. As seen in Figure 5, this loss in upper limit tends to be small; since the extra terms are associated with low-efficiency pipeline combinations, and appear with powers of those small ǫ i .</p>

			</div>
			<div>
				<head n="3.6">Upper Limits with Background</head>

				<p>We have seen that the EFF weighted combination tends to give stronger upper limits than the AND, OR, and SINGLE weightings when we ignore the background. We now demonstrate by example that this superior performance continues when we account for the background as well. We do this by computing the expectation value of the upper limit as a function of the true foreground rate λ for two scenarios: one with low background, and one with high background. Let us consider once more the case of our two pipelines A and B. We will work initially with a fixed set of efficiencies,</p>

				<figure>
					<trash>ǫ = (ǫ A , ǫ B , ǫ AB ) = (0.345, 0.175, 0.480) . (43) Let us assume the background to be b = (b A , b B , b AB ) = (1/3, 1/3, 1/3) b T OT . (44)</trash>


				</figure>

				<p>With this background, on average, pipelines A and B detect the same number of background events, and half of the events detected by one are also detected by the other. The total expected background is b T OT . We will consider the cases b T OT = 0.1 ( &quot; low background &quot; ) and b T OT = 1 ( &quot; high background &quot; ). A straightforward Monte Carlo analysis was used to estimate the upper limit in an ensemble of experiments. Figure 6 shows the mean limits from the AND, OR, SINGLE, and EFF combinations as a function of the true value of λ ∈ [0, 1] for the low background case. Figure 7 shows the mean limits for the high background case.</p>

				<p>In both cases the EFF weighting gives stronger limits than any of the other weightings for all values of λ tested. The gap between the EFF upper limits and the next best limits (from OR) is particularly large for the high-background case. These findings support our conclusion that the EFF weighting &quot; protects &quot; the upper limit against modest background contamination. To get a sense of the robustness of the EFF weighting performance, we repeat the Monte Carlo for a range of efficiencies. Specifically, we vary ǫ A over [0,1], ǫ B ≤ ǫ A , and keep ǫ AB = 1 − ǫ A − ǫ B so that ǫ T OT = 1. We use b T OT = 1 ( &quot; high background &quot; ) and λ = 0.5. Figure 8 shows how the mean upper limit from the EFF weighting varies with ǫ A , ǫ B . The mean limits range from 2.91 to 3.41, a variation of less than 20%. By contrast, the mean limits from the other weightings (not shown) are always higher:</p>

				<figure>
					<trash>≥ 3.40 (SINGLE); ≥ 3.25 (AND), and = 3.55 (OR). This indicates that the superior 0 0.2 0.4 0.6 0.8 1 2 2.5 3 3.5 4 4.5 5 5.5 6 6.5 7 true foreground rate λ mean rate upper limit AND SINGLE OR EFF</trash>

					<head>Figure 6.</head>

					<figDesc>Mean upper limit as a function of the true foreground rate λ in an ensemble of experiments with fixed low background. This two-pipeline experiment has efficiency (ǫ A , ǫ B , ǫ AB )</figDesc>
					<trash>= (0.345, 0.175, 0.480) and background (b A , b B , b AB ) = (1/30, 1/30, 1/30).</trash>


				</figure>

				<figure>
					<figDesc>performance of the EFF weighting is not reliant on the efficiencies taking particular values. It can be noted from Figure 8</figDesc>

				</figure>

				<p>that the EFF limit does not reduce to the SINGLE limit (≥ 3.40) when ǫ B → 0. This is because the EFF combination becomes k = (ǫ A , 0, ǫ AB ), whereas the SINGLE weighting is k = (1, 0, 1). So, the EFF weighting maintains a distinction between events detected by A alone and those detected jointly by A and B. The result is that the EFF limits are lower than or equal to the SINGLE limits as ǫ B → 0, with equality at ǫ = (0.5, 0, 0.5).</p>

				<p>Finally we note that the EFF weighting, since it is based on efficiency alone, is most applicable to the case where the background is relatively small. We concentrate on the case where the expected number of events due to background of order 1 or less. For much higher backgrounds the optimal weightings should also include information on the backgrounds b A , b AB , . . . of the various pipeline combinations.</p>

			</div>
			<div>
				<head n="4">Multiple Data Sets</head>

				<p>The formalism we have developed for multiple algorithms analyzing a common data set can be applied equally well to the analysis of multiple sets of data. For example, we may have data from several observation periods, each characterized by the use of a different</p>

				<p><formula>0 0.2 0.4 0.6 0.8 1 2 2.5 3 3.5 4 4.5 5 5.5 6 6.5 7</formula></p>

				<p>true foreground rate λ mean rate upper limit AND SINGLE OR EFF Figure 7. Mean upper limit as a function of the true foreground rate λ in an ensemble of experiments with fixed high background. This two-pipeline experiment has efficiency (ǫ A , ǫ B , ǫ AB ) = (0.345, 0.175, 0.480) and background (b A , b B , b AB ) =</p>

				<p><formula>(1/3, 1/3, 1/3). 0 0.2 0.4 0.6 0.8 1 0 0.1 0.2 0.3 0.4 0.5 ε A ε B 3 3.1 3.2 3.3 3.4 Figure 8</formula></p>

				<p>. Mean upper limit as a function of efficiency ǫ = (ǫ A , ǫ B , 1 − ǫ A − ǫ B ) in an ensemble of experiments with background (b A , b B , b AB ) = (1/3, 1/3, 1/3) and true event rate λ = 0.5. The largest limits occur when ǫ A , ǫ B , and ǫ AB = 1 − ǫ A − ǫ B are related by the ratio of small integers, as discussed in Section 3.5. set of instruments, or over which the sensitivity of the instruments changed, etc. In this case, the analyses of the separate data epochs may be considered as separate pipelines for purposes of setting an upper limit.</p>

				<p>As a simple example, consider the case of a single algorithm used to analyse data from two disjoint data sets A and B, with durations T A , T B . The sensitivity of the experiment is characterized by the two numbers ǫ A : The probability that any given foreground event will be detected during period A; ǫ B : The probability that any given foreground event will be detected during period B.</p>

				<figure>
					<figDesc>The background is characterized by b A : The expected number of background events detected during period A; b B : The expected number of background events detected during period B. The outcome of the experiment is the set of two numbers n A : The number of events detected during period A; n B : The number of events detected during period B.</figDesc>

				</figure>

				<p>Since any given event can be detected during period A or period B but not both, we have ǫ AB = 0, b AB = 0, n AB = 0. We see immediately that this is a special case of the two-pipeline analysis, where we treat the analysis of the separate data sets as separate pipeline measurements. In fact, it is a particularly simple case, as we know ǫ AB = 0, b AB = 0, n AB = 0 a priori. Note that we define the efficiencies ǫ A , ǫ B in terms of the probability of events from anywhere in the entire observation period T being detected during periods A or B. We are taking the union of the data sets to treat them as one large set. This is the most convenient approach, since it matches precisely how the multiple-pipeline case was developed. It saves us from including the separate observation times T A , T B explicitly in our upper limit calculations. Instead, they are included implicitly in the efficiencies. For example, ǫ A has a maximum possible value of T A /(T A + T B ). For concreteness, let us suppose we have two data sets of equal length, T A = T B = 0.5T . Suppose also that the instruments used were more sensitive during period A, such that ǫ A = 3/5, ǫ B = 2/5, and ǫ T OT = ǫ A + ǫ B = 1. Table 1 shows the upper limits obtained ignoring the background. We compare the OR (combining event counts from both periods), SINGLE (only counting events from the more sensitive period), and EFF combinations for zero or one detected event. (The AND combination is not applicable to this case, since ǫ AB = 0.) In each case, the EFF combination gives the best upper limit. For no detected events, the EFF and OR combinations give the limit 2.3 as before. The SINGLE limit is a factor 5/3 higher, because it uses only 3/5 of the integrated sensitivity of the experiment (ǫ A = 3ǫ T OT /5). For one event detected in the less sensitive period B, the EFF combination gives the best upper limit – even better than SINGLE. This may be surprising, in that the SINGLE upper limit is computed for zero events. We see that</p>

				<figure>
					<head>Table 1.</head>

					<figDesc>Comparison of upper limits obtained for various possible outcomes of a counting experiment on two data sets A and B with ǫ A = 3/5, ǫ B = 2/5, and ignoring background. The cases are: no events detected ( n = (0, 0, 0)); one event detected in B ( n = (0, 1, 0)); one event detected in A ( n =</figDesc>
					<trash>(1, 0, 0)). upper limit n OR SINGLE EFF (0,0,0) 2.3 3.8 2.3 (0,1,0) 3.9 3.8 3.1 (1,0,0) 3.9 6.5 3.9</trash>


				</figure>

				<p>the extra sensitivity gained by including the B measurement in the EFF upper limit more than offsets the loss in the limit due to having a detected event. Finally, for the case of one event detected in the more sensitive period A, the EFF limit matches the OR limit. Interestingly enough, the SINGLE combination performs worse than EFF in all cases; for the given efficiencies, we always get a better limit by using all of the data. For a larger difference in efficiencies, the differences in upper limits are more pronounced. Table 2 compares the upper limits for ǫ A = 2/3, ǫ B = 1/3, ǫ T OT = 1.</p>

				<p>The OR limits are unchanged. The SINGLE limits are better than those in Table 1 because the SINGLE combination now contains 2/3 of the integrated sensitivity of the experiment (ǫ A = 2ǫ T OT /3) instead of only 3/5. The changes in the EFF limits are more complicated. For one event detected in the less sensitive period B, the EFF combination still gives the best upper limit – slightly better than before, because the weighting of B is less than in the previous case. For one event detected in A, the EFF limit is between the OR limit and the SINGLE limit. The increase over the limit in Table 1 is due to the fact that for ǫ A = 2ǫ B , the cumulative sum in (19) now includes the terms N = {(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 2, 0)}, whereas for ǫ A = 1.5ǫ B it includes only N = {(0, 0, 0), (1, 0, 0), (0, 1, 0)}. Note that the EFF limits are particularly robust against background events contaminating the less-sensitive data sets. This allows the sub-optimal data to be used to strengthen scientific results without fear of &quot; spoiling &quot; the upper limits. In particular, note that the average of the upper limits for the single-event cases ( n = (1, 0, 0) and (0, 1, 0)) is best for the EFF combination in both</p>

				<figure>
					<head>Table 1 and Table 2.</head>

					<figDesc>So, if the data sets have equal background probability (assumed ≪ 1), the EFF combination will on average give the best upper limits for low true event rates. Finally, since we have seen benefits from treating multiple data sets separately, one might ask if we should always split up data sets. In particular, why not sub-divide all data sets ad infinitum? The answer comes from noting that the benefits of the EFF combination arise from exploiting differences in the efficiencies ǫ i . If the differences in efficiency between two data sets are negligible, then there is no benefit to treating them separately. For example, for two sets of data with identical efficiencies, the EFF and OR combinations will always give identical limits: since n AB = 0 always, choosing k = ǫ</figDesc>

				</figure>

				<figure>
					<head>Table 2.</head>


				</figure>

				<p>Comparison of upper limits obtained for various possible outcomes of a counting experiment on two data sets A and B with ǫ A = 2/3, ǫ B = 1/3, and ignoring background. The cases are: no events detected ( n = (0, 0, 0)); one event detected in B ( n = (0, 1, 0)); one event detected in A ( n =</p>

				<figure>
					<trash>(1, 0, 0)). upper limit n OR SINGLE EFF (0,0,0) 2.3 3.5 2.3 (0,1,0) 3.9 3.5 3.0 (1,0,0) 3.9 5.8 4.3</trash>


				</figure>

				<p>will always give the same results as k = (1, . . . , 1). One therefore gets no benefit from sub-dividing epochs of constant sensitivity.</p>

			</div>
			<div>
				<head n="5">Summary</head>

				<p>We have proposed a general technique for setting upper limits on Poisson processes from counting experiments involving multiple data sets and multiple event-counting algorithms (which we collectively refer to as multiple &quot; pipelines &quot; ). This technique is an extension of the standard procedure for one-sided classical confidence intervals. There are two key features. First, we characterize the measurements by the logical combinations of pipelines – the number of events counted by A-and-B, by A-and-not-B, etc. Second, we select a rank-ordering of the space of possible measurements which is based on the relative detection efficiencies of these logical combinations. This efficiency weighting uses all of the counts from the experiment, but assigns more significance to those counts from pipeline combinations which are expected to detect more foreground events. We have seen that in typical cases for low background and low foreground event rate, the efficiency weighting tends to give stronger upper limits than selecting the AND or OR combination of pipelines, or selecting the single most sensitive pipeline only. In particular, the efficiency weighting procedure tends to be robust against modest background contamination of the event counts. This allows all of the observational results to contribute to the upper limit while reducing the chances that background contamination of some counts will weaken it.</p>

				<p>In this paper we have focused on computing upper limits; however, the method has wider applicability. The characterisation of the experiment in terms of logical combinations of pipelines and the subsequent rank ordering effectively reduce the space of measurements to one dimension. At this point we are free to apply other standard procedures for constructing one-or two-sided confidence intervals. It would be interesting, for example, to apply the Feldman-Cousins procedure [1] to produce unified upper limits and confidence intervals for our multiple-pipeline experiment; we leave this consideration to the future. As a final note, let us point out that the concept of a &quot; pipeline &quot; is quite general – it is nothing more than a way of defining a count of events. We have seen that different pipelines may consist of different algorithms applied to the same data, or the same algorithm applied to different data sets. Distinct pipelines may also be defined in other ways, such as by applying a single algorithm to a single data set and segregating the resulting events into groups by some other attribute. For example, in gravitational-wave burst searches the background is largely due to events detected at low frequencies (&lt; 200 Hz). Dividing events into low-frequency (&lt; 200 Hz) and high-frequency (&gt; 200 Hz) sets would produce limits on high-frequency gravitational waves that are not compromised by the low-frequency background. LIGO matched-filtering searches for gravitational waves from inspiralling binaries [19, 20] use a similar idea, dividing the space of templates (signal parameters) into several regions. Background events that match templates in one region then have minimal impact on the limits set in other regions of the template/signal space. Multiple applications of the same algorithm with different counting thresholds can also be treated as separate pipelines and handled by our method; this might be appropriate when low-and high-amplitude events are produced by separate populations. A multiple-threshold approach would have the benefit that events detected with low (high) amplitude have minimal impact on the rate limits set on the high (low) amplitude population. Our method even naturally handles the case of a &quot; veto &quot; analysis, in which one pipeline (B) processes data in such a way as to be deliberately insensitive to signals, but sensitive to background noise: ǫ B , ǫ AB ≃ 0 but b B , b AB &gt; 0. The EFF weighting then automatically ignores (vetoes) events detected by A that are also detected by the veto pipeline B.</p>

			</div>
			<div>
				<head>Acknowlegements</head>

				<p>The author would like to thank Lindy Blackburn, Shourov Chatterji, Jolien Creighton, Stephen Fairhurst, and Erik Katsavounidis for stimulating discussions, and Patrick Brady for valuable feedback on an earlier draft. This work was supported in part by STFC grant PP/F001096/1.</p>

				<p>Appendix A. Derivative of C S ( n| ǫ, λ)</p>

				<p>In this appendix we prove equation (18), dC S ( n|λ ǫ + b) dλ &lt; 0 , (A.1) where n, ǫ, b, and the family S(ζ) are held fixed. First, we recall the definition (15) of the cumulative probability C S ,</p>

				<figure>
					<trash>C S ( n|λ ǫ + b) = N |ζ( N )≤ζ( n) P ( N|λ ǫ + b) = N |ζ( N )≤ζ( n) q i=1</trash>


				</figure>

				<p>P (N i |ǫ i λ + b i )</p>

				<p>Upper limits from counting experiments with multiple pipelines</p>

				<figure>
					<trash>25 = N |ζ( N )≤ζ( n) q i=1 (ǫ i λ + b i ) N i e −ǫ i λ−b i N i ! . (A.2) Taking the derivative with respect to λ yields dC S ( n|λ ǫ + b) dλ = N |ζ( N )≤ζ( n) N 1 ǫ 1 (ǫ 1 λ + b 1 ) N 1 −1 N 1 ! × . . . × (ǫ q λ + b q ) Nq N q ! + . . . + (ǫ 1 λ + b 1 ) N 1 N 1 ! × . . . × N q ǫ q (ǫ q λ + b q ) Nq−1 N q ! − (ǫ 1 + . . . + ǫ q ) (ǫ 1 λ + b 1 ) N 1 N 1 ! × . . . × (ǫ q λ + b q ) Nq N q ! × exp [−</trash>

					<figDesc>(ǫ 1 + . . . + ǫ q ) λ − (b 1 + . . . + b q )] . (A.3)</figDesc>

				</figure>

				<p>Consider the contribution of the term N ′ = (N</p>

			<note>′ 1 , . . . , N</note>

				<p>′ q ) to the sum. We see that the positive terms arise from taking the derivative of the λ N i . Each such positive term is exactly cancelled by a negative term coming from the derivative of the exponential from the term N ′′ = (N</p>

				<figure>
					<trash>′ 1 , . . . , N ′ i − 1, . . . , N ′ q ). N ′′</trash>


				</figure>

				<p>will always be included in the sum if N ′ is included because of the requirement that the normal to the surfaces S(ζ) must have only non-negative components. Therefore, all positive terms in (A.3) are cancelled and the derivative must be negative.</p>

			</div>

			<note place="foot">‡ From (1), dC(n|ǫλ + b)/dλ = −ǫ(ǫλ + b) n e −ǫλ−b /n! &lt; 0 for λ &gt; 0, b ≥ 0.</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Unified approach to the classical statistical analysis of small signals</title>
		<author>
			<persName>
				<forename type="first">Gary</forename>
				<forename type="middle">J</forename>
				<surname>Feldman</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Robert</forename>
				<forename type="middle">D</forename>
				<surname>Cousins</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. D</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="page" from="3873" to="3889" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Upper limits on gravitational- wave signals based on loudest events</title>
		<author>
			<persName>
				<forename type="first">Patrick</forename>
				<forename type="middle">R</forename>
				<surname>Brady</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Jolien</forename>
				<forename type="middle">D E</forename>
				<surname>Creighton</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Alan</forename>
				<forename type="middle">G</forename>
				<surname>Wiseman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Class. Quant. Grav</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="1775" to="1782" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">The loudest event statistic: general formulation, properties and applications</title>
		<author>
			<persName>
				<forename type="first">Rahul</forename>
				<surname>Biswas</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Patrick</forename>
				<forename type="middle">R</forename>
				<surname>Brady</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Jolien</forename>
				<forename type="middle">D E</forename>
				<surname>Creighton</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Stephen</forename>
				<surname>Fairhurst</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Classical and Quantum Gravity</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page">175009</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m" type="main">Errors in experiments with small numbers of events. Nuclear Instruments and Methods in Physics Research A</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Helene</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1984" />
			<biblScope unit="page" from="120" to="128" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">A Bayesian analysis of experiments with small numbers of events. Nuclear Instruments and Methods in Physics Research A</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<forename type="middle">B</forename>
				<surname>Prosper</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1985" />
			<biblScope unit="page" from="236" to="240" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Small-signal analysis in high-energy physics: A bayesian approach</title>
		<author>
			<persName>
				<forename type="first">Harrison</forename>
				<forename type="middle">Bertrand</forename>
				<surname>Prosper</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. D</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page" from="1153" to="1160" />
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Comment on &apos;&apos;small-signal analysis in high-energy physics: A bayesian approach</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">A</forename>
				<surname>Williams</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. D</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="3582" to="3583" />
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Reply to &apos;&apos;comment on &apos;small-signal analysis in high-energy physics: A bayesian approach</title>
		<author>
			<persName>
				<forename type="first">Harrison</forename>
				<forename type="middle">Bertrand</forename>
				<surname>Prosper</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. D</title>
		<imprint>
			<biblScope unit="volume">381011</biblScope>
			<biblScope unit="page" from="3584" to="3585" />
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">First upper limits from ligo on gravitational wave bursts</title>
		<author>
			<persName>
				<forename type="first">Abbott</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. D</title>
		<imprint>
			<biblScope unit="volume">69</biblScope>
			<biblScope unit="page">102001</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">A first comparison of search methods for gravitational wave bursts using ligo and virgo simulated data</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Beauville</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Classical and Quantum Gravity</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="1293" to="1301" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">Search for gravitational-wave bursts in the first year of the fifth LIGO science run</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Abbott</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Ligo: the laser interferometer gravitational-wave observatory</title>
		<author>
			<persName>
				<forename type="first">B</forename>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Abbott</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Reports on Progress in Physics</title>
		<imprint>
			<biblScope unit="volume">72</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Upper limits on gravitational wave bursts in ligo&apos;s second science run</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Abbott</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. D</title>
		<imprint>
			<biblScope unit="volume">72</biblScope>
			<biblScope unit="page">062001</biblScope>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Upper limits from the ligo and tama detectors on the rate of gravitational-wave bursts</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Abbott</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. D</title>
		<imprint>
			<biblScope unit="volume">72</biblScope>
			<biblScope unit="page">122004</biblScope>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Search for gravitational-wave bursts in ligo data from the fourth science run</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Abbott</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Class. Quantum Grav</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="5343" to="5369" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Search for gravitational waves from low mass binary coalescences in the first year of ligo&apos;s s5 data</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">P</forename>
				<surname>Abbott</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physical Review D</title>
		<imprint>
			<biblScope unit="volume">79</biblScope>
			<biblScope unit="page">122001</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Search for gravitational waves from low mass compact binary coalescence in 186 days of ligo&apos;s fifth science run</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">P</forename>
				<surname>Abbott</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physical Review D</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page">047101</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
