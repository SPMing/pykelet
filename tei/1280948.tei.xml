<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="file:///home/joseph/Desktop/grobid/grobid-home/schemas/rng/Grobid.rng" schematypens="http://relaxng.org/ns/structure/1.0"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Locally covariant quantum field theory with external sources Relative Cauchy evolution, automorphisms and dynamical locality</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014-09-18">18 Sep 2014 July 2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Christopher</forename>
								<forename type="middle">J</forename>
								<surname>Fewster</surname>
							</persName>
							<affiliation>
								<orgName type="department">Department of Mathematics</orgName>
								<orgName type="institution">University of York</orgName>
								<address>
									<postCode>YO10 5DD</postCode>
									<settlement>Heslington</settlement>
									<region>York</region>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alexander</forename>
								<surname>Schenkel</surname>
							</persName>
							<affiliation>
								<orgName type="department">Fachgruppe Mathematik</orgName>
								<orgName type="institution">Bergische UniversitätWuppertal</orgName>
								<address>
									<addrLine>Gaußstraße20</addrLine>
									<postCode>42119</postCode>
									<settlement>Wuppertal</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Locally covariant quantum field theory with external sources Relative Cauchy evolution, automorphisms and dynamical locality</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2014-09-18">18 Sep 2014 July 2014</date>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>We provide a detailed analysis of the classical and quantized theory of a multiplet of inho-mogeneous Klein–Gordon fields, which couple to the spacetime metric and also to an external source term; thus the solutions form an affine space. Following the formulation of affine field theories in terms of presymplectic vector spaces as proposed in [Annales Henri Poincaré 15, 171 (2014)], we determine the relative Cauchy evolution induced by metric as well as source term perturbations and compute the automorphism group of natural isomorphisms of the presymplectic vector space functor. Two pathological features of this formulation are revealed: the automor-phism group contains elements that cannot be interpreted as global gauge transformations of the theory; moreover, the presymplectic formulation does not respect a natural requirement on composition of subsystems. We therefore propose a systematic strategy to improve the original description of affine field theories at the classical and quantized level, first passing to a Poisson algebra description in the classical case. The idea is to consider state spaces on the classical and quantum algebras suggested by the physics of the theory (in the classical case, we use the affine solution space). The state spaces are not separating for the algebras, indicating a redundancy in the description. Removing this redundancy by a quotient, a functorial theory is obtained that is free of the above mentioned pathologies. These techniques are applicable to general affine field theories and Abelian gauge theories. The resulting quantized theory is shown to be dynamically local. Keywords: locally covariant quantum field theory, relative Cauchy evolution, quantum field theory on curved spacetimes, affine quantum field theory MSC 2010: 81T20, 81T05</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
			<div>
				<head n="1">Introduction</head>

				<p>Our understanding of quantum field theories on Lorentzian manifolds has made tremendous developments since the principle of general local covariance was introduced in [BFV03]. Its underlying physical idea, which roughly speaking says that any reasonable quantum field theory should be defined coherently on all spacetimes instead of focusing on formulations in individual spacetimes, is expressed mathematically in terms of category theory. The basic structure of interest is that of a covariant functor from a category of spacetimes (possibly with extra data such as fibre bundles) to a category of algebras, which is supposed to describe the association of observable algebras to spacetimes. The benefits from this new perspective on quantum field theory are substantial: On the one hand, many structural problems have been addressed and solved, for example the generalization of the famous spin-statistics theorem to curved spacetimes [Ver01] and the perturbative renormalization of quantum field theories, see e.g. [BDF09, HW01, HW02] for general developments and [FR13, BFR13] for perturbative gauge and gravity theories. On the other hand, the locally covariant framework also has had an impact on applications of quantum field theory to e.g. quantum energy inequalities [FP06, Few07] and cosmology [Ver12, PS13a, PS13b].</p>

				<p>Another new and interesting aspect arising in the locally covariant framework is that internal symmetries of (quantum) field theories can be promoted to the functorial level. It has been proposed recently by one of us [Few13] that the automorphism group (of natural isomorphisms) of a locally covariant quantum field theory functor is a suitable generalization to curved spacetimes of the global gauge group in Minkowski space algebraic quantum field theory. Besides clarifying general properties of such automorphism groups, it has been shown in [Few13] that this concept indeed captures the usual orthogonal symmetries of the quantum theory of a multiplet of Klein–Gordon fields with equal masses.</p>

				<p>In this paper we investigate how some of the above features are modified when the basic category is enriched from a category of spacetimes to include additional external sources. This particularly influences the relative Cauchy evolution [BFV03], which measures sensitivity of a theory to perturbations of the background structure, and plays a key role in the classification of the automorphism group [Few13] and also in defining the notion of a dynamically local theory [FV12a]. External sources provide additional degrees of freedom for the relative Cauchy evolution to exploit, leading to a richer framework.</p>

				<p>Our investigation is conducted in the context of an example, namely the theory of a multiplet of inhomogeneous Klein–Gordon fields interacting with an external source, with underlying Lagrangian</p>

				<figure>
					<trash>L = |g| 1 2 ∇ a φ, ∇ a φ − 1 2 m 2 φ, φ − J , φ , (1.1) where J ∈ C ∞ (M, R p</trash>


				</figure>

				<p>) is a classical and non-dynamical source term. The interest in this model comes from two directions. Physically, it represents an approximation to a model in which φ is coupled both to gravity and to other fields, but with the simplifying assumption that not only the metric but also the other fields have been &apos;frozen&apos; as background structure represented by the external source; this would be an appropriate approximation in situations where the back-reaction of φ on both the metric and other fields can be neglected. Mathematically, interest arises because, in contrast to the homogeneous theory with J = 0, the equation of motion corresponding to this Lagrangian is not linear, but affine, and as a consequence the space of solutions is not a vector space, but rather an affine space. On the one hand, replacing linear structures by affine ones leads to the simplest &apos;non-linear&apos; models of quantum field theories, which still can be treated exactly without the need for perturbative expansions [BDS14a]. On the other hand, these affine structures are unavoidable in gauge theories [BDS14b, BDHS13] as the space of connections on a principal bundle is intrinsically an affine space. Hence, inhomogeneous theories such as (1.1) can be regarded as toy-models for gauge theories, which reflect parts of their geometric structure. For these reasons, a general study of affine field theories was recently undertaken in [BDS14a]. See also [SDH14] for a recent study of the p-form fields (in particular, the Maxwell field) coupled to an external source term.</p>

				<p>Formulating the (classical and quantum) inhomogeneous Klein–Gordon theory according to [BDS14a], however, we have found that the resulting functors have two serious pathologies. First, their automorphism groups do not reflect the expected symmetries of this model: From the Lagrangian (1.1) one expects that the usual orthogonal symmetries are broken due to the presence of the (arbitrary) source terms J , so that only a translation symmetry φ → φ + µ, µ ∈ R p , remains in the massless case m = 0. By contrast, the functor constructed in [BDS14a] always has a Z 2 (sub)group of automorphisms, which has no corresponding interpretation at the level of the Lagrangian. Second, the functors of [BDS14a] provide a description of a multiplet of p (mutually noninteracting) fields that is inequivalent to what it would provide for the composition of p copies of a single field. These defects convince us that there is a flaw in this earlier description of affine field theories and that the corresponding functor has to be modified.</p>

				<p>A second theme of this paper, then, is to propose a systematic way to improve the construction of the classical and quantum theory of the inhomogeneous multiplet of Klein–Gordon fields. The essential ingredient is the use of suitable state spaces (in the classical theory given by the solution space) and the characterization of the vanishing ideals induced by these state spaces in the abstract algebras considered in [BDS14a]. These ideals reflect redundancies in that description, and we therefore quotient by the vanishing ideals to obtain improved functors. Our construction is free of the pathologies of [BDS14a]: the functors have the expected automorphism groups and satisfy a natural composition property with respect to the size of the multiplet. Furthermore, we will see that the functorial perspective can illuminate some aspects of the structure of these models that is obscured in other approaches (see Remark 6.13 in particular). This work provides the foundation for a broader discussion of the properties of these models. It is worth emphasizing that our improved classical theory is not formulated in terms of presymplectic vector spaces, but in terms of Poisson algebras. 1 Similarly, the improved quantum theory is not given by CCR-algebras, but by quotients of such algebras. Finally, we would like to mention that the techniques developed in this work are important for and can be applied to generic affine field theories [BDS14a] and, with slight modifications due to the presence of gauge invariance, also to Abelian gauge theories [BDS14b, BDHS13].</p>

				<p>The outline of this paper is as follows: In Section 2 we shall review briefly the techniques required for studying affine field theories [BDS14a], focusing for simplicity on the explicit example given by the inhomogeneous multiplet of Klein–Gordon fields. The relative Cauchy evolution for this model is discussed in detail in Section 3; as a new feature compared to earlier studies, we study perturbations of both the metric g and the external source J. The derivative of the relative Cauchy evolution along metric perturbations is calculated and it is shown how to identify it with the stress-energy tensor corresponding to the action given by (1.1). Furthermore, the derivative of the relative Cauchy evolution along external source perturbations is determined and identified with the J-variation of the action given by (1.1). In Section 4 we compute the automorphism group of the functor describing the presymplectic vector spaces of the classical theory of a multiplet of inhomogeneous Klein–Gordon fields. We find that all endomorphisms of this functor (embeddings of the theory as a subtheory of itself) are in fact automorphisms (global gauge transformations), and that the automorphism group is isomorphic to Z 2 in the massive case and to Z 2 × R p for m = 0. The nontrivial Z 2 automorphism does not describe a symmetry of the Lagrangian (1.1), suggesting that inhomogeneous field theories are not appropriately described by the presymplectic vector space functor developed in [BDS14a]. This suggestion is strengthened in Section 5, where we study a composition property: Any pair (M , J ) consisting of a spacetime M with source term J ∈ C ∞ (M, R p ) may be split in a functorial way into two pairs (M , J q ), (M , J p−q ) , where the source J is split into the first q and last p − q components. Treating the two pairs individually by the presymplectic vector space functor of [BDS14a], we get a separate description of the first q and last p − q components of the inhomogeneous Klein–Gordon field. We observe that the direct sum of these two presymplectic vector spaces is not isomorphic to the original presymplectic vector space, and as a consequence the theory obtained in the direct way is not naturally isomorphic to the one obtained after splitting. As the individual components of the inhomogeneous Klein–Gordon field have no mutual interactions, this behavior is pathological and strengthens our claim that the presymplectic vector space functor is not a satisfactory description of the inhomogeneous theory of a multiplet of Klein–Gordon fields.</p>

				<p>In Section 6 we show how to resolve these issues by passing from the category of presymplectic vector spaces to that of Poisson algebras. The presymplectic vector space of [BDS14a] has a canonical corresponding (abstract) Poisson algebra which can be represented naturally as an algebra of functionals on the affine space of solutions to the inhomogeneous Klein–Gordon equation.</p>

				<p>In this representation there arises a kernel, which has no corresponding analog at the level of the presymplectic vector spaces. We show that these kernels are natural Poisson ideals and hence we can modify our Poisson algebra functor by quotienting them out. The resulting improved Poisson algebra functor is shown to have the expected automorphism group (i.e. the trivial group for m = 0 and R p for m = 0) and to satisfy the composition property. Hence, it is a better description of the classical theory of a multiplet of inhomogeneous Klein–Gordon fields. We extend these constructions to the quantum level in Section 7. The main idea is to characterize suitable state spaces for the CCR-algebras obtained by canonical quantization of our presymplectic vector spaces, which reflect the fact that the latter describe affine functionals on the solution space of the inhomogeneous theory.</p>

				<p>Quotienting by the intersection of the kernels of corresponding GNS representations, we obtain our improved (functorial) quantized theory, which has the correct automorphism group and satisfies the composition property. We also prove that our improved theory satisfies the dynamical locality property introduced in [FV12a, FV12b]. Furthermore, we compare our improved algebras with the algebras for inhomogeneous theories constructed by Hollands and Wald [HW05] as a quotient of the Borchers–Uhlmann algebra [Bor62, Uhl62] and show that they are naturally isomorphic; nonetheless , as we describe in more detail in Section 9, our methods provide a wider perspective on this approach. The somewhat special case of the massless multiplet of inhomogeneous Klein–Gordon fields and its interpretation as a rather simple kind of gauge theory is discussed in Section 8. In Section 9 we add some concluding remarks, which should show that the techniques developed in this paper can be readily applied to generic affine field theories in the sense of [BDS14a] and also to Abelian gauge theories [BDS14b, BDHS13]. There are three appendices. Appendix A includes details on how to take the derivative of the relative Cauchy evolution and the stress-energy tensor.</p>

				<p>In Appendix B we give an alternative solution to the problems arising with the presymplectic vector space functor by introducing a category of pointed presymplectic spaces. Finally, Appendix C treats the quantization of our model by deformation methods. It turns out that our improved classical Poisson algebra is amenable to direct deformation quantization; alternatively, one may also apply an algebraic version of Fedosov&apos;s method – both lead to the improved quantum theory discussed in the text. We comment on the relationship between our approach and that of the recent paper [SDH14]</p>

				<figure>
					<figDesc>.</figDesc>

				</figure>

			</div>
			<div>
				<head n="2">Preliminaries 2.1 Basics and notations</head>

				<p>The model we study throughout this work is given by a multiplet of p ∈ N real scalar fields (with the same mass), which are minimally coupled to the Lorentzian metric and in addition coupled to an external source.</p>

				<p>We shall exclusively work in a category theoretical setting, which is an extension of the framework of locally covariant quantum field theory developed in [BFV03], see also [FV12a]. The basic category entering our construction is given by the following Definition 2.1. The category LocSrc p consists of the following objects and morphisms: • The objects in LocSrc p are pairs (M , J ), where M = (M, o, g, t) is a manifold M (of arbitrary but finite dimension and with finitely many connected components) with orientation o, globally hyperbolic Lorentzian metric g (of signature (+, −, · · · , −)) and time-orientation t, and J ∈ C ∞ (M, R p ). • The morphisms f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p are orientation and time-orientation preserving isometric embeddings f : M 1 → M 2 , such that f [M 1 ] ⊆ M 2 is causally compatible and open and such that f * (J 2 ) = J 1 , where f * denotes the pull-back.</p>

				<p>Any morphism whose image contains a Cauchy surface of the codomain will be called a Cauchy morphism; any functor from LocSrc p to some other category is said to obey the time-slice axiom if it maps every Cauchy morphism to an isomorphism.</p>

				<p>The configuration space of a multiplet of p ∈ N real scalar fields is given by the following contravariant functor C ∞ p : LocSrc p → Vec to the category of real vector spaces: To any object (M , J ) in LocSrc p we associate C ∞ p (M , J ) := C ∞ (M, R p ) and to any morphism f :</p>

				<figure>
					<trash>(M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p we associate the pull-back C ∞ p (f ) := f * : C ∞ p (M 2 , J 2 ) → C ∞ p (M 1 , J 1 ).</trash>


				</figure>

				<p>We model the equations of motion for our theory, given by inhomogeneous Klein–Gordon equations , by a certain natural transformation. As a first step, remember that the homogeneous Klein– Gordon equation is described by the natural transformation KG = {KG M } :</p>

				<figure>
					<trash>C ∞ p ⇒ C ∞ p given by the Klein–Gordon operators KG M : C ∞ p (M , J ) → C ∞ p (M , J ) , φ → KG M (φ) = M (φ) + m 2 φ . (2.1)</trash>


				</figure>

				<p>Here M is the d&apos;Alembert operator corresponding to M and m ≥ 0 is a fixed mass. In order to couple the theory to the sources J, which are part of the data of the category LocSrc p , we have to relax the condition that morphisms in Vec are linear. Let us therefore introduce the category Aff of affine spaces over real vector spaces with affine maps as morphisms and the obvious forgetful functor Forget : Vec → Aff. We compose C ∞ p with the functor Forget and obtain as result a contravariant functor A ∞ p := Forget • C ∞ p : LocSrc p → Aff. The inhomogeneous Klein–Gordon operators are then described by the natural transformation P =</p>

				<figure>
					<trash>{P (M ,J) } : A ∞ p ⇒ A ∞ p given by P (M ,J) : A ∞ p (M , J ) → A ∞ p (M , J ) , φ → P (M ,J) (φ) = M (φ) + m 2 φ + J . (2.2)</trash>


				</figure>

				<p>The solution spaces for these equations can be given a functorial form. Note that we do not assume that the solutions have spacelike compact support (there is no assumption on the support of J).</p>

				<figure>
					<head>Definition 2.2.</head>


				</figure>

				<p>The contravariant functor Sol p : LocSrc p → Aff is defined as follows: To any object (M , J ) in LocSrc p it associates the solution space</p>

				<figure>
					<trash>Sol p (M , J ) := {φ ∈ C ∞ (M, R p ) : P (M ,J) (φ) = KG M (φ) + J = 0} , (2.3) which is an affine space over the vector space Sol lin p (M ) := {φ ∈ C ∞ (M, R p ) : KG M (φ) = 0}. To any morphism f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p , Sol p associates the Aff-morphism given by the pull-back Sol p (f ) := f * : Sol p (M 2 , J 2 ) → Sol p (M 1 , J 1 ). 2.2 The presymplectic vector space functor</trash>


				</figure>

				<p>We follow the prescription of [BDS14a] in order to construct a covariant functor PS p : LocSrc p → PreSymp associating presymplectic vector spaces to objects in LocSrc p , whose role is to label certain affine functionals on Sol p (M , J ), i.e. observables of the theory. 2 Here PreSymp denotes the category of real presymplectic vector spaces, with all morphisms being assumed to be injective. The aim is to have sufficiently many observables to separate the solutions, while also removing redundancy by identifying observables that vanish on all solutions. Accordingly, to any object (M , J ) in LocSrc p we associate the object PS p (M , J ) in PreSymp given by the following construction: As a vector space,</p>

				<figure>
					<trash>PS p (M , J ) := C ∞ 0 (M, R p ) ⊕ R /P * (M ,J) [C ∞ 0 (M, R p )] , (2.4) where, for all h ∈ C ∞ 0 (M, R p ), P * (M ,J) (h) = KG M (h), M J , h vol M ∈ C ∞ 0 (M, R p ) ⊕ R . (2.5)</trash>


				</figure>

				<p>(One may also understand this construction as follows: PS p (M , J ) is (isomorphic to) the vector space of compactly supported sections of the vector dual bundle of our configuration bundle M × R p pr 1 → M (in the category of affine bundles) modulo the quotient which identifies with zero those elements corresponding to functionals which act trivially on all solutions. This viewpoint, which also leads naturally to the definitions of the presymplectic structure and morphisms given below, is spelled out in more detail in [BDS14a, Section 4 and Section 5].)</p>

				<p>The presymplectic structure in PS p (M , J ) is defined by, for all [(ϕ, α)], [(ψ, β)] ∈ PS p (</p>

				<figure>
					<trash>M , J ), σ (M ,J) [(ϕ, α)], [(ψ, β)] := M ϕ, E M (ψ) vol M , (2.6) where E M = E − M −E + M is the advanced-minus-retarded Green&apos;s operator for KG M , and the Green&apos;s operators obey supp(E ± M (ϕ)) ⊆ J ± M (supp(ϕ)). To any morphism f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p the functor PS p associates the morphism PS p (f ) : PS p (M 1 , J 1 ) → PS p (M 2 , J 2 ) in PreSymp that is canonically induced by the push- forward, PS p (f ) [(ϕ, α)] := [(f * (ϕ), α)] , (2.7) for any [(ϕ, α)] ∈ PS p (M 1 , J 1 ), which is well-defined because f * KG M 1 (h) , M 1 J 1 , h vol M 1 = P * (M 2 ,J 2 ) f * (h) , (2.8)</trash>


				</figure>

				<p>and injective because of the general result in [BDS14a, Theorem 5.4.]. As mentioned, the role of the covariant functor PS p is to label affine functionals on the contravariant functor Sol p . This manifests itself in a natural dual pairing: For each object (M , J ) in LocSrc p the evaluation map · , · (M ,J) : PS p (M , J ) × Sol p (M , J ) → R , [(ϕ, α)], φ → M ϕ, φ vol M + α (2.9) is well-defined and linear in the left and affine in the right entry. Naturality means that the following diagram commutes for any morphism f :</p>

				<figure>
					<trash>(M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p PS p (M 1 , J 1 ) × Sol p (M 2 , J 2 ) PS p (f )×id Solp(M 2 ,J 2 ) id PS p (M 1 ,J 1 ) ×Solp(f ) / / PS p (M 1 , J 1 ) × Sol p (M 1 , J 1 ) · , · (M 1 ,J 1 ) PS p (M 2 , J 2 ) × Sol p (M 2 , J 2 ) · , · (M 2 ,J 2 ) / / R (2.10)</trash>


				</figure>

				<p>Furthermore, the presymplectic structure in PS p (M , J ) coincides precisely with the Peierls bracket [Pei52] for the theory (1.1), on regarding elements of PS p (M , J ) as observables in this way.</p>

				<p>We summarize the main properties of the covariant functor PS p defined by (2.4), (2.6) and (2.7), which follow immediately from the general treatment of affine field theories in [BDS14a].</p>

				<figure>
					<head>Proposition 2.3.</head>


				</figure>

				<p>a) Let (M , J ) be any object in LocSrc p . Then the null space N p (M , J ) of the presymplectic structure in PS p (M , J ) is isomorphic to R.</p>

				<p>b) The null space is functorial, i.e. N p : LocSrc p → Vec is a covariant functor. c) The covariant functor PS p : LocSrc p → PreSymp satisfies the causality property and the time-slice axiom.</p>

				<p>Proof. The proof of a) follows from [BDS14a, Corollary 4.5.] and b) follows from [BDS14a, Lemma 7.3.]. Item c) is a consequence of [BDS14a, Theorem 5.5. and Theorem 5.6.].</p>

				<p>Due to the nontrivial null space of the presymplectic structure (cf. item a)) this theory has distinct features which are not present in the homogeneous Klein–Gordon theory, where the null space is trivial.</p>

			</div>
			<div>
				<head n="2.3">Quantization</head>

				<p>The theory PS p : LocSrc p → PreSymp may be quantized by composing it with the canonical commutation relation (CCR) functor (either in Weyl or polynomial form). Since these quantization functors preserve locality, causality and the time-slice axiom, we obtain a locally covariant quantum field theory in the sense of [BFV03, FV12a], with the difference that our underlying geometric category is enhanced from Loc to LocSrc p . This construction results in a functorial assignment of quantized observable algebras to objects in LocSrc p , i.e. a covariant functor LocSrc p → * Alg to the category of unital * -algebras. We would like to stress that in locally covariant quantum field theory the primary focus is on the functor describing the observables algebras, while quantum fields (being certain natural transformations with values in this functor, cf. [BFV03]) are secondary concepts which can be assigned once this functor is specified. Hence, we shall mostly focus in this work on the functor itself and refer the reader to Remark 7.10 (and also Remark 6.12) for an example of a locally covariant quantum (and classical) field for our model. For more details on the Weyl quantization functors for presymplectic vector spaces (and more general also presymplectic Abelian groups) we refer to the Appendix of [BDHS13]. The quantized theory of a multiplet of p ∈ N inhomogeneous Klein–Gordon fields is studied in detail in Section 7.</p>

			</div>
			<div>
				<head>3</head>

				<p>Relative Cauchy evolution of the functor PS p</p>

				<p>Relative Cauchy evolution encodes the sensitivity of a theory to variations in the background structures ; in this it closely resembles the action. Apart from its intrinsic interest, understanding the relative Cauchy evolution is also an integral step in characterizing the automorphism groups of our functors in Section 4. We base our analysis on the refined construction given in [FV12a], which we now review and adapt to our present setting.</p>

				<p>Given any object (M , J ) in LocSrc p , we can consider its perturbation by elements (h, j) ∈ Γ ∞ 0 (T * M ∨ T * M ) × C ∞ 0 (M, R p ), where Γ ∞ 0 (T * M ∨ T * M ) denotes the vector space of compactly supported sections of the symmetric tensor product of the cotangent bundle (i.e. symmetric tensor fields). Explicitly, given (h, j) ∈ Γ ∞ 0 (T * M ∨ T * M ) × C ∞ 0 (M, R p ) such that g + h is a timeorientable Lorentzian metric, we define (M [h], J [j]) := (M, o, g + h, t h ), J + j , where t h is the unique time-orientation for g + h, such that t h = t outside the support of h. If (M [h], J [j]) is an object in LocSrc p , i.e. if M [h] is globally hyperbolic, 3 we say that (h, j) is a globally hyperbolic perturbation and write (h, j) ∈ H(M , J ). Evidently H(M , J ) contains an open neighborhood of {0} × C ∞ 0 (M, R p ) in the usual test-section topology. For any object (M , J ) in LocSrc p and any (h, j) ∈ H(M , J ) we define the sets</p>

				<figure>
					<trash>M ± := M \ J ∓ M supp(h) ∪ supp(j) , (3.1)</trash>


				</figure>

				<p>which are causally compatible, open and globally hyperbolic subsets of M and M [h]. We further define M ± [h, j] := M | M ± = M [h]| M ± and J ± [h, j] := J| M ± = (J + j)| M ± . Notice that 3 It could happen that M [h] is not globally hyperbolic: consider g = dt ⊗ dt − n−1 k=1 dθ k ⊗ dθ k on R × T n−1 with h = 1 2 η(t)(dt ⊗ dθ1 + dθ1 ⊗ dt + 2dθ1 ⊗ dθ1) where η ∈ C ∞ 0 (R), 0 ≤ η ≤ 1, and η(0) = 1. Then g is globally hyperbolic, while g + h is Lorentzian and time-orientable but admits a closed null curve in the hypersurface t = 0. (M ± [h, j], J ± [h, j]) are objects in LocSrc p and further that the canonical inclusions of underlying manifolds yield Cauchy morphisms i ± (M ,J) [h, j] : M ± [h, j], J ± [h, j]</p>

				<figure>
					<trash>→ M , J , (3.2a) j ± (M ,J) [h, j]</trash>


				</figure>

				<p>: M ± [h, j], J ± [h, j] → M [h], J [j] . (3.2b)</p>

				<p>Since, by Proposition 2.3, PS p : LocSrc p → PreSymp satisfies the time-slice axiom, we can construct isomorphisms τ ± (M ,J) [h, j] : PS p (M , J ) → PS p (M [h], J [j]) in PreSymp by τ ± (M ,J) [h, j] := PS p (j</p>

				<figure>
					<trash>± (M ,J) [h, j]) • PS p (i ± (M ,J) [h, j]) −1 . (3.3) The relative Cauchy evolution of PS p induced by (h, j) ∈ H(M , J ) is defined as the automorphism rce (PS p ) (M ,J) [h, j] := τ − (M ,J) [h, j] −1 • τ + (M ,J ) [h, j] ∈ Aut(PS p (M , J )) , (3.4)</trash>


				</figure>

				<p>and may be computed as follows. Owing to the time-slice axiom, any element in PS p (M , J ) may be written in the form 4 [(ϕ, α)] (M ,J ) with ϕ supported in M + , whereupon τ + (M ,J) [h, j]([(ϕ, α)] (M ,J ) ) = [(ϕ, α)] (M [h],J[j]) . (3.5)</p>

				<p>In turn, given a representative (ϕ ′ , α ′ ) ∈ [(ϕ, α)] (M [h],J[j]) so that ϕ ′ has support in M − , the relative Cauchy evolution of [(ϕ,</p>

				<figure>
					<trash>α)] (M ,J ) is rce (PS p ) (M ,J) [h, j] [(ϕ, α)] (M ,J) = τ − (M ,J) [h, j]</trash>


				</figure>

				<p>−1 ([(ϕ, α)] (M [h],J[j]) ) = [(ϕ</p>

				<figure>
					<trash>′ , α ′ )] (M ,J ) . (3.6)</trash>


				</figure>

				<p>Thus it remains to find a suitable representative (ϕ ′ , α ′ ). By a standard argument, see e.g. [FV12b, Lemma 3.1.], we can find a smooth function χ ∈ C ∞ (M ), such that ϕ ′ = ϕ − KG M [h] χ E − M [h] (ϕ) has support in M − and such that χ E − M [h] (ϕ) has compact support. Explicitly, we take any two Cauchy surfaces Σ ± in M − [h, j] such that Σ + ∩ Σ − = ∅, Σ + is in the future of Σ − and supp(ϕ) ∪ supp(h) ∪ supp(j) is in the future of Σ + . Any χ such that χ| J + M[h] (Σ + ) ≡ 1 and χ| J − M[h] (Σ − ) ≡ 0 then leads by the formula above to a ϕ ′ with the desired properties. Using (2.5) and now dropping the labels on equivalence classes (which from now on are all taken with respect to (M , J )) we obtain for the relative Cauchy evolution rce (PS p ) (M ,J) [h, j] [(ϕ, α)] = ϕ − KG M [h] χ E − M [h]</p>

				<figure>
					<trash>(ϕ) , α − M J + j, χ E − M [h]</trash>


				</figure>

				<p>(ϕ) vol M [h] .</p>

				<figure>
					<trash>(3.7) As χ E − M [h]</trash>


				</figure>

				<p>(ϕ) is compactly supported, we may use the equivalence relation with respect to (M ,</p>

				<figure>
					<trash>J ) to obtain rce (PS p ) (M ,J) [h, j]</trash>


				</figure>

				<p>− id PS p (M ,J) [(ϕ, α)] = (KG M − KG M [h]</p>

				<figure>
					<trash>) χ E − M [h] (ϕ) , M (1 − ρ h )J − ρ h j, χ E − M [h] (ϕ) vol M , (3.8)</trash>


				</figure>

				<p>in which we have also written ρ h ∈ C ∞ 0 (M ) for the unique function such that vol M [h] = ρ h vol M , explicitly ρ h = |g + h|/ |g|. Noting that χ = 1 and E + M [h] (ϕ) = 0 on supp(j) ∪ supp(h), we may replace both occurrences of χ E − M [h] (ϕ) by E M [h]</p>

				<figure>
					<trash>(ϕ), obtaining rce (PS p ) (M ,J) [h, j]</trash>


				</figure>

				<p>− id PS p (M ,J) [(ϕ, α)] = (KG M −KG M [h] ) E M [h]</p>

				<figure>
					<trash>(ϕ) , M −j, E M [h] (ϕ) + (1 − ρ h )(J + j), E M [h] (ϕ) vol M , (3.9)</trash>


				</figure>

				<p>after a further slight rearrangement. Note that (3.9) applies only for representatives where ϕ is supported in M + . In this form, it is easy to see what the functional derivative of the relative Cauchy evolution with respect to h and j ought to be, simply by expanding to first order in these quantities. This procedure gives</p>

				<figure>
					<trash>d ds rce (PS p ) (M ,J) [sh, sj] [(ϕ, α)]</trash>


				</figure>

				<p>s=0 =: − T (M ,J) [h] + J (M ,J) [j]</p>

				<figure>
					<trash>[(ϕ, α)] , (3.10) where T (M ,J) [h] [(ϕ, α)]</trash>


				</figure>

				<p>= KG ′ M [h]</p>

				<figure>
					<trash>E M (ϕ) , M 1 2 g ab h ab J , E M (ϕ) vol M , (3.11a) J (M ,J) [j] [(ϕ, α)] = 0, M j, E M (ϕ) vol M , (3.11b) and KG ′ M [h]</trash>


				</figure>

				<p>= d ds KG M [sh] s=0 . 5 Formulae (3.11a) and (3.11b) hold for arbitrary representatives (ϕ, α). Note that elements in PS p (M , J ) which are of the form [(0, α)], α ∈ R, are left unchanged under the relative Cauchy evolution. In Appendix A, we shall show how (3.10) holds rigorously in the weak- * topology induced by the pairing (2.9). Moreover, we obtain the formula T (M ,J) [h]</p>

				<figure>
					<trash>[(ϕ, α)] , φ (M ,J) = 1 2 d ds M h ab T ab (M ,J) [φ + s E M (ϕ)] vol M s=0 , (3.12) where the stress-energy tensor is 6 T ab (M ,J) [φ] := − 2 |g| δS δg ab (x) = ∇ a φ, ∇ b φ − 1 2 g ab ∇ c φ, ∇ c φ + 1 2 m 2 g ab φ, φ + g ab J , φ , (3.13) and S is the classical action obtained from the Lagrangian (1.1). Similarly, it is clear from (3.11b) that J (M ,J) [j] [(ϕ, α)] , φ (M ,J) = d ds M j, φ + s E M (ϕ) vol M s=0 . (3.14)</trash>

					<figDesc>These formulae establish a close link between the relative Cauchy evolution and the action; indeed,</figDesc>
					<trash>d ds rce (PS p ) (M ,J) [sh, sj] [(ϕ, α)] , φ (M ,J) s=0 = δ 2 S δφδg E M (ϕ) ⊗ h + δ 2 S δφδJ E M (ϕ) ⊗ j , (3.15)</trash>


				</figure>

				<p>where the functional derivatives are evaluated at φ ∈ Sol p (M , J ), and on the background (M , J ), and we differentiate with respect to the covariant metric tensor.</p>

				<p>At this point the following remark is in order: The stress-energy tensor (3.13) is not covariantly conserved for generic (M , J ) and generic solutions φ of the inhomogeneous</p>

				<figure>
					<trash>Klein–Gordon equation, since ∇ a T ab (M ,J) [φ] = ∇ b J, φ . (3.16) Modifying T ab (M ,J)</trash>


				</figure>

				<p>by adding a constant functional, which would not change the derivative of the relative Cauchy evolution given in (3.12), does not change this fact. Repeating the arguments given in [BFV03, §4], the non-conservation law (3.16) (up to constant functionals) can also be derived directly from the relative Cauchy evolution. This perhaps unpleasant feature can be understood as follows: diffeomorphism invariance of the action derived from (</p>

				<figure>
					<trash>1.1) entails the identity δS δg (£ X g) + δS δJ (£ X J) + δS δφ (£ X φ) = 0 (3.17)</trash>


				</figure>

				<p>for all compactly supported vector fields X. When φ is on-shell, the last term vanishes and the identity implies (3.16). We cannot expect conservation of the stress-energy tensor in our theory, because J is non-dynamical; indeed (3.16) is the correct generalized conservation law in this case. (Were we to modify the theory, so that J became dynamical, the additional Euler–Lagrange equation φ = 0 would rather trivially restore conservation of the stress-energy tensor.)</p>

			</div>
			<div>
				<head>4</head>

				<p>Automorphism group of the functor PS p</p>

				<p>Given any covariant functor from LocSrc p to PreSymp it is interesting to study its endomorphisms and automorphisms [Few13]. The latter typically sheds light on possible symmetries of the theory at the functorial level, which is comparable to the global gauge group of Minkowski algebraic quantum field theory. In [Few13], the automorphism group of a theory describing a multiplet of p ∈ N classical real scalar fields satisfying the minimally coupled Klein–Gordon equation was found to be the orthogonal group O(p) if all masses coincide and are nonzero, or O(p) ⋉ R p if they all vanish. As mentioned in the Introduction, we expect the source terms in the inhomogeneous Klein–Gordon theory to break (at least for the massive case m = 0) all the symmetries of the homogeneous Klein– Gordon theory. It therefore comes as a surprise that the functor PS p turns out to have a nontrivial automorphism group for any mass m.</p>

				<p>We shall briefly fix some notation. Given any covariant functor F : LocSrc p → PreSymp, an endomorphism of F is a natural transformation η : F ⇒ F, i.e. a collection of morphisms η (</p>

				<figure>
					<trash>M ,J) : F(M , J ) → F(M , J ) in PreSymp, such that for any morphism f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p the following diagram commutes F(M 1 , J 1 ) η (M 1 ,J 1 ) F(f ) / / F(M 2 , J 2 ) η (M 2 ,J 2 ) F(M 1 , J 1 ) F(f ) / / F(M 2 , J 2 ) (4.1)</trash>


				</figure>

				<p>We denote the collection of all endomorphisms of F by End(F). An automorphism of F is an endomorphism η ∈ End(F), such that all η (M ,J ) are isomorphisms. Under composition, the automorphisms of F form a group denoted by Aut(F).</p>

				<p>The goal of this section is to characterize the automorphism group of the functor PS p : LocSrc p → PreSymp introduced in Section 2. Due to the following general statement, Aut(PS p ) is nontrivial.</p>

				<figure>
					<head>Proposition 4.1.</head>


				</figure>

				<p>Let F : LocSrc p → PreSymp be any covariant functor. Then there exists a faithful homomorphism η : Z 2 → Aut(F) given by η(σ) = {σ id F(M ,J) }, where σ ∈ Z 2 = {−1, +1}.</p>

			</div>
			<div>
				<head>Proof.</head>

				<p>Injectivity of η and the group law η(σ)@BULLETη(σ ′ ) = η(σ σ ′ ) are obvious. All η(σ) (M ,J) are clearly linear automorphisms and since σ 2 = 1 they preserve the presymplectic structure in F(M , J) (this follows from bilinearity of any presymplectic structure). For any morphism f in LocSrc p , η(σ) satisfies the diagram in (4.1), since F(f ) are in particular linear maps and hence commute with the multiplication by σ.</p>

				<p>The previous proposition in particular shows that Aut(PS p ) contains a Z 2 subgroup for all values of m. In the massless case we can say more.</p>

				<figure>
					<trash>Proposition 4.2. If m = 0 there exists a faithful homomorphism η : Z 2 × R p → Aut(PS p ) given by η(σ, µ) = {η(σ, µ) (M ,J ) }, where, for all [(ϕ, α)] ∈ PS p (M , J ), η(σ, µ) (M ,J) [(ϕ, α)] = σ ϕ, σ α + σ M ϕ, µ vol M . (4.2)</trash>


				</figure>

				<p>Here we have identified µ ∈ R p with the corresponding constant function in C ∞ (M, R p ).</p>

			</div>
			<div>
				<head>Proof.</head>

				<p>The main burden is to show that (4.2) does define a natural η(σ, µ) ∈ End(PS p ) for each (σ, µ) ∈ Z 2 × R p , because injectivity of η is obvious and it is easy to establish the group law η(σ, µ) • η(σ ′ , µ ′ ) = η(σ σ ′ , µ + µ ′ ), whereupon it is clear that each η(σ, µ) is a linear automorphism. We notice that η(σ, µ) (M ,J) is compatible with the quotient in PS p (</p>

				<figure>
					<trash>M , J ), since, for all h ∈ C ∞ 0 (M, R p ), η(σ, µ) (M ,J) P * (M ,J) (h) = η(σ, µ) (M ,J) KG M (h), M J , h vol M = σ KG M (h), σ M J , h vol M + σ M KG M (h), µ vol M = P * (M ,J) (σ h) , (4.3)</trash>


				</figure>

				<p>where in the last equality we have used that M KG M (h), µ vol M = M h, KG M (µ) vol M = 0 for the massless Klein–Gordon operator. It is easily seen that the linear map η(σ, µ) (M ,J) preserves the presymplectic structure in PS p (M , J ) and that it is injective (indeed, invertible, as already mentioned).</p>

				<figure>
					<trash>Thus η(σ, µ) (M ,J) ∈ Aut(PS p (M , J )). Now suppose that f : (M 1 , J 1 ) → (M 2 , J 2 ) is a morphism in LocSrc p . Then, for all [(ϕ, α)] ∈ PS p (M 1 , J 1 ), η(σ, µ) (M 2 ,J 2 ) • PS p (f ) (ϕ, α) = σ f * (ϕ), σ α + σ M 2 f * (ϕ), µ vol M 2 = PS p (f ) • η(σ, µ) (M 1 ,J 1 ) (ϕ, α) , (4.4) because M 2 f * (ϕ), µ vol M 2 = M 1 ϕ, f * (µ) vol M 1 = M 1 ϕ, µ vol M 1 . Hence, naturality is proved.</trash>


				</figure>

				<p>Our aim is now to prove that we actually have an isomorphism Aut(PS p ) ≃ Z 2 in the massive case and an isomorphism Aut(PS p ) ≃ Z 2 × R p for m = 0. For this endeavor we generalize the results of [Few13, §2.2.], which shall allow us to prove that every endomorphism η ∈ End(PS p ) is uniquely determined by its component η (M ,J) on any given object (M , J ) in LocSrc p .</p>

				<p>We start by collecting some useful lemmas, which were obtained in [Few13, §2.2.] for the category Loc.</p>

				<figure>
					<trash>Lemma 4.3. Let η ∈ End(PS p ) be any endomorphism and (M , J ) any object in LocSrc p . Then for all globally hyperbolic perturbations (h, j) ∈ H(M , J ) we have that rce (PS p ) (M ,J) [h, j] • η (M ,J) = η (M ,J) • rce (PS p ) (M ,J) [h, j]</trash>


				</figure>

				<p>. (4.5)</p>

			</div>
			<div>
				<head>Proof.</head>

				<p>The essential idea is naturality of η. The detailed steps can be found in [FV12a, Proposition 3.8.].</p>

				<figure>
					<trash>Lemma 4.4. Let η, η ′ ∈ End(PS p ) and suppose that η (M ,J) = η ′ (M ,J) for some object (M , J ) in LocSrc p . Then the following hold true: (i) If f : (L, J L ) → (M , J ) is a morphism in LocSrc p , then η (L,J L ) = η ′ (L,J L ) . (ii) If f : (M , J ) → (N , J N ) is a Cauchy morphism in LocSrc p , then η (N ,J N ) = η ′ (N ,J N ) . (iii) η (L,J L ) = η ′ (L,J L ) for any object (L, J L ) in LocSrc p</trash>


				</figure>

				<p>, such that the Cauchy surfaces of L are oriented diffeomorphic to those of M | O , for some O ∈ O(M ). Here O(M ) is the set of all causally compatible, open and globally hyperbolic subsets of M with finitely many connected components all of which are mutually causally disjoint.</p>

				<p>Proof. Item (i) and (ii) are simple consequences of naturality of η, η ′ and the fact that PS p (f ) is injective for (i) and even an isomorphism for (ii), cf. [Few13, Proof of Lemma 2.2.]. Item (iii) follows from a generalization of the &quot; Cauchy wedge connectedness &quot; property to the category LocSrc p that we shall discuss now in detail. Forgetting the source terms, more precisely, applying the forgetful functor from LocSrc p to Loc, it was shown in [FV12a, Proposition 2.4.] that under our hypotheses there is a chain of morphisms in Loc</p>

				<figure>
					<trash>L L ′ c o o c / / L ′′ L ′′′ c o o c / / M | O ι M ;O / / M , (4.6)</trash>

					<figDesc>where ι M ;O denotes the canonical inclusion and by &apos;c&apos; we indicate Cauchy morphisms. If we could construct from this chain a chain of morphisms in LocSrc p of the form</figDesc>
					<trash>(L, J L ) (L ′ , J L ′ ) c o o c / / (L ′′ , J L ′′ ) (L ′′′ , J L ′′′ ) c o o c / / (M | O , J| O ) ι M;O / / (M , J ) , (4.7)</trash>


				</figure>

				<p>then the same argument as in [Few13, Proof of Lemma 2.2.] (combining results (i) and (ii)) would prove (iii). Since the morphisms in (4.6) uniquely fix J L ′ and J L ′′′ via pulling back, respectively, J L and J | O , the remaining step is to show that we can construct a J L ′′ completing the chain (4.7). This is indeed possible if we equip the spacetime L ′′ constructed in [FV12a, Proof of Proposition 2.4.] with a J L ′′ that is obtained by gluing J L ′ and J L ′′′ via a suitable cutoff function (e.g. the one used to construct the metric in L ′′ ).</p>

				<p>We are now ready to prove the analog of [Few13, Theorem 2.6.] for our specific functor PS p : LocSrc p → PreSymp. Since we are working with a specific model we can give a direct proof and we do not have to dwell on the technicalities concerning abstract categorical unions and equalizers appearing in [Few13].</p>

				<figure>
					<head>Theorem 4.5.</head>

					<figDesc>Every η ∈ End(PS p ) is uniquely determined by its component η (M ,J) on any object (M , J ) in LocSrc p .</figDesc>

				</figure>

				<p>Proof. Suppose that η ′ ∈ End(PS p ) agrees with η on the object (M , J ) in LocSrc p , i.e. η (M ,J) = η ′ (M ,J) . Let (N , J N ) be any object in LocSrc p and let D be any diamond in N . Then N | D has Cauchy surfaces which are oriented diffeomorphic to any diamond in M .</p>

				<figure>
					<trash>Then η (N | D ,J N | D ) = η ′ (N | D ,J N | D ) by Lemma 4.4 (iii). Using the canonical inclusion ι N ;D : (N | D , J N | D ) → (N , J N ) we obtain by naturality η (N ,J N ) • PS p (ι N ;D ) = PS p (ι N ;D ) • η (N | D ,J N | D ) = PS p (ι N ;D ) • η ′ (N | D ,J N | D ) = η ′ (N ,J N ) • PS p (ι N ;D ) . (4.8) This equation implies that η (N ,J N ) [(ϕ, α)] = η ′ (N ,J N ) [(ϕ, α)]</trash>


				</figure>

				<p>, for all [(ϕ, α)] ∈ PS p (N , J N ) for which there exists a representative (ϕ, α) such that ϕ has compact support in D. We shall now prove that η (N ,J N ) [(ϕ, α)] = η ′ (N ,J N ) [(ϕ, α)] , for all [(ϕ, α)] ∈ PS p (N , J N ), and hence that η ′ = η since (N , J N ) was arbitrary. This proof follows from a partition of unity argument: Given any [(ϕ, α)] ∈ PS p (N , J N ) we take some representative (ϕ, α) ∈ C ∞ 0 (N, R p ) ⊕ R. Since supp(ϕ) is compact, the open cover of N given by the set of all diamonds in N has a finite subcover of supp(ϕ), which we denote by {D i } i=1,...,n . Using a partition of unity subordinated to {D i } i=1,...,n we can write (ϕ, α) = n i=1 (ϕ i , α/n), where ϕ i has compact support in D i .</p>

				<figure>
					<trash>Hence, η (N ,J N ) [(ϕ, α)] = n i=1 η (N ,J N ) [(ϕ i , α/n)] = n i=1 η ′ (N ,J N ) [(ϕ i , α/n)] = η ′ (N ,J N ) [(ϕ, α)] . (4.9)</trash>


				</figure>

				<p>We now come to the main statement of this section.</p>

				<figure>
					<head>Theorem 4.6.</head>

					<figDesc>Every endomorphism of the functor PS p is an automorphism and</figDesc>
					<trash>End(PS p ) = Aut(PS p ) ≃ Z 2 , for m = 0 , Z 2 × R p , for m = 0 , (4.10)</trash>


				</figure>

				<p>where the action is given for m = 0 by Proposition 4.1, and for m = 0 by Proposition 4.2.</p>

				<p>Proof. Due to Theorem 4.5, any η ∈ End(PS p ) is uniquely determined by its component η (M 0 ,0) , where M 0 is Minkowski spacetime and we have chosen J 0 = 0. The presymplectic vector space PS p (M 0 , 0) can be expressed more conveniently using the following linear isomorphism for the underlying vector space C</p>

				<figure>
					<trash>∞ 0 (M 0 , R p ) ⊕ R /P * (M 0 ,0) C ∞ 0 (M 0 , R p ) = C ∞ 0 (M 0 , R p ) ⊕ R / KG M 0 C ∞ 0 (M 0 , R p ) ⊕ {0} = C ∞ 0 (M 0 , R p )/KG M 0 C ∞ 0 (M 0 , R p ) ⊕ R ≃ Sol sc (M 0 ) ⊕ R , (4.11) where Sol sc (M 0 ) := {φ ∈ C ∞ sc (M 0 , R p ) : KG M 0</trash>


				</figure>

				<p>(φ) = 0} is the space of solutions of the Klein– Gordon equation with spacelike compact support. The isomorphism in the last line of (4.11) is the usual one given by the advanced-minus-retarded Green&apos;s operator E M 0 . The induced presymplectic structure on Sol sc (M 0 ) ⊕ R is given by, for all (φ, α), (ψ, β) ∈</p>

				<figure>
					<trash>Sol sc (M 0 ) ⊕ R, σ (M 0 ,0) (φ, α), (ψ, β) = σ M 0 (φ, ψ) , (4.12) where σ M 0 is the usual symplectic structure on Sol sc (M 0 ). Via the isomorphism (4.11), η (M 0 ,0) induces an endomorphism η of Sol sc (M 0</trash>


				</figure>

				<p>) ⊕ R which, by naturality, commutes with the action of all Poincaré transformations. By Lemma 4.3, η commutes with the relative Cauchy evolution, and therefore with its derivatives given in (3.11a) and (3.11b).</p>

				<p>Taking into account the isomorphism (4.11) and our specific choice of object (M 0 , 0) they read, for all (φ, α) ∈</p>

				<figure>
					<trash>Sol sc (M 0 ) ⊕ R, T (M 0 ,0) [h](φ, α) = E M 0 KG ′ M 0 [h] (φ) , 0 , (4.13a) J (M 0 ,0) [j](φ, α) = 0, M 0 j, φ vol M 0 . (4.13b) Since η : Sol sc (M 0 ) ⊕ R → Sol sc (M 0 ) ⊕ R is a linear map, it decomposes into linear maps L 11 : Sol sc (M 0 ) → Sol sc (M 0 ), L 12 : R → Sol sc (M 0 ), L 21 : Sol sc (M 0 ) → R and L 22 : R → R. As η commutes with the maps in (4.13), we obtain the following conditions on the L ij , for all (φ, α) ∈ Sol sc (M 0 ) ⊕ R and (h, j) ∈ H(M 0 , 0), E M 0 KG ′ M 0 [h] L 11 (φ) + L 12 (α) , 0 = L 11 E M 0 KG ′ M [h] (φ) , L 21 E M 0 KG ′ M [h] (φ) (4.14a) and 0, M 0 j, L 11 (φ) + L 12 (α) vol M 0 = L 12 M 0 j, φ vol M 0 , L 22 M 0 j, φ vol M 0 . (4.14b)</trash>


				</figure>

				<p>From the first component of (4.14b) we obtain that L 12 = 0. Substituting into (4.14a) we obtain from the first component the same condition that is present for multiplets of homogeneous Klein– Gordon fields. The only solution of this condition (supplemented by additional conditions stemming from the Poincaré invariance of Minkowski spacetime) is that L 11 is an O(p) transformation acting in the obvious way on the components of φ, cf. [Few13, Theorem 5.2.]. Using this information the second component of (4.14b) implies that L 11 = σ id Sol sc (M 0 ) and L 22 = σ id R , with σ ∈ Z 2 = {−1, +1}. Finally, the fact that endomorphisms commute with the Poincaré transformations entails that L 21 : Sol sc (M 0 ) → R is Poincaré invariant. By Lemma 4.7 below, we deduce that L 21 = 0 for m = 0, or that L 21 ( · ) = σ M 0 (µ, · ) for some µ ∈ R p if m = 0 (here µ denotes a constant solution).</p>

				<figure>
					<trash>Combining these facts, we have η(φ, α) = (σ φ, σ α) , for m = 0 , (σ φ, σ (α + σ M 0 (µ, φ))) , for m = 0 , (4.15)</trash>


				</figure>

				<p>for some σ ∈ Z 2 (and µ ∈ R p if m = 0). Undoing the isomorphism (4.11), this means that for m = 0 we have η (M 0 ,0) = η(σ, µ) (M 0 ,0) and hence η = η(σ, µ) by Theorem 4.5. Similarly, η = η(σ) = {σ id PS p (M ,J) } if m = 0. This proves the result.</p>

				<p>It remains to prove the following Lemma 4.7. Suppose L : Sol sc (M 0 ) → R is linear and translationally invariant. If m = 0 then L = 0. If m = 0 then there exists µ ∈ R p such that L(φ) = σ M 0 (µ, φ).</p>

				<p>Proof. We use the automatic continuity result of Meisters [Mei71] that the translationally invariant linear functionals on C ∞ 0 (R k , R p ) are precisely the scalar multiples of the integral. Passing to Cauchy data on any surface t = const., L decomposes into two linear functionals on C ∞ 0 (R k , R p ) that are each translationally invariant, owing to spatial translational invariance of L. Hence, for each t there are α t , β t ∈ R p such that, for any φ ∈ Sol sc (M 0 ),</p>

				<figure>
					<trash>L(φ) = R k d k x α t , φ(t, x) + β t , ∂φ ∂t (t, x) . (4.16)</trash>


				</figure>

				<p>By time-translational invariance of L, α t ≡ α and β t ≡ β are independent of t. Further, differentiating with respect to t, using the Klein–Gordon equation and Gauss&apos; theorem, we obtain, for all φ ∈</p>

				<figure>
					<trash>Sol sc (M 0 ), 0 = R k d k x α, ∂φ ∂t (t, x) − βm 2 , φ(t, x) (4.17)</trash>


				</figure>

				<p>and hence that α = 0, βm 2 = 0. The result follows (with µ = β).</p>

				<p>The results of this section reveal that the functor PS p has a larger automorphism group than one would expect for the global gauge group of the inhomogeneous theory. To close the section, we mention that the Z 2 factor of Aut(PS p ) can be removed if we change the category in which PS p takes values to reflect the fact that the underlying vector space of PS p (M , J ) is a linear subspace of the algebraic affine dual of the space of solutions Sol p (M , J ) (i.e. the vector space of affine maps Sol p (M , J ) → R). Were we to restrict to morphisms arising as restrictions of duals to affine maps, we would be left with a trivial automorphism group for m = 0 and R p for m = 0. We do not develop this line of thought in detail, because the next section shows that PS p has further pathologies, which would not be eliminated by this device. Nevertheless, it is worth noting that the unexpected symmetries appear because we have discarded information about the action of the observables in PS p (M , J ) on the solution space.</p>

			</div>
			<div>
				<head>5</head>

				<p>Violation of the composition property of the functor PS p</p>

				<p>The theory we aim to construct consists of p inhomogeneous Klein–Gordon fields without mutual interactions. One would expect that an equivalent formulation would be produced if the multiplet were decomposed into independent submultiplets of 0 &lt; q &lt; p and p − q fields, which are treated separately according to the general prescription and then recombined. In this section, we describe how the splitting and recombination may be formalized and then show that the functor PS p fails to respect this composition property. We would like to emphasize that for proving the violation of the composition property our functorial language is not strictly necessary; in fact, as we will show in Proposition 5.3, the composition property is already violated on any fixed object (M , J ) in LocSrc p , even if we choose the Minkowski space M 0 with trivial source J 0 = 0. However, we find it interesting to develop functorial techniques in order to formulate and disprove the composition property, as this point of view is the natural one in the spirit of locally covariant field theory and it is flexible enough for axiomatization, which might play a role in future studies in this field. Moreover, we will show later that the improved formulation we describe in the following sections does satisfy the composition property in this functorial sense.</p>

				<p>Let p ≥ 2 and let Π q : R p → R p , (a 1 , . . . , a p ) → (a 1 , . . . , a q , 0, . . . , 0) be the projection onto the first q dimensions, where 0 &lt; q &lt; p.</p>

				<figure>
					<trash>Given any object (M , J ) of LocSrc p , we can split J = Π q (J ) + (id R p − Π q )(J ) =: J q + J p−q and identify J q as an element in C ∞ (M, R q ) and J p−q as an element in C ∞ (M, R p−q ). Hence, we can associate to (M , J ) the object Split p,q (M , J ) := (M , J q ), (M , J p−q ) in the product category LocSrc q × LocSrc p−q . Moreover, given any morphism f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p we associate a morphism in LocSrc q × LocSrc p−q via Split p,q (f ) := (f, f ) : Split p,q (M 1 , J 1 ) → Split p,q (M 2 , J 2</trash>

					<figDesc>), where with a slight abuse of notation we have denoted the smooth map underlying the morphism by the same symbol f : M 1 → M 2 .</figDesc>

				</figure>

				<p>In this way we obtain a covariant functor Split p,q : LocSrc p → LocSrc q × LocSrc p−q representing the decomposition into submultiplets.</p>

				<p>Treating each submultiplet according to the prescription of Section 2.2, we compose Split p,q with the covariant functor PS q × PS p−q to obtain PS q × PS p−q • Split p,q : LocSrc p → PreSymp × PreSymp. Finally, we recombine the resulting theories by composing with the covariant functor ⊕ : PreSymp × PreSymp → PreSymp that forms the direct sum of two presymplectic vector spaces – the monoidal structure in this category. Explicitly, for any object (</p>

				<figure>
					<trash>(V, σ V ), (W, σ W )) in PreSymp × PreSymp we define ⊕ (V, σ V ), (W, σ W ) := (V ⊕ W, σ V ⊕W ), where V ⊕ W is the direct sum of vector spaces and, for all (v, w), (v ′ , w ′ ) ∈ V ⊕ W , σ V ⊕W (v, w), (v ′ , w ′ ) := σ V (v, v ′ ) + σ W (w, w ′ ) . (5.1) On morphisms, ⊕(L, K) := L ⊕ K. The resulting covariant functor is PS p,q := ⊕ • PS q × PS p−q • Split p,q : LocSrc p → PreSymp . (5.2)</trash>


				</figure>

				<p>Since the covariant functor PS p : LocSrc p → PreSymp satisfies the causality property and the time-slice axiom for all p ∈ N (cf. Proposition 2.3), it is not hard to see that the same holds true for the covariant functor PS p,q : LocSrc p → PreSymp.</p>

				<figure>
					<head>Proposition 5.1.</head>


				</figure>

				<p>The covariant functor PS p,q : LocSrc p → PreSymp satisfies the causality property and the time-slice axiom for all 2 ≤ p ∈ N and 0 &lt; q &lt; p.</p>

				<p>Proof. Causality holds owing to causality of PS p−q and PS q and the following property of the direct sum: if PreSymp-morphisms L i : (V i , σ V i ) → (V, σ V ), i = 1, 2, have symplectically orthogonal images, and so do K i : (W i , σ W i ) → (W, σ W ), i = 1, 2, then L 1 ⊕K 1 and L 2 ⊕K 2 have symplectically orthogonal images in (V ⊕ W, σ V ⊕W ) because σ V ⊕W = σ V ⊕ σ W by (5.1). The time-slice axiom holds simply because the direct sum of two presymplectic isomorphisms is itself a presymplectic isomorphism.</p>

				<p>We shall now prove that the theories PS p,q and PS p are inequivalent for 0 &lt; q &lt; p; that is, the functors are not naturally isomorphic. This will be a consequence of the following simple</p>

				<figure>
					<trash>Lemma 5.2. Let L : (V, σ V ) → (W, σ W ) be an isomorphism in PreSymp. Then L induces a linear isomorphism between the null spaces N (V, σ V ) and N (W, σ W ). Proof. The PreSymp-isomorphism L induces an injective linear map L : N (V, σ V ) → W . The image L[N (V, σ V )] is contained in N (W, σ W ), since for all v ∈ N (V, σ V ) and w ∈ W , σ W L(v), w = σ W L(v), L(L −1 (w)) = σ V v, L −1 (w) = 0 . (5.3) Hence, L : N (V, σ V ) → N (W, σ W ) is a linear map that is invertible via L −1 : N (W, σ W ) → N (V, σ V ).</trash>

					<head>Proposition 5.3.</head>


				</figure>

				<p>For any 2 ≤ p ∈ N and 0 &lt; q &lt; p, the covariant functors PS p,q : LocSrc p → PreSymp and PS p : LocSrc p → PreSymp are not naturally isomorphic. Indeed, there is no object (M , J ) in LocSrc p for which the presymplectic vector spaces PS p,q (M , J ) and PS p (M , J ) are isomorphic.</p>

				<p>Proof. We argue by contradiction. Suppose there were a PreSymp-isomorphism L : PS p,q (M , J ) → PS p (M , J ) for some object (M , J ) in LocSrc p . Then L induces a linear isomorphism between the null spaces of PS p,q (M , J ) and PS p (M , J ) by Lemma 5.2. However, the latter is isomorphic to R (cf. Proposition 2.3), while the former is easily seen to be isomorphic to R 2 . Hence, no such isomorphism exists and consequently the functors PS p,q and PS p are not naturally isomorphic.</p>

			</div>
			<div>
				<head n="6">The Poisson algebra functor</head>

				<p>In order to resolve the pathological composition property of the functor PS p obtained in Section 5, as well as the mysterious automorphism group of Theorem 4.6 (cf. also the text below Lemma 4.7), we introduce further structures. Naively speaking, we aim to make the theory given by PS p remember that it describes the affine functionals on the affine space of solutions of the inhomogeneous Klein–Gordon equation. To realize this idea, we first construct from PS p a functor describing (abstract) Poisson algebras of observables, which are then represented non-faithfully on the solution space. The kernel of this representation is then identified and it is shown that the quotients of the Poisson algebras by these kernels are described by a covariant functor which has the desired automorphism group and the composition property. In Appendix B we present an alternative strategy for improving the classical theory of the inhomogeneous multiplet of Klein–Gordon fields by using pointed presymplectic spaces.</p>

			</div>
			<div>
				<head n="6.1">Canonical Poisson algebras</head>

				<p>Recall that a unital Poisson algebra over R is an associative and commutative unital algebra A over R together with a Poisson bracket, i.e. a Lie bracket {·, ·} A : A × A → A which satisfies the derivation property {a, b c} A = {a, b} A c + b {a, c} A , for all a, b, c ∈ A. A unit-preserving Poisson algebra homomorphism κ : A → B between two unital Poisson algebras A, B over R is a unital algebra homomorphism κ : A → B that preserves the Poisson brackets, i.e. {·, ·} B • (κ × κ) = {·, ·} A . Let us denote by PoisAlg the category of unital Poisson algebras over R, with injective unit-preserving Poisson algebra homomorphisms as morphisms. We first construct a covariant functor CanPois : PreSymp → PoisAlg that associates canonical Poisson algebras to presymplectic vector spaces: Given any object (V, σ V ) in PreSymp, let us consider the symmetric tensor algebra</p>

				<figure>
					<trash>S(V ) := ∞ k=0 S k (V ), where S 0 (V ) = R, S 1 (V ) = V and S k (V ) := k V , for k ≥ 2, is the k-th symmetric power of V . The product in S(V ) is denoted by juxtaposition and turns S(V ) into an associative and commutative algebra over R with unit 1 ∈ S 0 (V ) ⊂ S(V ). We define a Poisson bracket {·, ·} σ V : S(V ) × S(V ) → S(V ) by, for all α ∈ S 0 (V ) and v 1 , . . . , v k , v ′ 1 , . . . , v ′ l ∈ V , {α, v 1 · · · v k } σ V = {v 1 · · · v k , α} σ V = 0 , (6.1a) {v 1 · · · v k , v ′ 1 · · · v ′ l } σ V = k i=1 l j=1 v 1 · · · i ∨ . · · · v k v ′ 1 · · · j ∨ . · · · v ′ l σ V (v i , v ′ j ) . (6.1b) The symbols i ∨ . mean the omission of the i-th element. We denote the resulting Poisson algebra by CanPois(V, σ V ) := S(V ), {·, ·} σ V . Given any morphism L : (V, σ V ) → (W, σ W ) in PreSymp we associate a map CanPois(L) : CanPois(V, σ V ) → CanPois(W, σ W ) via CanPois(L)(α) = α, for all α ∈ S 0 (V ), and CanPois(L)(v 1 · · · v k ) = L(v 1 ) · · · L(v k ), for all v 1 , . . . , v k ∈ V . It is easy to see that CanPois(L) is an injective Poisson algebra homomorphism. Thus, we have shown the following</trash>

					<head>Proposition 6.1. The association CanPois :</head>

					<figDesc>PreSymp → PoisAlg constructed above is a covariant functor.</figDesc>
					<trash>Remark 6.2. Notice that for any object (V, σ V ) in PreSymp the Poisson algebra CanPois(V, σ V ) is N 0 -graded. Furthermore, for any morphism L : (V, σ V ) → (W, σ W ) in PreSymp the morphism CanPois(L) : CanPois(V, σ V ) → CanPois(W, σ W</trash>


				</figure>

				<p>) is a graded Poisson algebra morphism. Hence, CanPois is also a covariant functor to the category of N 0 -graded Poisson algebras. As will become clear in the next subsection, the latter category is too restrictive for our purposes, hence we shall usually disregard this natural grading.</p>

				<p>We can compose our functor PS p : LocSrc p → PreSymp with CanPois : PreSymp → PoisAlg to obtain the covariant functor CPA p := CanPois • PS p : LocSrc p → PoisAlg, which we call the canonical Poisson algebra functor. We immediately observe the following Proposition 6.3. The covariant functor CPA p : LocSrc p → PoisAlg satisfies the causality property and the time-slice axiom. Moreover, Aut(CPA p ) contains a Z 2 subgroup for m = 0 and a Z 2 × R p subgroup for m = 0.</p>

				<p>Proof. By Proposition 2.3 c) the functor PS p satisfies these properties. Thus CanPois automatically obeys the time-slice property because functors preserve isomorphisms. The causality property is seen as follows: Given any two PreSymp-morphisms L i : (V i , σ V i ) → (V, σ V ), i = 1, 2, such that σ V L 1 [V 1 ], L 2 [V 2 ] = {0} in (V, σ V ), then the explicit expression for the</p>

				<figure>
					<trash>Poisson bracket (6.1) implies that {·, ·} σ V acts trivially between CanPois(L 1 ) CanPois(V 1 , σ 1 ) and CanPois(L 2 ) CanPois(V 2 , σ 2 ) .</trash>


				</figure>

				<p>The statement on the automorphism group follows from Theorem 4.6 and the fact that every automorphism η = {η (M ,J) } of PS p lifts to an automorphism {CanPois(η (M ,J) )} of CPA p .</p>

				<p>Next, we shall show that the functor CPA p violates the analog of the composition property for PS p discussed in Section 5, cf. Proposition 5.3. For 2 ≤ p ∈ N and 0 &lt; q &lt; p, we define the covariant functor</p>

				<figure>
					<trash>CPA p,q := ⊗ • CPA q × CPA p−q • Split p,q : LocSrc p → PoisAlg , (6.2) where ⊗ :</trash>

					<figDesc>PoisAlg×PoisAlg → PoisAlg is the covariant functor that takes (algebraic) tensor products of Poisson algebras. Explicitly, to any object (A, B) in PoisAlg × PoisAlg we associate the object ⊗(A, B) := A ⊗ B in PoisAlg, which is the tensor product of the underlying commutative and associative unital algebras, equipped with the Poisson bracket specified by linearity and, for all</figDesc>
					<trash>a, a ′ ∈ A and b, b ′ ∈ B, {a ⊗ b, a ′ ⊗ b ′ } A⊗B := {a, a ′ } A ⊗ (b b ′ ) + (a a ′ ) ⊗ {b, b ′ } B . (6.3) To any morphism (κ, λ) : (A 1 , B 1 ) → (A 2 , B 2 ) in PoisAlg × PoisAlg we associate the morphism ⊗(κ, λ) := κ ⊗ λ : A 1 ⊗ B 1 → A 2 ⊗ B 2 in PoisAlg specified by linearity and, for all a ∈ A 1 and b ∈ B 1 , (κ ⊗ λ) a ⊗ b = κ(a) ⊗ λ(b).</trash>


				</figure>

				<p>To show that the covariant functors CPA p,q and CPA p are inequivalent, we require two lemmas.</p>

				<figure>
					<trash>Lemma 6.4. Let (V, σ V ) and (W, σ W ) be two objects in PreSymp. Then there exists an isomorphism L : (V, σ V ) → (W, σ W ) in PreSymp if and only if there exists an isomorphism κ : CanPois(V, σ V ) → CanPois(W, σ W ) in PoisAlg. Moreover, the isomorphisms κ and L are related by L = π S 1 (W ) • κ| S 1 (V ) , where κ| S 1 (V ) is the restriction of κ to the vector subspace S 1 (V ) ⊆ CanPois(V, σ V ) and π S 1 (W ) : CanPois(W, σ W ) → S 1 (W</trash>


				</figure>

				<p>) is the projection to the degree one vector subspace S 1 (W ). L is uniquely determined by κ, but L does not determine κ.</p>

				<p>Proof. The direction &quot; ⇒ &quot; is a consequence of functoriality, because CanPois preserves isomorphisms . To show the reverse direction, suppose that κ : CanPois(V, σ V ) → CanPois(W, σ W ) is a PoisAlg-isomorphism. In particular, κ is a unital algebra isomorphism κ : S(V ) → S(W ) between the symmetric tensor algebras of V and W . This algebra isomorphism is uniquely specified by its action on arbitrary v ∈</p>

				<figure>
					<trash>S 1 (V ) = V , so let us write κ(v) = κ 0 (v)+ κ 1 (v)+ κ ≥2 (v), where κ 0 : V → R, κ 1 : V → W and κ ≥2 : V → S ≥2 (W ) are the projections of κ| S 1 (V ) to the subspaces S 0 (W ), S 1 (W ) and S ≥2 (W ) := ∞ k=2 S k (W ). We now will show that, given any PoisAlg-isomorphism κ, there exists a PoisAlg-isomorphism κ : CanPois(V, σ V ) → CanPois(W, σ W ), with κ 0 = 0 and κ 1 = κ 1 . Consider the PoisAlg-automorphism χ : CanPois(V, σ V ) → CanPois(V, σ V ) defined by, for all v ∈ V , χ(v) = v − κ 0 (v). Define κ := κ@BULLETχ : CanPois(V, σ V ) → CanPois(W, σ W ), which is as a composition of PoisAlg-isomorphisms again a PoisAlg-isomorphism and notice that κ(v) = κ 1 (v) + κ ≥2 (v), for</trash>


				</figure>

				<p>any v ∈ V . As κ is an algebra homomorphism, it is therefore lower-triangular with respect to the gradings of CanPois(V, σ V ) and CanPois(W, σ W ): the degree-k component of any κ(a) depends only on the components of a with degree k or less. Accordingly, κ −1 is also lower-triangular, and all diagonal entries π S k (W ) • κ| S k (V ) (k ∈ N 0 ) are vector space isomorphisms. In particular, κ 1 : V → W is a vector space isomorphism. The claim that κ 1 : (V, σ V ) → (W, σ W ) is a PreSymp-isomorphism follows by evaluating both sides of the condition, for all v, v ′ ∈ V , κ {v, v ′ } σ V = { κ(v), κ(v ′ )} σ W .</p>

				<p>We next show that the covariant functor CPA p,q defined in (6.2) is naturally isomorphic to the covariant functor CanPois • PS p,q , where PS p,q is defined in (5.2). This follows from the more general</p>

				<figure>
					<trash>Lemma 6.5. The covariant functors CanPois@BULLET⊕ : PreSymp×PreSymp → PoisAlg and ⊗@BULLET(CanPois× CanPois) : PreSymp × PreSymp → PoisAlg are naturally isomorphic. Specifically, the PoisAlg- morphisms η ((V,σ V ),(W,σ W )) : CanPois(V ⊕ W, σ V ⊕W ) → CanPois(V, σ V ) ⊗ CanPois(W, σ W ) (6.4) specified by, for all (v, w) ∈ V ⊕W , η ((V,σ V ),(W,σ W )) (v, w) = v⊗1+1⊗w define a natural isomorphism {η ((V,σ V ),(W,σ W )) } : CanPois • ⊕ ⇒ ⊗ • (CanPois × CanPois). Proof. η := η ((V,σ V ),(W,σ W ))</trash>


				</figure>

				<p>is clearly a linear map (of N 0 -degree zero) and therefore induces a unital algebra homomorphism S(V ⊕ W ) → S(V ) ⊗ S(W ), which preserves the natural N 0 -gradings (with a slight abuse of notation we use for the graded tensor product the same symbol ⊗). A simple computation shows that η preserves the Poisson bracket of elements in S 1 (V ⊕ W ) and is therefore a Poisson morphism by (6.1). The inverse to η is given by η −1 (v⊗1) = (v, 0) and η −1 (1⊗w) = (0, w) on the generators v ⊗ 1 and 1 ⊗ w, with v ∈ V and w ∈ W , of S(V ) ⊗ S(W ), and extended as a unital algebra homomorphism.</p>

				<p>It remains to show naturality.</p>

				<figure>
					<trash>Let (L, K) : ((V 1 , σ V 1 ), (W 1 , σ W 1 )) → ((V 2 , σ V 2 ), (W 2 , σ W 2 )) be a morphism in PreSymp × PreSymp, and denote η 1 := η ((V 1 ,σ V 1 ),(W 1 ,σ W 1 )) and η 2 := η ((V 2 ,σ V 2 ),(W 2 ,σ W 2 )) . Then, for all (v, w) ∈ V 1 ⊕ W 1 , η 2 L ⊕ K(v, w) = η 2 (L(v), K(w)) = L(v) ⊗ 1 + 1 ⊗ K(w) = (L ⊗ K)(v ⊗ 1) + (L ⊗ K)(1 ⊗ w) = (L ⊗ K)(η 1 (v, w)), (6.5) which proves naturality since (v, w) ∈ V 1 ⊕ W 1 are the generators of S(V 1 ⊕ W 1 ).</trash>


				</figure>

				<p>We now can prove the violation of the composition property.</p>

				<p>Proposition 6.6. For any 2 ≤ p ∈ N and 0 &lt; q &lt; p, the covariant functors CPA p,q : LocSrc p → PoisAlg and CPA p : LocSrc p → PoisAlg are not naturally isomorphic. Indeed, there is no object</p>

				<figure>
					<trash>(M , J ) in LocSrc p for which the Poisson algebras CPA p,q (M , J ) and CPA p (M , J ) are isomorphic. Proof. We argue by contradiction: suppose CPA p,q (M , J ) and CPA p (M , J ) are PoisAlg-isomorphic for some object (M , J ) in LocSrc p . Then CanPois(PS p (M , J )) and CanPois PS q (M , J q ) ⊕ PS p−q (M , J p−q ) are also PoisAlg-isomorphic by Lemma 6.5, and hence by Lemma 6.4 we have that PS p (M , J ) and PS q (M , J q ) ⊕ PS p−q (M , J p−q ) are PreSymp-isomorphic. But this is excluded by Proposition 5.3. 6.2 Improved Poisson algebras</trash>


				</figure>

				<p>In this subsection we will modify the canonical Poisson algebras constructed in Subsection 6.1 in order to address the problems concerning the unexpectedly large automorphism group and the violation of the composition property. As already mentioned, the key point is to represent the algebras given by the functor CPA p as functionals on the affine space of solutions to the inhomogeneous Klein–Gordon equation. When this is done, a degeneracy becomes apparent which was not visible in the description available in the category of presymplectic vector spaces. However, we will show that the degeneracy may be described and also removed in the category of Poisson algebras, thereby resolving the problems discussed above (cf. Subsections 6.4 and 6.5, and Appendix B for another approach).</p>

				<figure>
					<head>The abstract Poisson algebras CPA p are represented as functionals on the solution spaces Sol p :</head>

					<figDesc>LocSrc p → Aff by extending the pairing (2.9) of PS p and Sol p as follows: For any object (M , J ) in LocSrc p we extend · , · (M ,J) to a map CPA p (M , J ) × Sol p (M , J) → R (denoted with a slight abuse of notation by the same symbol) in such a way that it is a unital algebra homomorphism in the left entry. Explicitly, we set, for all φ ∈ Sol p (M , J ) and α ∈ R,</figDesc>
					<trash>α, φ (M ,J ) = α , (6.6a) and, for all φ ∈ Sol p (M , J ) and [(ϕ 1 , α 1 )], . . . , [(ϕ k , α k )] ∈ PS p (M , J ), [(ϕ 1 , α 1 )] · · · [(ϕ k , α k )], φ (M ,J) = [(ϕ 1 , α 1 )], φ (M ,J) · · · [(ϕ k , α k )], φ (M ,J) . (6.6b) Note that the pairing induces a pairing · , · lin M : PS lin p (M ) × Sol lin p (M ) → R between the linearized (pre)symplectic vector space and solution space, which describe a multiplet of p ∈ N homogeneous Klein–Gordon fields. Explicitly, we have PS lin p (M ) := C ∞ 0 (M, R p )/KG M [C ∞ 0 (M, R p )], σ lin M , where, for all [ϕ]</trash>


				</figure>

				<p>lin , [ψ]</p>

				<figure>
					<trash>lin ∈ C ∞ 0 (M, R p )/KG M [C ∞ 0 (M, R p )]</trash>


				</figure>

				<p>, the symplectic structure is given by σ lin M ([ϕ] lin , [ψ]</p>

				<figure>
					<figDesc>lin ) := M ϕ, E M (ψ) vol M . The linearized pairing reads as, for all [ϕ]</figDesc>
					<trash>lin ∈ PS lin p (M ) and φ ∈ Sol lin p (M ), [ϕ] lin , φ lin M = M ϕ, φ vol M (6.7) and is related to · , · (M ,J) via, for all [(ϕ, α)] ∈ PS p (M , J ), φ ∈ Sol p (M , J ) and φ ∈ Sol lin p (M ), [(ϕ, α)], φ + φ (M ,J) = [(ϕ, α)], φ (M ,J) + [ϕ] lin , φ lin M . (6.8) Notice that for the linearized setting the analog of the diagram in (2.10) holds true. Moreover, we can extend · , · lin M to a map CPA lin p (M ) × Sol lin p (M ) → R, where CPA lin p := CanPois • PS lin p .</trash>


				</figure>

				<p>These extended pairings are also natural, i.e. the analog of the diagram in (2.10) holds true.</p>

				<figure>
					<head>Remark 6.7.</head>

					<figDesc>The pairing · , · (M ,J) provides us with a representation of the canonical (abstract) Poisson algebra CPA p (M , J ) as a polynomial algebra of functionals on the affine space Sol p (M ,</figDesc>
					<trash>J ). Analogously, the pairing · , · lin M leads to a representation of CPA lin p (M ) as a polynomial algebra of functionals on the vector space Sol lin p (M ). The Poisson bracket (6.1) can be expressed in this representation as follows, for all a, b ∈ CPA p (M , J ) and φ ∈ Sol p (M , J ), a, b σ (M ,J) , φ (M ,J) = M a (1) , φ (M ,J) , E M b (1) , φ (M ,J) vol M , (6.9) where a (1) and b (1) are the first functional derivatives of a and b, respectively, defined uniquely so that M a (1) , φ (M ,J) , φ vol M := d dǫ a, φ + ǫ φ (M ,J) | ǫ=0 , (6.10) for all a ∈ CPA p (M , J ), φ ∈ Sol p (M , J ) and φ ∈ Sol lin p (M ).</trash>


				</figure>

				<p>We notice that the pairing · , · (M ,J) is non-degenerate when acting on PS p (M , J ). This means that [(ϕ, α)], φ (M ,J) = 0, for all φ ∈ Sol p (M , J ), implies that [(ϕ, α)] = 0, and, vice versa, that [(ϕ, α)], φ (M ,J) = [(ϕ, α)], φ ′ (M ,J) , for all [(ϕ, α)] ∈ PS p (M , J ), implies that φ = φ ′ . However, the extended pairing on CPA p (M , J ) × Sol p (M , J ) turns out to be degenerate in the left entry and non-degenerate in the right entry. For example, taking [(0,</p>

				<figure>
					<trash>α)] ∈ PS p (M , J ) with α ∈ R we obtain [(0, α)] − α, φ (M ,J) = M 0, φ vol M + α − α = 0 , (6.11) for</trash>


				</figure>

				<p>all φ ∈ Sol p (M , J ). Hence, the extension of · , · from PS p to CPA p has introduced a new degeneracy, which can not be seen at the level of presymplectic vector spaces as it mixes different N 0 -degrees in CPA p . This degeneracy is removed precisely by taking the quotient via a suitable Poisson ideal, namely the vanishing ideal</p>

				<figure>
					<trash>I p (M , J ) := a ∈ CPA p (M , J ) : a, φ (M ,J) = 0 , for all φ ∈ Sol p (M , J ) (6.12) of the pairing · , · (we</trash>


				</figure>

				<p>will check that it is indeed a Poisson ideal below). The corresponding theory will turn out to have the correct automorphism group and composition property. At this point we would like to note that the pairing ·</p>

				<figure>
					<trash>, · lin M is non-degenerate when acting on both PS lin p (M ) and CPA lin p (M ). Lemma 6.8. For any object (M , J ) in LocSrc p the vanishing ideal I p (M , J ) is a proper Poisson ideal of CPA p (M , J ). Hence the quotient CPA p (M , J )/I p (M , J ) is a nontrivial unital Poisson algebra. Proof. Given any element a ∈ I p (M , J ) it is easy to see that all its functional derivatives vanish, in particular a (1) , φ (M ,J) = 0 for all φ ∈ Sol p (M , J ). Thus {a, b} σ (M ,J) ∈ I p (M , J ) for any b ∈ CPA p (M , J ) by (6.9). Since I p (M , J ) is certainly an ideal, it is a Poisson ideal, and (6.6a) shows that it is proper.</trash>

					<figDesc>The quotient CPA p (M , J )/I p (M , J ) gives our improved Poisson algebra for the multiplet of p ∈ N inhomogeneous Klein–Gordon fields. It is of course free of the redundancy discussed above. However, it is sometimes cumbersome to do explicit calculations involving I p (M , J ). In order to simplify the following constructions, we shall provide an equivalent characterization of I p (M , J ) in terms of an algebraically generated ideal. Let us define the following ideal (generated by a set) of</figDesc>
					<trash>CPA p (M , J ) I p (M , J ) := [(0, α)] − α ∈ CPA p (M , J ) : α ∈ R . (6.13) Since [(0, α)]−α, a σ (M ,J) = 0, for all α ∈ R and a ∈ CPA p (M , J ), the ideal I p (M , J ) is a Poisson ideal of CPA p (M , J ). Furthermore, (6.11) and (6.6b) implies that I p (M , J ) ⊆ I p (M , J ) . (6.14)</trash>


				</figure>

				<p>We now prove that I p (M , J ) = I p (M , J ), which will allow us to work with the easy-to-use algebraically generated ideal I p (M , J ) whenever it is suitable.</p>

				<figure>
					<trash>Lemma 6.9. Let (M , J ) be any object in LocSrc p . a) The Poisson algebra CPA p (M , J )/ I p (M , J ) is (noncanonically) isomorphic to CPA lin p (M ). b) I p (M , J ) = I p (M , J ). Proof. Proof of a): Let us define a Poisson algebra homomorphism κ : CPA p (M , J ) → CPA lin p (M ) by setting, for all [(ϕ, α)] ∈ CPA p (M , J ), κ [(ϕ, α)]</trash>


				</figure>

				<p>= [(ϕ, α)], φ 0 (M ,J) + [ϕ]</p>

				<figure>
					<figDesc>lin , (6.15) where φ 0 ∈ Sol p (M , J ) is any fixed solution. As I p (M , J ) clearly lies in the kernel of κ, we can induce a Poisson algebra homomorphism (denoted by the same symbol) κ : CPA p (M , J )/ I p (M , J ) → CPA lin p (M ).</figDesc>

				</figure>

				<p>To show that the induced κ is a PoisAlg-isomorphism, we notice that setting, for all [ϕ]</p>

				<figure>
					<trash>lin ∈ CPA lin p (M ), κ −1 [ϕ]</trash>


				</figure>

				<p>lin := [(ϕ, 0)] − [(ϕ, 0)], φ 0 (M ,J ) ∈ CPA p (M , J )/ I p (M , J ) (6.16) is well-defined and defines the inverse of κ.</p>

				<figure>
					<head>Proof of b):</head>

					<figDesc>By a), CPA p (M , J )/ I p (M , J ) is a simple (and nontrivial) Poisson algebra. Hence I p (M , J ) is a maximal proper ideal. In view of (6.14), this shows that I p (M , J ) = I p (M , J ).</figDesc>

				</figure>

				<p>These results now allow us to construct our improved functor for the classical theory of a multiplet of p ∈ N inhomogeneous Klein–Gordon fields.</p>

				<figure>
					<head>Proposition 6.10.</head>

					<figDesc>The following defines a covariant functor PA p : LocSrc p → PoisAlg: To any object (M , J ) in LocSrc p we associate the Poisson algebra PA p (M , J ) := CPA p (M , J )/I p (M , J ). To any morphism f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p we associate the map PA p (f ) : PA p (M 1 , J 1 ) → PA p (M 2 , J 2 ) that is canonically induced from CPA p (f ) : CPA p (M 1 , J 1 ) → CPA p (M 2 , J 2 ).</figDesc>

				</figure>

				<figure>
					<head>Proof.</head>

					<figDesc>Lemma 6.8 has established that the quotients are nontrivial unital Poisson algebras. Next, let f : (M 1 , J 1 ) → (M 2 , J 2 ) be any morphism in LocSrc p . Then CPA p (f ) induces a Poisson algebra homomorphism PA p (f ) : PA p (M 1 , J 1 ) → PA p (M 2 , J 2 ) because it restricts to a map CPA p (f ) : I p (M 1 , J 1 ) → I p (M 2 , J 2</figDesc>

				</figure>

				<p>), as is obvious from Lemma 6.9 b), the explicit characterization of the algebraic Poisson ideal (6.13) and the fact that CPA p (f )([(0, α)] − α) = [(0, α)] − α, for any α ∈ R. It is clear that PA p (f ) is unit-preserving, because CPA p (f ) is; moreover, it is injective, since PA p (M 1 , J 1 ) is simple by Lemma 6.9 a), and hence it does not have any nontrivial proper Poisson ideals (and PA p (f ) is a unit-preserving map to a nontrivial unital Poisson algebra, so it is not the zero map). The composition and identity properties of PA p are inherited from CPA p , hence PA p : LocSrc p → PoisAlg is a covariant functor.</p>

				<figure>
					<head>Proposition 6.11.</head>


				</figure>

				<p>The covariant functor PA p : LocSrc p → PoisAlg satisfies the causality property and the time-slice axiom, Hence, it is a locally covariant classical field theory.</p>

				<p>Proof. By Proposition 6.3 the covariant functor CPA p satisfies these properties. The quotients by Poisson ideals used in the definition of the functor PA p preserve these properties due to the following arguments: For the time-slice axiom we just have to notice that any PoisAlg-isomorphism which preserves the Poisson ideals induces a PoisAlg-isomorphism on the quotients (simply induce the morphism and its inverse to the quotients). Causality holds because if two subalgebras of a Poisson algebra A Poisson-commute, then the same is true of the corresponding subalgebras of any quotient of A by a Poisson ideal.</p>

				<figure>
					<head>Remark 6.12.</head>

					<figDesc>The theory PA p admits a locally covariant field, in the following sense. For each (M , J ), let Φ (M ,J) : C ∞ 0 (M, R p ) → PA p (M , J ) be the linear map Φ (M ,J) (ϕ) = [(ϕ, 0)]</figDesc>

				</figure>

				<p>, (6.17) where the outer brackets denote the equivalence relation used in defining PA p and the inner square brackets that used in defining PS p . The significance of this field is seen via its action on solutions,</p>

				<figure>
					<trash>Φ (M ,J) (ϕ), φ (M ,J) = M ϕ, φ vol M , (6.18)</trash>

					<figDesc>where we abuse notation slightly, by extending the notation for the pairing of CPA p with Sol p to encompass the pairing of PA p with Sol p obtained by quotienting. Furthermore, if f : (M 1 , J 1 ) → (M 2 , J 2 ) is a morphism in LocSrc p then the fields are related by</figDesc>
					<trash>QA p (f ) Φ (M 1 ,J 1 ) (ϕ) = Φ (M 2 ,J 2 ) f * (ϕ) , (6.19) for all ϕ ∈ C ∞ 0 (M 1</trash>


				</figure>

				<figure>
					<figDesc>, R p ). Formalizing the test function spaces via a functor D p : LocSrc p → Vec defined by D p (M , J ) = C ∞ 0 (M, R p ), D p (f ) = f * , we see that the maps Φ (M ,J) provide the components of a natural transformation Φ : D p ⇒ PA p (we suppress a forgetful functor from PoisAlg to Vec). Thus Φ conforms to the understanding of fields as natural transformations, set out in [BFV03]</figDesc>

				</figure>

				<p>for the case of quantum fields. Moreover, Φ (M ,J) obeys the field equation in the form</p>

				<figure>
					<trash>Φ (M ,J) KG M (ϕ) + M ϕ, J vol M = KG M (ϕ), 0 + 0, M ϕ, J vol M = KG M (ϕ), M ϕ, J vol M = 0 , (6.20) for all ϕ ∈ C ∞ 0</trash>

					<figDesc>(M, R p ), where we have used (6.13) in the first equality and (2.5) in the last one.</figDesc>
					<head>Remark 6.13.</head>


				</figure>

				<figure>
					<figDesc>The isomorphism of Lemma 6.9 a) merits further consideration. For λ ∈ R, define a covariant functor Z λ : LocSrc p → LocSrc p so that Z λ (M , J ) = (M , λJ ) and so that, if f : (M 1 , J 1 ) → (M 2 , J 2 ), then Z λ (f ) : (M 1 , λJ 1 ) → (M 2 , λJ 2 ) has the same underlying map as f . (Notice that Z λ is the identity functor for λ = 1.) Then the covariant functor PA p • Z λ : LocSrc p → PoisAlg describes the theory of p inhomogeneous Klein–Gordon fields with a coupling constant λ to the external source. The corresponding equation of motion on an object (M , J ) in LocSrc p is KG M (φ) + λ J = 0, which reduces to the homogeneous Klein–Gordon equation for λ = 0. Lemma 6.9 a) asserts that, fixing any object (M , J ) in LocSrc p , all Poisson algebras PA p • Z λ (M , J ) = PA p (M , λ J ) (λ ∈ R) are isomorphic to CPA lin p (M ), albeit in a noncanonical fashion. The physical interpretation of this result is that the theories PA p • Z λ (λ ∈ R) have the same observables, which moreover satisfy identical algebraic relations, for any fixed object (M , J ) in LocSrc p . In particular, this means that there exists a (by no means canonical) linear map Ψ</figDesc>
					<trash>µ,λ (M ,J) : C ∞ 0 (M ; R) → PA p • Z λ (M , J ) for each λ, µ ∈ R such that Ψ µ,λ (M ,J) KG M (ϕ) + µ M ϕ, J vol M = 0 , (6.21) for all ϕ ∈ C ∞ 0</trash>


				</figure>

				<p>(M, R p ). In other words, restricting attention to a single object (M , J ), the theory for coupling constant λ admits a field obeying the field equation for coupling constant µ! These observations do not assert that the theories with different coupling constants are equivalent . Rather, they show that the distinction between the theories PA p • Z λ and PA p • Z µ for λ = µ is only visible when one considers how the Poisson algebras for two objects (M 1 , J 1 ) and (M 2 , J 2 ) are embedded if there is a morphism f : (M 1 , J 1 ) → (M 2 , J 2 ). For instance, the field assignments Ψ µ,λ (M ,J) just mentioned cannot be chosen so as to constitute a locally covariant field Ψ µ,λ : D p ⇒ PA p • Z λ ; if they could, the difference Ψ µ,λ − Φ λ (with Φ λ being the locally covariant field for the theory PA p • Z λ , cf. Remark 6.12) would be a multiple of the unit yielding a naturally assigned solution to the inhomogeneous field equation for coupling µ − λ, which is impossible unless λ = µ. This is direct evidence for the necessity of our locally covariant perspective on inhomogeneous field theories. At the root of this discussion is the fact, evident from the proof of Lemma 6.9 a), that the identification between PA p (M , J ) and CPA lin p (M ) requires a (necessarily noncanonical) splitting of an inhomogeneous solution φ = φ 0 + φ into a fixed &quot; background solution &quot; φ 0 and a homogeneous solution φ. A similar result holds true after quantization, see Lemma 7.6 below, where the choice of a &quot; background solution &quot; φ 0 is replaced by the choice of a &quot; background quantum state &quot; ω 0 that satisfies appropriate inhomogeneous properties. In textbook treatments of inhomogeneous classical and quantum field theories, see e.g. [IZ80, Chapter 4], such a splitting is typically assumed from the beginning in order to reduce the construction of inhomogeneous theories to homogeneous ones. As we have explained above, the splitting approach is highly noncanonical and can easily obscure the (physical) interpretation of the theory, which, however, is faithfully reflected in the functorial structure. It is also worth mentioning that, in Appendix C, we discuss the Fedosov quantization method, which addresses the noncanonical nature of such splittings by treating all of them on an equal footing.</p>

			</div>
			<div>
				<head>6.3</head>

				<p>Relative Cauchy evolution of the functor PA p</p>

				<figure>
					<head>The relative Cauchy evolution of the functor PS p :</head>

					<figDesc>LocSrc p → PreSymp induces that of the functor PA p : LocSrc p → PoisAlg as follows: Let (M , J ) be any object in LocSrc p and let (h, j) ∈ H(M , J ) be any globally hyperbolic perturbation. From the explicit expression for rce</figDesc>
					<trash>(PS p ) (M ,J) [h, j]</trash>


				</figure>

				<p>∈</p>

				<figure>
					<figDesc>Aut(PS p (M , J )) given in (3.9) we observe that the relative Cauchy evolution rce</figDesc>
					<trash>(PA p ) (M ,J) [h, j]</trash>


				</figure>

				<p>∈ Aut(PA p (M , J )) of PA p is uniquely specified by, for all [(ϕ, α)] ∈ PA p (</p>

				<figure>
					<trash>M , J ), rce (PA p ) (M ,J) [h, j] [(ϕ, α)]</trash>


				</figure>

				<p>= ϕ + (KG M − KG M [h] ) E M [h]</p>

				<figure>
					<trash>(ϕ) , 0 + α + M −j, E M [h]</trash>

					<figDesc>(ϕ) + (1 − ρ h ) (J + j), E M [h] (ϕ) vol M , (6.22) where on the right hand side we have used the equivalence relation entering the definition of PA p (M , J ) (cf. Proposition 6.10) and we have chosen as in (3.9) a representative ϕ with compact support in M + . With the techniques presented in Appendix A one can differentiate this expression to yield</figDesc>
					<trash>d ds rce (PA p ) (M ,J) [sh, sj] [(ϕ, α)]</trash>


				</figure>

				<p>s=0 = − KG ′ M [h]</p>

				<figure>
					<trash>E M (ϕ) , 0 − M 1 2 g ab h ab J + j, E M (ϕ) vol M = − 1 2 T (M ,J) (h) + [(j, 0</trash>


				</figure>

				<p>)], [(ϕ, α)] σ (M ,J)</p>

				<figure>
					<trash>, (6.23) where T (M ,J)</trash>

					<figDesc>(h) is the functional on Sol p (M , J ) given by φ → M h ab T ab (M ,J) [φ]</figDesc>

				</figure>

				<p>vol M and T ab (M ,J) [φ] is the stress-energy tensor (3.13). Although (6.22) was derived under an assumption on the support of the representative ϕ, the formulae in (6.23) do not require to choose a suitable representative as they depend only on the equivalence class of (ϕ, α).</p>

			</div>
			<div>
				<head>6.4</head>

				<p>Automorphism group of the functor PA p</p>

				<p>We study the automorphism group of the covariant functor PA p : LocSrc p → PoisAlg defined in Proposition 6.10. We shall obtain that it is, as expected, the trivial group for m = 0 and isomorphic to R p for m = 0.</p>

				<p>We first show that for m = 0 the automorphism group of PA p contains R p as a subgroup.</p>

				<figure>
					<head>Proposition 6.14.</head>

					<figDesc>If m = 0 there exists a faithful homomorphism η : R p → Aut(PA p ) induced by the one in Proposition 4.2 restricted to {+1} × R p ⊆ Z 2 × R p . Explicitly, for any object (M , J ) in LocSrc p the automorphism η(µ) (M ,J) is specified by, for all [(ϕ, α)]</figDesc>

				</figure>

				<p>∈ PA p (M , J ), η(µ) (M ,J) [(ϕ, α)] = ϕ, α + M ϕ, µ vol M . (6.24)</p>

			</div>
			<div>
				<head>Proof.</head>

				<p>Applying the functor CanPois, the automorphism η(σ, µ) ∈ Aut(PS p ) of Proposition 4.2 induces an element in Aut(CPA p ), which we denote with a slight abuse of notation by the same symbol η(σ, µ). For σ = −1 this automorphism does not preserve the Poisson ideals I p (M , J ): Indeed, for [(0, α)] − α ∈ I p (M , J ) we find η(−1, µ) (M ,J) ([(0, α)] − α) = [(0, −α)] − α ∈ I p (M , J ). For σ = +1 and µ ∈ R p arbitrary the Poisson ideals are preserved, hence η(+1, µ) induces the automorphism η(µ) ∈ Aut(PA p ) given by (6.24). The group law η(µ) • η(µ ′ ) = η(µ + µ ′ ) is a consequence of the group law for η(σ, µ), cf. Proposition 4.2.</p>

				<figure>
					<head>Remark 6.15.</head>

					<figDesc>The above argument shows that the nontrivial Z 2 -automorphism in the massless case (cf. Proposition 4.2) does not induce an automorphism of PA p . The same holds true for the nontrivial Z 2 -automorphism in the massive case (cf. Proposition 4.1).</figDesc>

				</figure>

				<p>We now prove that the automorphisms found in Proposition 6.14 exhaust the automorphism group of the covariant functor PA p . For the proof we require the analog of Theorem 4.5, stating that an endomorphism is uniquely determined by its component on one object, for the functor PA p : LocSrc p → PoisAlg. This follows by a similar proof as for Theorem 4.5 and we omit the details.</p>

				<figure>
					<head>Theorem 6.16.</head>

					<figDesc>Every endomorphism of the functor PA p is an automorphism and</figDesc>
					<trash>End(PA p ) = Aut(PA p ) ≃ {id PA p } , for m = 0 , R p , for m = 0 , (6.25)</trash>


				</figure>

				<p>where the action for m = 0 is given by Proposition 6.14.</p>

				<p>Proof. Let η ∈ End(PA p ) and let us consider its component η (M 0 ,0) ∈ End(PA p (M 0 , 0)) on the Minkowski spacetime M 0 with J 0 = 0. Now, η (M 0 ,0) must commute with the relative Cauchy evolution (6.22) and its derivative (6.23); considering the h = 0 case of (6.23), we obtain the requirement η (M 0 ,0) [(j, 0)], [(ϕ, 0)] σ (M 0 ,0) = [(j, 0)], η (M 0 ,0) [(ϕ, 0)] σ (M 0 ,0)</p>

			</div>
			<div>
				<head>(6.26)</head>

				<p>for all j, ϕ ∈ C ∞ 0 (M 0 , R p ). Next, we exploit the fact (cf. Lemma 6.9) that there is a preferred isomorphism κ : PA p (M 0 , 0) → CPA lin p (M 0 ) given by κ [(ϕ, α)] = α + [ϕ] lin , i.e. the φ 0 = 0 case of (6.15), which intertwines the natural actions of the Poincaré transformations on PA p (M 0 , 0) and CPA lin p (M 0 ). Then the induced endomorphism η = κ • η (M 0 ,0) • κ −1 of CPA lin p (M 0 ) must commute with all Poincaré transformations, because η (M 0 ,0) does. Owing to (6.26), η also satisfies, for all generators [ϕ]</p>

				<figure>
					<trash>lin ∈ CPA lin p (M 0 ) and all j ∈ C ∞ 0 (M 0 , R p ), η [j]</trash>


				</figure>

				<p>lin , [ϕ]</p>

				<figure>
					<trash>lin σ lin M 0 = [j]</trash>


				</figure>

				<p>lin , η [ϕ]</p>

				<figure>
					<trash>lin σ lin M 0 . (6.27)</trash>


				</figure>

				<p>The left hand side of this equation is simply σ lin M 0 ([j] lin , [ϕ] lin ) and the right hand side can be simplified as follows: We write η([ϕ] lin ) = η 0 ([ϕ] lin ) + η 1 ([ϕ] lin ) + η ≥2 ([ϕ] lin ), where the index labels the N 0 -degree of η([ϕ] lin ) in CPA lin p (M 0 ). This yields the condition, for all [ϕ]</p>

				<figure>
					<trash>lin ∈ PS lin p (M 0 ) and all j ∈ C ∞ 0 (M 0 , R p ), σ lin M 0 ([j]</trash>


				</figure>

				<p>lin , [ϕ] lin ) = σ lin M 0 [j] lin , η 1 [ϕ] lin + [j] lin , η ≥2 [ϕ]</p>

				<figure>
					<trash>lin σ lin M 0 . (6.28)</trash>


				</figure>

				<p>Counting the N 0 -degree of the individual terms and using the fact that the Poisson bracket in CPA lin p (M 0 ) is non-degenerate we obtain that η ≥2 = 0 and η 1 = id CPA lin p (M 0 ) . Hence, η([ϕ] lin ) = η 0 ([ϕ] lin ) + [ϕ] lin , for all [ϕ] lin ∈ PS lin p (M 0 ), and the remaining freedom in η is a linear map η 0 : PS lin p (M 0 ) → R, which also has to be Poincaré invariant. By Lemma 4.7, η 0 ≡ 0 in the case of m = 0 and η 0 ([ϕ]</p>

				<figure>
					<figDesc>lin ) = M 0</figDesc>

				</figure>

				<p>ϕ, µ vol M 0 for some µ ∈ R p in the massless case. Hence, there are no nontrivial endomorphisms of PA p (M 0 , 0) in the massive case. For m = 0 the endomorphisms of PA p (M 0 , 0) coincide with the Minkowski space components of the functor automorphisms found in Proposition 6.14. Since any endomorphism η ∈ End(PA p ) is uniquely determined by its component on one object, this proves our claim.</p>

			</div>
			<div>
				<head>6.5</head>

				<p>Composition property of the functor PA p</p>

				<p>It remains to prove the validity of the composition property of the covariant functor PA p : LocSrc p → PoisAlg. Explicitly, we define for p ≥ 2 and 0 &lt; q &lt; p the covariant functor PA p,q := ⊗ • PA q × PA p−q • Split p,q : LocSrc p → PoisAlg (6.29) and we will prove that PA p,q and PA p are naturally isomorphic.</p>

				<figure>
					<head>Theorem 6.17.</head>


				</figure>

				<p>For any 2 ≤ p ∈ N and 0 &lt; q &lt; p, the covariant functors PA p,q : LocSrc p → PoisAlg and PA p : LocSrc p → PoisAlg are naturally isomorphic. The natural isomorphism η : PA p,q ⇒ PA p is specified by, for all [(ϕ, α)] ∈ PA q (M , J q ) and [(ψ, β)] ∈ PA p−q (</p>

				<figure>
					<trash>M , J p−q ), η (M ,J) [(ϕ, α)] ⊗ 1 = (ϕ, α) , η (M ,J) 1 ⊗ [(ψ, β)] = (ψ, β) , (6.30)</trash>


				</figure>

				<p>where on the right hand sides we have identified ϕ ∈ C ∞ 0 (M, R q ) and ψ ∈ C ∞ 0 (M, R p−q ) as elements in C ∞ 0 (M, R p ) (ϕ is placed in the first q and ψ in the last p − q components of R p ) .</p>

				<figure>
					<head>Proof.</head>

					<figDesc>We first notice that (6.30) actually defines a Poisson algebra homomorphism CPA q (M , J q )⊗ CPA p−q (M , J p−q ) → CPA p (M , J ). It induces a unital Poisson algebra homomorphism between the quotients, PA q (M , J q ) ⊗ PA p−q (M , J p−q ) → PA p (M , J ), since, for all α ∈ R,</figDesc>
					<trash>η (M ,J) [(0, α)] − α ⊗ 1 = η (M ,J) 1 ⊗ [(0, α)] − α = [(0, α)] − α . (6.31)</trash>


				</figure>

				<p>Naturality of the η (M ,J) is also a straightforward check. We next show that η (M ,J ) is invertible, hence a PoisAlg-isomorphism. Notice that setting, for any [(ϕ, α)] ∈ PA p (</p>

				<figure>
					<trash>M , J ), η −1 (M ,J) [(ϕ, α)] = [(ϕ q , α)] ⊗ 1 + 1 ⊗ [(ϕ p−q , 0)] ∈ PA q (M , J q ) ⊗ PA p−q (M , J p−q ) , (6.32)</trash>


				</figure>

				<p>where ϕ = ϕ q + ϕ p−q is the split of ϕ into the first q and last p − q components, is well-defined and extends to a unital Poisson algebra homomorphism η</p>

			</div>
			<div>
				<head>−1</head>

				<figure>
					<figDesc>(M ,J) : PA p (M , J ) → PA q (M , J q ) ⊗ PA p−q (M , J p−q ). One checks directly that η −1 (M ,J) is the inverse of η (M ,J) .</figDesc>

				</figure>

			</div>
			<div>
				<head n="7">Quantization</head>

				<p>We shall now turn to the quantization of our model. As a first step, we are going to use the CCR-functor (in polynomial form) in order to construct a covariant functor CQA p := CCR • PS p : LocSrc p → * Alg, where * Alg is the category of unital * -algebras over C with injective unital * algebra homomorphisms as morphisms. As CQA p is a deformation quantization of the Poisson algebra functor CPA p , it is not surprising to find that its automorphism group is too large and that it violates the composition property. We then improve this functor following a strategy similar to that of Subsection 6.2 for the Poisson algebras. The essential step is to specify a suitable state space for CQA p . The kernel corresponding to this state space forms a two-sided * -ideal in the algebras described by CQA p , which when quotiented out leads to a covariant functor QA p : LocSrc p → * Alg that has the correct automorphism group and satisfies the composition property. Accordingly, we find that QA p is the correct description of the quantum field theory of a multiplet of p ∈ N inhomogeneous Klein–Gordon fields and not the functor CQA p , which was used in [BDS14a]. As we shall explain in Remark 7.11, our improved functor is naturally isomorphic to a functor obtained by the construction of Hollands and Wald [HW05], which is inspired by the Borchers–Uhlmann algebra [Bor62, Uhl62]. Further equivalent constructions of the improved theory QA p are via the quantization of pointed presymplectic spaces (see Appendix B), via deformation quantization of the improved classical theory (see Appendix C) and via the &apos;Fedosov inspired&apos; approach of [SDH14] (see Appendix C for some comments).</p>

			</div>
			<div>
				<head n="7.1">Canonical algebras</head>

				<p>We briefly review the CCR-functor CCR : PreSymp → * Alg in polynomial form, following the slightly non-standard approach taken in [BSZ92] and [FV12b, §5], which is equivalent to the standard presentation in terms of generators and relations.</p>

				<figure>
					<figDesc>To any object (V, σ V ) in PreSymp we associate the following unital * -algebra CCR(V, σ V ): The vector space underlying CCR(V, σ V ) is the complexification of the vector space underlying the symmetric tensor algebra S(V ) := ∞ k=0 S k (V ). The involution * is defined by C-antilinearity and (v 1 · · · v k ) * = v 1 · · · v k , for all v 1 , . . . , v k ∈ V , where juxtaposition denotes the symmetric product. The product ⋆ in CCR(V, σ V ) is specified (uniquely) by demanding, for all v 1 , v 2 ∈ V and n, m ∈ N</figDesc>

				</figure>

				<p><formula>0 , v m 1 ⋆ v n 2 = min{m,n} r=0 iσ V (v 1 , v 2 ) 2 r m! n! r! (m − r)! (n − r)! v m−r 1 v n−r 2 . (7.1)</formula></p>

				<figure>
					<figDesc>To any morphism L : (V, σ V ) → (W, σ W ) in PreSymp we associate the injective unital * -algebra homomorphism CCR(L) : CCR(V, σ V ) → CCR(W, σ W ), which is specified by CCR(L)(v 1 v 2 · · · v k ) = L(v 1 ) L(v 2 ) · · · L(v k ), for all v 1 , . . . , v k ∈ V , and C-linearity.</figDesc>

				</figure>

				<p>Composing the covariant functor PS p : LocSrc p → PreSymp with CCR yields the covariant functor CQA p := CCR • PS p : LocSrc p → * Alg. It is standard that CCR preserves the timeslice axiom and the causality property. In [BDS14a] CQA p was taken to describe the quantized polynomial algebras of a multiplet of p ∈ N inhomogeneous Klein–Gordon fields.</p>

				<p>It is easy to see that the automorphism group Aut(CQA p ) contains a Z 2 -subgroup for the massive case and a Z 2 × R p -subgroup for m = 0. This is an immediate consequence of Theorem 4.6 and the fact that any automorphism η = {η (M ,J) } of PS p lifts to an automorphism of CQA p with components {CCR(η (M ,J ) )}.</p>

				<p>To show that CQA p violates the composition property, we define, for all 2 ≤ p ∈ N and 0 &lt; q &lt; p, the covariant functor CQA p,q := ⊗ • (CQA q × CQA p−q ) • Split p,q :</p>

				<p><formula>LocSrc p → * Alg , (7.2)</formula></p>

				<figure>
					<figDesc>where ⊗ : * Alg × * Alg → * Alg now denotes the covariant functor that takes the algebraic tensor product of unital * -algebras. Adapting the proof of Lemma 6.5, one observes that the two covariant functors CCR@BULLET⊕ : PreSymp×PreSymp → * Alg and ⊗@BULLET(CCR×CCR) : PreSymp×PreSymp → * Alg are naturally isomorphic. Furthermore, the result of Lemma 6.4 also extends to our present setting: two unital * -algebras CCR(V, σ V ) and CCR(W, σ W ) are isomorphic if and only if (V, σ V ) and (W, σ W ) are isomorphic as presymplectic vector spaces. Then by an argument similar to that of Proposition 6.6 we obtain</figDesc>
					<head>Proposition 7.1.</head>


				</figure>

				<figure>
					<figDesc>For any 2 ≤ p ∈ N and 0 &lt; q &lt; p, the covariant functors CQA p,q : LocSrc p → * Alg and CQA p : LocSrc p → * Alg are not naturally isomorphic. Indeed, there is no object (M , J ) in LocSrc p for which the unital * -algebras CQA p,q (M , J ) and CQA p (M , J ) are isomorphic.</figDesc>

				</figure>

			</div>
			<div>
				<head n="7.2">Improved algebras</head>

				<p>Employing a strategy similar to the one in Subsection 6.2, we now modify the canonical algebras of Subsection 7.1 in order to obtain the correct automorphism group and satisfy the composition property . The essential idea is again to make our theory remember that it came from affine functionals acting on the affine space of solutions of the inhomogeneous Klein–Gordon equation.</p>

				<p>We implement this idea mathematically by introducing suitable state spaces. Recall that a state space for a unital * -algebra A is a subset S of the set of normalized and positive linear functionals on A that is closed under convex linear combinations and operations induced by A.</p>

				<p>The latter property means that, given any state ω ∈ S and b ∈ A such that ω(b * b) &gt; 0, then the state ω b (a) := ω(b * ab)/ω(b * b), for all a ∈ A, is also contained in S. To promote the concept of state spaces to the categorical setting, we define the category State as follows: The objects in State are all possible state spaces for objects in * Alg, with affine maps as morphisms. A state space for our covariant functor CQA p : LocSrc p → * Alg is a contravariant functor S p : LocSrc p → State, such that S p (M , J ) is a state space for CQA p (M , J ) for each object (M , J ) and S p (f ) = CQA p (f ) * | Sp(M 2 ,J 2 ) for every morphism f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p (it is a necessary condition that CQA p (f ) * [S p (M 2 , J 2 )] ⊆ S p (M 1 , J 1 )).</p>

				<figure>
					<head>Definition 7.2.</head>


				</figure>

				<p>An admissible state space S p : LocSrc p → State for the covariant functor CQA p : LocSrc p → * Alg is a state space S p , such that for each object (M , J ) in LocSrc p , and for all ω ∈ S p (M , J ) and [(0, α)], [(0, β)] ∈ CQA p (M , J), ω [(0, α)] = α , ω [(0, α)] ⋆ [(0, β)] = α β . (7.3)</p>

				<figure>
					<head>Remark 7.3.</head>


				</figure>

				<p>The first condition in (7.3) demands that the expectation values of the quantum observables corresponding to [(0, α)] agree with the classical result (2.9). The second condition in (7.3) sets the fluctuations around this classical result to zero, cf. the lemma below. This behavior of states for the quantum theory is motivated by the fact that [(0, α)] corresponds in the classical theory to a constant functional.</p>

				<figure>
					<head>Lemma 7.4.</head>

					<figDesc>Let S p be any admissible state space for CQA p . Then for any object (M , J ) in LocSrc p , and for all ω ∈ S p (M , J )</figDesc>
					<trash>and [(0, α 1 )], . . . , [(0, α n )] ∈ CQA p (M , J ), ω [(0, α 1 )] ⋆ · · · ⋆ [(0, α n )] = α 1 · · · α n . (7.4)</trash>


				</figure>

				<p>Proof. This is a straightforward consequence of the Cauchy-Schwarz inequality and a simple proof by induction. Using the short notation α := [(0, α)] we obtain</p>

				<figure>
					<trash>ω α 1 ⋆ · · · ⋆ α n − α 1 · · · α n 2 = ω α 1 ⋆ · · · ⋆ α n − α 1 ω α 2 ⋆ · · · ⋆ α n 2 = ω ( α 1 − α 1 ) ⋆ α 2 ⋆ · · · ⋆ α n 2 ≤ ω ( α 1 − α 1 ) 2 ω ( α 2 ⋆ · · · ⋆ α n ) 2 = 0 , (7.5)</trash>


				</figure>

				<p>where the last equality follows from the admissibility condition (7.3).</p>

				<figure>
					<head>Lemma 7.5.</head>

					<figDesc>There exists a non-empty admissible state space S p for CQA p , i.e. S p (M , J) is non-empty for all objects (M , J ) in LocSrc p .</figDesc>

				</figure>

				<p>Proof. Let S max p (M , J ) be the set of all states on CQA p (M , J ) satisfying (7.3). This set is nonempty , since it was shown in [BDS14a, §8] that any state of the homogeneous Klein–Gordon theory induces a state in S max p (M , J ). The admissibility condition of states in S max p (M , J ) is met by construction and it is preserved under convex linear combinations and operations induced by CQA p (M , J ) (to prove the latter statement, use the Cauchy-Schwarz inequality and the fact that [(0, α)] − α lies in the center of CQA p (M , J )). Thus, it remains to show that</p>

				<figure>
					<trash>S max p (f ) : S max p (M 2 , J 2 ) → S max p (M 1 , J 1 ) , ω → S max p (f )(ω) = ω • CQA p (f ) (7.6) is a morphism in State, i.e. that S max p (f )(ω) ∈ S max p (M 1 , J 1 ), for all ω ∈ S max p (M 2 , J 2 ). This holds because S max p (f )(ω</trash>


				</figure>

				<p>) is clearly a state, and obeys (7.3) because CQA p (f ) [(0, α)] = [(0, α)].</p>

				<p>Given any non-empty admissible state space S p for CQA p , we define for every object (M ,</p>

				<figure>
					<trash>J ) in LocSrc p J Sp (M , J ) := ω∈Sp(M ,J) ker(π ω ) ⊆ CQA p (M , J ) , (7.7)</trash>


				</figure>

				<p>where π ω denotes the GNS-representation of CQA p (M , J ) induced by ω ∈ S p (M , J ). The subset (7.7) of CQA p (M , J ) is clearly a two-sided * -ideal, and it must be proper because kernels of unital algebra homomorphisms necessarily exclude the unit. Hence CQA p (M , J )/J Sp (M , J ) is a nontrivial unital * -algebra.</p>

				<p>It will again be convenient to express J Sp (M , J ) in terms of an algebraically generated ideal. Let us consider the following two-sided * -ideal (generated by a set) of CQA p (</p>

				<figure>
					<trash>M , J ) J p (M , J ) := [(0, α)] − α ∈ CQA p (M , J ) : α ∈ R . (7.8) It is easy to see that J p (M , J ) ⊆ J Sp (M , J ): Let ω ∈ S p (M , J ) be arbitrary. Then, for all b, c ∈ CQA p (M , J ) and all α ∈ R, ω b ⋆ [(0, α)] − α ⋆ c 2 = ω b ⋆ c ⋆ [(0, α)] − α 2 ≤ ω b ⋆ c ⋆ (b ⋆ c) * ω [(0, α)] − α 2 = 0 , (7.9)</trash>


				</figure>

				<p>where in the first step we have used that [(0, α)] − α lies in the center of CQA p (M , J ), in the second step the Cauchy-Schwarz inequality and in the last one the admissibility condition (7.3). Hence, J p (M , J ) ⊆ ker(π ω ) and since ω was arbitrary we have J p (M , J ) ⊆ J Sp (M , J ), for any non-empty admissible state space S p .</p>

				<figure>
					<trash>Lemma 7.6. Let (M , J ) be any object in LocSrc p . a) The unital * -algebra CQA p (M , J )/ J p (M , J ) is (noncanonically) isomorphic to CQA lin p (M ) := CCR PS lin p (M ) . b) J p (M , J ) = J Sp (M , J ) whenever</trash>


				</figure>

				<p>S p is a non-empty admissible state space.</p>

				<p>Proof. Proof of a): We define a unital * -algebra homomorphism κ : CQA p (M , J ) → CQA lin p (M ) by setting, for all [(ϕ, α)] ∈ CQA p (M , J ), κ [(ϕ, α)] = ω 0 [(ϕ, α)] + [ϕ] lin , (7.10) where ω 0 is any choice of admissible state. As J p (M , J ) clearly lies in the kernel of κ, we can induce a unital * -algebra homomorphism κ : CQA p (M , J )/ J p (M , J ) → CQA lin p (M ). To show that the induced κ is a * Alg-isomorphism we notice that setting, for all [ϕ]</p>

				<figure>
					<trash>lin ∈ CQA lin p (M ), κ −1 [ϕ]</trash>


				</figure>

				<p>lin := [(ϕ, 0)] − ω 0 [ϕ, 0] ∈ CQA p (M , J )/ J p (M , J ) (7.11) is well-defined and defines the inverse of κ.</p>

				<p>Proof of b): By a), CQA p (M , J )/ J p (M , J) is a simple nontrivial unital * -algebra. Hence I p (M , J ) is a maximal proper ideal. But J p (M , J ) ⊆ J Sp (M , J ) and J Sp (M , J ) is proper so the ideals are equal.</p>

				<p>Remark 7.7. As a consequence of this lemma, the two-sided * -ideals J Sp (M , J ) do not depend on which (non-empty) admissible state space S p for CQA p we use in the construction. We therefore introduce a simpler notation and set for any object (M ,</p>

				<figure>
					<trash>J ) in LocSrc p J p (M , J ) := J Sp (M , J ) = J p (M , J) . (7.12)</trash>


				</figure>

				<p>These studies now allow us to construct our improved functor for the quantum theory of a multiplet of p ∈ N inhomogeneous Klein–Gordon fields.</p>

				<figure>
					<head>Proposition 7.8.</head>

					<figDesc>The following rules define a covariant functor QA p : LocSrc p → * Alg: To any object (M , J ) in LocSrc p we associate QA p (M , J ) := CQA p (M , J )/J p (M , J ). To any morphism f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p we associate the map QA p (f ) : QA p (M 1 , J 1 ) → QA p (M 2 , J 2 ) that is canonically induced from CQA p (f ) : CQA p (M 1 , J 1 ) → CQA p (M 2 , J 2 ).</figDesc>

				</figure>

				<p>Proof. Lemma 7.6 has established that the quotients are nontrivial unital * -algebras. Next, let f : (M 1 , J 1 ) → (M 2 , J 2 ) be any morphism in LocSrc p . Then CQA p (f ) induces a unital * homomorphism QA p (f ) : QA p (M 1 , J 1 ) → QA p (M 2 , J 2 ) because it restricts to a map CQA p (f ) : J p (M 1 , J 1 ) → J p (M 2 , J 2 ). This is clear from the fact that CQA p (f ) [(0, α)] − α = [(0, α)] − α, for any α ∈ R. The induced unital * -algebra homomorphism QA p (f ) : QA p (M 1 , J 1 ) → QA p (M 2 , J 2 ) is injective (i.e. a morphism in * Alg), since QA p (M 1 , J 1 ) is simple, cf. Lemma 7.6. The composition and identity properties of the association QA p are consequences of the same properties of CQA p , hence QA p : LocSrc p → * Alg is a covariant functor.</p>

				<p>The following statement may be proved in complete analogy with Proposition 6.11:</p>

				<figure>
					<head>Proposition 7.9.</head>


				</figure>

				<p>The covariant functor QA p : LocSrc p → * Alg satisfies the causality property and the time-slice axiom and is therefore a locally covariant quantum field theory.</p>

				<figure>
					<head>Remark 7.10.</head>

					<figDesc>The quantum field itself may now be introduced, following a similar pattern to the classical fields of Remark 6.12. For each (M ,</figDesc>
					<trash>J ), let Φ (M ,J) : C ∞ 0 (M, C p ) → QA p (M , J ) be the complex linear map Φ (M ,J) (ϕ) = [(Re ϕ, 0)] + i [(Im ϕ, 0)] , (7.13)</trash>


				</figure>

				<p>where the outer brackets denote the equivalence relation used in defining QA p and the inner square brackets that used in defining PS p . Then Φ (M ,J) obeys hermiticity, i.e., Φ (M ,J) (ϕ) = Φ (M ,J) (ϕ) * for all ϕ ∈ C ∞ 0 (M, C p ), obeys the field equation in the form</p>

				<figure>
					<trash>Φ (M ,J) KG M (ϕ) + M ϕ, J vol M = 0 , (7.14) for all ϕ ∈ C ∞ 0 (M, C p ), and obeys the canonical commutation relations Φ (M ,J) (ϕ) ⋆ , Φ (M ,J) (ψ) = i M ϕ, E M (ψ) vol M , (7.15) for all ϕ, ψ ∈ C ∞ 0 (M, C p ), where we suppress explicit identity operators. Furthermore, if f : (M 1 , J 1 ) → (M 2 , J 2 ) is a morphism in LocSrc p then the quantum fields are related by QA p (f ) Φ (M 1 ,J 1 ) (ϕ) = Φ (M 2 ,J 2 ) f * (ϕ) , (7.16) for all ϕ ∈ C ∞ 0 (M 1 , C p ). Defining a functor D p : LocSrc p → Vec C by D p (M , J ) = C ∞ 0 (M, C p ), D p (f ) = f</trash>


				</figure>

				<p>* , we see that the maps Φ (M ,J) provide the components of a natural transformation Φ : D p ⇒ QA p (suppressing a forgetful functor from * Alg to Vec C ) and thus a locally covariant field. All the above properties follow straightforwardly from our discussion and we omit most of the details, save to mention that the field equation (7.14) is proved by a calculation similar to (6.20), but using (7.8) in place of (6.13).</p>

				<figure>
					<head>Remark 7.11.</head>


				</figure>

				<p>The fields just introduced allow us to clarify the relation between our improved quantum algebras and the algebras for the inhomogeneous Klein–Gordon theory used by Hollands and Wald [HW05], which are inspired by the Borchers–Uhlmann algebra [Bor62, Uhl62].</p>

				<p>In our notation, what Hollands and Wald propose is the following construction: Consider the offshell presymplectic vector space for a multiplet of p ∈ N Klein–Gordon fields PS</p>

				<figure>
					<trash>HW p (M , J ) := C ∞ 0 (M, R p ), σ M , where for all ϕ, ψ ∈ C ∞ 0 (M, R p ), σ M (ϕ, ψ) = M ϕ, E M (ψ) vol M . Apply the CCR-functor CCR(PS HW p (M , J )) and consider the two-sided * -ideal I HW p (M , J ) := KG M (ϕ) + M ϕ, J vol M : ϕ ∈ C ∞ 0 (M, R p ) , (7.17)</trash>


				</figure>

				<p>which is supposed to describe the inhomogeneous Klein–Gordon equation. The algebras of Hollands and Wald are then defined by the quotient QA</p>

				<figure>
					<trash>HW p (M , J) := CCR(PS HW p (M , J ))/I HW p (M , J ) and</trash>


				</figure>

				<p>it is easy to see that they are functorial, i.e. that we have a covariant functor QA HW p : LocSrc p → * Alg. The covariant functor QA HW p turns out to be naturally isomorphic to our functor QA p given in Proposition 7.8. Explicitly, the natural isomorphism κ : QA</p>

				<figure>
					<trash>HW p ⇒ QA p is given by setting, for all ϕ ∈ C ∞ 0 (M, R p ), κ (M ,J ) (ϕ) = Φ (M ,J) (ϕ) , (7.18)</trash>


				</figure>

				<p>and extending as a * Alg-morphism, which is possible as a result of the properties of Φ set out in Remark 7.10.</p>

			</div>
			<div>
				<head>7.3</head>

				<p>Relative Cauchy evolution of the functor QA p</p>

				<p>The relative Cauchy evolution of the functor PS p : LocSrc p → PreSymp induces that of the functor QA p : LocSrc p → * Alg as follows: Let (M , J ) be any object in LocSrc p and let (h, j) ∈ H(M , J ) be any globally hyperbolic perturbation. From the explicit expression for rce</p>

				<figure>
					<trash>(PS p ) (M ,J) [h, j] ∈ Aut(PS p (M , J )) given in (3.9) we observe that the relative Cauchy evolution rce (QAp) (M ,J) [h, j]</trash>


				</figure>

				<p>∈ Aut(QA p (M , J )) of QA p is uniquely specified by, for all [(ϕ, α)] ∈ QA p (</p>

				<figure>
					<trash>M , J ), rce (QAp) (M ,J) [h, j] [(ϕ, α)]</trash>


				</figure>

				<p>= ϕ + (KG M − KG M [h] ) E M [h]</p>

				<figure>
					<trash>(ϕ) , 0 + α + M −j, E M [h]</trash>


				</figure>

				<p>(ϕ) + (1 − ρ h ) (J + j), E M [h] (ϕ) vol M , (7.19) where on the right hand side we have used the equivalence relation entering the definition of QA p (M , J ) (cf. Proposition 7.8) and we have chosen as in (3.9) a representative ϕ with compact support in M + . In sufficiently regular representations of the algebra QA p (M , J ) one can differentiate this expression, yielding</p>

				<figure>
					<trash>d ds rce (QAp) (M ,J) [sh, sj] [(ϕ, α)]</trash>


				</figure>

				<p>s=0 = − KG ′ M [h]</p>

				<figure>
					<trash>E M (ϕ) , 0 − M 1 2 g ab h ab J + j, E M (ϕ) vol M = i 1 2 T (M ,J) (h) + [(j, 0)] ⋆ , [(ϕ, α)] , (7.20) where T (M ,J) (h) = M h ab T ab (M ,J)</trash>


				</figure>

				<p>vol M is the smearing with h ab of the quantization of the stressenergy tensor (3.13), with regularization by point-splitting (as emphasized in [BFV03], the precise nature of the c-number subtraction is irrelevant owing to the commutator). Although (7.19) was derived under an assumption on the support of the representative ϕ, the formulae in (7.20) are valid for any representative (ϕ, α) of its equivalence class. Of course, (7.20) is the Dirac quantization of (6.23). Finally, we note the special case of (7.19) for vanishing metric perturbation h = 0, namely rce (QAp) (M ,J) [0, j] [(ϕ, α)] = [(ϕ, α)] − M j, E M (ϕ) = [(ϕ, α)] + i [(j, 0)] ⋆ , [(ϕ, α)] . (7.21)</p>

			</div>
			<div>
				<head>7.4</head>

				<p>Automorphism group of the functor QA p</p>

				<p>We study the automorphism group of the covariant functor QA p : LocSrc p → * Alg defined in Proposition 7.8. For this we first notice that in the massless case m = 0 the automorphism group contains a R p subgroup.</p>

				<figure>
					<head>Proposition 7.12.</head>


				</figure>

				<p>If m = 0 there exists a faithful homomorphism η : R p → Aut(QA p ) induced by the one in Proposition 4.2 restricted to {+1} × R p ⊆ Z 2 × R p . Explicitly, for any object (M , J ) in LocSrc p the automorphism η(µ) (M ,J) is specified by, for all [(ϕ, α)] ∈ QA p (</p>

				<figure>
					<trash>M , J ), η(µ) (M ,J) [(ϕ, α)] = ϕ, α + M ϕ, µ vol M . (7.22)</trash>


				</figure>

			</div>
			<div>
				<head>Proof.</head>

				<p>Applying the functor CCR, the automorphism η(σ, µ) ∈ Aut(PS p ) of Proposition 4.2 induces an element in Aut(CQA p ) (denoted with a slight abuse of notation by the same symbol). For σ = −1 this automorphism does not preserve the two-sided * -ideals J p (M , J ), since η(−1, µ) (M ,J) [(0, α)]− α = [(0, −α)] − α ∈ J p (M , J ). For σ = +1 and µ ∈ R p arbitrary the two-sided * -ideals are preserved, hence η(+1, µ) induces the automorphism η(µ) ∈ Aut(QA p ) which is claimed in this proposition. The group law is an obvious consequence of the group law of the automorphisms η(σ, µ) of Proposition 4.2.</p>

				<figure>
					<head>Remark 7.13.</head>


				</figure>

				<p>In the same way, one may also show for m = 0 that the nontrivial Z 2 -automorphism of PS p does not lift to an automorphism of QA p .</p>

				<p>We may now prove that the automorphisms found in Proposition 7.12 exhaust Aut(QA p ). We require the analog of Theorem 4.5 for the functor QA p : LocSrc p → * Alg, which can be obtained by a similar proof as in Theorem 4.5 and hence can be omitted.</p>

				<figure>
					<head>Theorem 7.14.</head>

					<figDesc>Every endomorphism of the functor QA p is an automorphism and</figDesc>
					<trash>End(QA p ) = Aut(QA p ) ≃ {id QAp } , for m = 0 , R p , for m = 0 , (7.23)</trash>


				</figure>

				<p>where the action for m = 0 is given by Proposition 7.12.</p>

				<p>Proof. The steps in this proof are similar to the ones in Theorem 6.16. Let η ∈ End(QA p ) be any endomorphism and let us consider its component η (M 0 ,0) , where M 0 is Minkowski spacetime . For this particular object, the * Alg-isomorphism κ : QA p (M 0 , 0) → CQA lin p (M 0 ) defined by κ [(ϕ, α)] = α+[ϕ] lin intertwines the natural action of the Poincaré transformations on QA p (M 0 , 0) and CQA lin p (M 0 ). Consequently, the endomorphism η := κ • η (M 0 ,0) • κ −1 of CQA lin p (M 0 ) has to commute with all Poincaré transformations. Furthermore, because η (M 0 ,0) commutes with (derivatives of) the relative Cauchy evolution on QA p (M 0 , 0) – in particular those with h = 0 – we obtain the condition, for all j ∈ C ∞ 0 (M 0 , R p ) and [ϕ]</p>

				<figure>
					<trash>lin ∈ CQA lin p (M 0 ), η [j]</trash>


				</figure>

				<p>lin ⋆ , [ϕ] lin = [j] lin ⋆ , η [ϕ] lin (7.24) on η, where we have used (7.20) with h = 0. The left hand side of (7.24), which is analogous to (6.27) in the proof of Theorem 6.16, is simply i σ lin M 0 [j] lin , [ϕ] lin . Using the explicit expression (7.1) for the ⋆-product in CQA lin p (M 0 ), we find that the right hand side of this equality is equal to the Poisson bracket i [j] lin , η [ϕ]</p>

				<figure>
					<trash>lin σ lin M 0</trash>


				</figure>

			</div>
			<div>
				<head>.</head>

				<p>The remainder of the proof runs in complete analogy with that of Theorem 6.16.</p>

			</div>
			<div>
				<head>7.5</head>

				<p>Composition property of the functor QA p</p>

				<p>It remains to prove that the covariant functor QA p : LocSrc p → * Alg satisfies the composition property. We define for p ≥ 2 and 0 &lt; q &lt; p the covariant functor QA p,q := ⊗ • QA q × QA p−q • Split p,q : LocSrc p → * Alg (7.25) and we obtain the following, in complete analogy with the proof of Theorem 6.17 Theorem 7.15. For any p ≥ 2 and 0 &lt; q &lt; p, the covariant functors QA p,q : LocSrc p → * Alg and QA p : LocSrc p → * Alg are naturally isomorphic. The natural isomorphism η = {η (M ,J) } : QA p,q ⇒ QA p is specified by, for all [(ϕ, α)] ∈ QA q (M , J q ) and [(ψ, β)] ∈ QA p−q (</p>

				<figure>
					<trash>M , J p−q ), η (M ,J) [(ϕ, α)] ⊗ 1 = (ϕ, α) , η (M ,J) 1 ⊗ [(ψ, β)] = (ψ, β) , (7.26)</trash>


				</figure>

				<p>where on the right hand sides we have identified ϕ ∈ C ∞ 0 (M, R q ) and ψ ∈ C ∞ 0 (M, R p−q ) as elements in C ∞ 0 (M, R p ) (ϕ is placed in the first q and ψ in the last p − q components of R p ).</p>

			</div>
			<div>
				<head n="7.6">Dynamical locality</head>

				<p>To conclude, we shall study whether or not our improved functor QA p : LocSrc p → * Alg satisfies the dynamical locality property, which was introduced in [FV12a] as part of an investigation into the question of what it means for a theory to describe the same physics in all spacetimes (SPASs). The dynamical locality property has been proven previously for the homogeneous Klein–Gordon theory with non-vanishing mass m = 0 in [FV12b] and for extended algebras of Wick polynomials in [Fer13].</p>

				<p>We start by formulating the content of the dynamical locality property, essentially following [FV12a, FV12b], suitably adapted to theories on the category LocSrc p . Let (M , J ) be any object in LocSrc p . As above, we shall denote by O(M ) the set of all causally compatible, open and globally hyperbolic subsets of M with finitely many connected components all of which are mutually causally disjoint. To each non-empty O ∈ O(M ), there is an object (M , J )| O in LocSrc p obtained by restricting all the geometric data (including the source J ) to the subset O of M . Moreover, there is a canonical inclusion ι (M ,J );O : (M , J )| O → (M , J ) which is a morphism in LocSrc p . Adapting an idea from [BFV03], we may construct from QA p a net of unital * -algebras as follows: Given any non-empty O ∈ O(M ), we denote by QA</p>

				<figure>
					<trash>kin p ((M , J ); O) the image of QA p ((M , J )| O ) in QA p (M , J ) under the * Alg-morphism QA p (ι (M ,J);O ). The assignment O → QA kin p ((M , J ); O) ⊆ QA p (M , J ) (7.27)</trash>


				</figure>

				<p>is called the kinematic net, and is one way of describing the local physics of the theory QA p in a region O in the spacetime M underlying the object (M , J ). It is easily seen that QA kin p ((M , J ); O) is generated by the unit together with all [(ϕ, 0)] ∈ QA p (M , J ) such that supp(ϕ) ⊆ O.</p>

				<p>Another description of the local physics of the theory QA p in a region O in the spacetime M underlying the object (M , J ) can be obtained by using the relative Cauchy evolution and was introduced in [FV12a].</p>

				<figure>
					<figDesc>For K ⊆ M compact, let us denote by H((M , J ); K ⊥ ) the set of all globally hyperbolic perturbations (h, j) of (M , J), such that supp(h) ∪ supp(j) ⊆ K ⊥ , with K ⊥ := M \J M (K) the causal complement of K. We define QA • p ((M , J ); K) to be the subalgebra of QA p (M , J ) consisting of fixed points under arbitrary relative Cauchy evolutions rce</figDesc>
					<trash>(QAp) (M ,J) [h, j]</trash>


				</figure>

				<p>with (h, j) ∈ H((M , J ); K ⊥ ). The idea behind this definition is that the elements in QA • p ((M , J ); K) can be regarded as localized in K because they are insensitive to perturbations (h, j) of the background localized in the causal complement K ⊥ . By taking the subalgebra of QA p (M , J ) that is generated by the QA • p ((M , J ); K) as K ranges over suitable compact subsets of O ∈ O(M ) we obtain the dynamical algebras QA dyn p ((M , J ); O), which can be compared with the kinematic ones QA kin p ((M , J ); O). More precisely, let us denote by K b (M ; O) the set of finite unions of causally disjoint subsets of O ∈ O(M ), each of which is the closure of a Cauchy ball B with a relatively compact Cauchy development D M (B). Here, a Cauchy ball B is a subset of a Cauchy surface, for which there is a chart containing the closure of B, and in which B is a non-empty open ball. With these definitions in place, we set for any non-empty O ∈</p>

				<figure>
					<trash>O(M ) QA dyn p ((M , J ); O) := K∈K b (M ;O) QA • p ((M , J ); K) ⊆ QA p (M , J ) . (7.28) (The same algebra QA dyn p ((M , J ); O)</trash>


				</figure>

				<p>is obtained if K runs over all compact subsets of O possessing a neighborhood of the form ∪ k i=1 D M (B i ) where each B i is a Cauchy ball contained in O – see [FV12a, Lemma 5.3.].)</p>

				<figure>
					<head>Definition 7.16. The functor QA p :</head>

					<figDesc>LocSrc p → * Alg satisfies the dynamical locality property if, for all objects (M , J ) in LocSrc p and all non-empty O ∈ O(M ), we have</figDesc>
					<trash>QA kin p ((M , J ); O) = QA dyn p ((M , J ); O) . (7.29)</trash>


				</figure>

				<figure>
					<head>Remark 7.17.</head>


				</figure>

				<p>In its original formulation [FV12a], dynamical locality was defined using relative Cauchy evolution induced by metric perturbations, because only theories defined on Loc were considered . In generalizing to theories on LocSrc p , one has a choice as to whether to consider perturbations in both the metric and the external source, or just the metric, or potentially something intermediate. We have adopted the first of these possibilities as being the most natural – it would indeed appear strange to regard as local an observable that was sensitive to perturbations in the external source located in the causal complement of the localization region. However, our consideration of massless inhomogeneous theories will suggest a more nuanced view, which will be discussed below.</p>

				<p>Using the relative Cauchy evolution of the functor QA p derived in Subsection 7.3, we can characterize the fixed point subalgebras QA</p>

				<figure>
					<trash>• p ((M , J ); K) of rce (QAp) (M ,J) [h, j]</trash>


				</figure>

				<p>with (h, j) ∈ H((M , J ); K ⊥ ).</p>

				<figure>
					<head>Lemma 7.18.</head>

					<figDesc>Let (M , J ) be any object in LocSrc p and let K be any compact subset of M . Then QA • p ((M , J ); K) is the subalgebra of QA p (M , J ) generated by the unit together with all [(ϕ, 0</figDesc>

				</figure>

				<p>)] ∈ QA p (M , J ) such that supp E M (ϕ) ⊆ J M (K).</p>

			</div>
			<div>
				<head>Proof.</head>

				<p>The stated subalgebra of QA p (M , J ) is a subalgebra of QA • p ((M , J ); K) for the following reason: If [(ϕ, 0)] obeys supp E M (ϕ) ⊆ J M (K) then, for any (h, j) ∈ H((M , J ); K ⊥ ), we have E M [h]</p>

				<figure>
					<figDesc>(ϕ) = E M (ϕ) and hence rce</figDesc>
					<trash>(QAp) (M ,J) [h, j] [(ϕ, 0</trash>


				</figure>

				<p>)] = [(ϕ, 0)] by (7.19). Thus QA • p ((M , J ); K) contains the subalgebra generated by (finite sums of finite products of) such elements and the unit.</p>

				<p>To show the reverse inclusion, let us take any element a ∈ QA • p ((M , J ); K). In particular, using (7.21), we find the condition that, for all j ∈ C ∞ 0 (K ⊥ , R p ), [(j, 0)] ⋆ , a = 0. Evaluating the ⋆product (7.1) in the commutator, this condition reduces to the vanishing Poisson bracket condition [(j, 0)], a σ (M ,J) = 0, for all j ∈ C ∞ 0 (K ⊥ , R p ). We can now express a as a finite sum of finite symmetric products of the unit and the elements [(ϕ, 0)] with ϕ ∈ C ∞ 0 (M, R p ). Notice that if a is one of the generators [(ϕ, 0)], with ϕ ∈ C ∞ 0 (M, R p ), then the vanishing Poisson bracket condition implies that supp E M (ϕ) ⊆ J M (K). For generic a ∈ QA • p ((M , J ); K) we follow the strategy in [FV12b, Lemma 5.2. and Appendix A] and associate to a its support subspace Y a , which is a finite dimensional vector subspace of the complex vector space spanned by the [(ϕ, 0)], ϕ ∈ C ∞ 0 (M, R p ), such that the element a lies in the subalgebra generated by Y a together with the unit. If a ∈ QA • p ((M , J ); K) then Y a is invariant under the relative Cauchy evolution corresponding to perturbations supported in K ⊥ ; considering relative Cauchy evolutions of the form (7.21), we see that all [(ϕ, 0)] in the support subspace must satisfy supp E M (ϕ) ⊆ J M (K). Hence, a is generated only by (finite sums of finite symmetric products of) the unit and those generators [(ϕ, 0)] satisfying supp E M (ϕ) ⊆ J M (K). As one can invert the formula (7.1) for the ⋆-product (leading to an expression for the symmetric product in terms of ⋆-products) this implies that a is also generated by finite sums of finite ⋆products of the unit and the elements [(ϕ, 0)] with supp E M (ϕ) ⊆ J M (K).</p>

				<p>With this preparation we can prove the main statement of this subsection.</p>

				<figure>
					<head>Theorem 7.19.</head>

					<figDesc>The functor QA p : LocSrc p → * Alg satisfies the dynamical locality property.</figDesc>

				</figure>

				<p>Proof. We must show that (7.29) holds for all objects (M , J ) in LocSrc p and all non-empty O ∈ O(M ). Notice that the unit is contained in both QA kin p ((M , J ); O) and QA dyn p ((M , J ); O). To show the inclusion &quot; ⊆ &quot; , note that any a ∈ QA kin p ((M , J ); O) is generated by finite sums of finite products of the unit and the elements [(ϕ, 0)] with supp(ϕ) ⊆ O, all of which may be shown to lie in QA dyn p ((M , J ); O) by an argument similar to [FV12b, Lemma 3.3.]: We can decompose ϕ ∈ C ∞ 0 (O, R p ) into a finite sum ϕ = n i=1 ϕ i , such that supp(ϕ i ) ⊂ D M (B i ) for Cauchy ball B i with cl B i ∈ K b (M ; O). (Take for example an open cover of supp(ϕ) by diamonds, pass to a finite subcover and then use a partition of unity.) For each ϕ i we have supp E M (ϕ i ) ⊆ J M (supp(ϕ i )) ⊆ J M (B i ), which shows that [(ϕ i , 0)] ∈ QA • p ((M , J ); cl B i ) and hence [(ϕ, 0)] = n i=1 [(ϕ i , 0)] ∈ QA dyn p ((M , J ); O).</p>

				<p>To show the other inclusion &quot; ⊇ &quot; , it is by Lemma 7.18 sufficient to prove that, for any K ∈ K b (M ; O), all elements [(ϕ, 0)] ∈ QA p (M , J ) with supp E M (ϕ) ⊆ J M (K) are contained in QA kin p ((M , J ); O). This is a simple consequence of the following argument: Since E M (ϕ) has support in J M (K) and K ⊆ O is a compact subset, there exists a ϕ ′ ∈ C ∞ 0 (O, R p ), such that E M (ϕ ′ ) = E M (ϕ), see e.g. [FV12b, Lemma 3.1. (i)]. As the Klein–Gordon operator is normally hyperbolic, we have ϕ ′ = ϕ + KG M (h), for some h ∈ C ∞ 0 (M, R p ). Thus, [(ϕ, 0)] = [(ϕ</p>

				<figure>
					<figDesc>+ KG M (h), M J, h vol M )] = [(ϕ ′ , 0)] + M J , h vol M lies in QA kin p ((M , J ); O).</figDesc>
					<head>Remark 7.20.</head>


				</figure>

				<p>The proofs of Lemma 7.18 and Theorem 7.19 do not distinguish between the massless and the massive case. In contrast, this distinction was essential for the homogeneous Klein–Gordon theory studied in [FV12b]; indeed only the massive homogeneous Klein–Gordon field satisfies the dynamical locality property. At first sight this looks like a discrepancy, because the homogeneous Klein–Gordon theory seems to be contained as a special case of our inhomogeneous model by setting all source terms to zero. However, the inhomogeneous theory is formulated as a functor QA p from the category LocSrc p to * Alg and the relative Cauchy evolution rce</p>

				<figure>
					<trash>(QAp) (M ,J) [h, j]</trash>


				</figure>

				<p>depends on both a metric perturbation h and a source term perturbation j. Even restricting to (the full subcategory of) objects with zero source term J = 0, we still can study the response (via the relative Cauchy evolution) of the restricted theory to source term perturbations j, as well as the response to metric perturbations h, thus obtaining stronger restrictions on the fixed point subalgebras QA • p ((M , J ); K) than those arising from metric perturbations h alone as in [FV12b]. To conclude, we point out that if we forbade nontrivial source term perturbations j in our proofs above, i.e. making only use of the relative Cauchy evolutions rce</p>

				<figure>
					<trash>(QAp) (M ,J) [h, 0]</trash>


				</figure>

				<p>depending on h, we would obtain as in [FV12b] (and by similar arguments) that the massive theory satisfies (this restricted form of) the dynamical locality property and that the massless theory does not. We finally remark that if we were to restrict to coexact source perturbations j = δα (for compactly supported one-forms α) and traceless metric perturbations h we would also lose dynamical locality in the massless case. This will be discussed further below.</p>

			</div>
			<div>
				<head n="8">Gauge theory interpretation in the massless case</head>

				<p>In this section we shall briefly point out and discuss some features of the classical and quantum theory of a massless multiplet of p ∈ N inhomogeneous Klein–Gordon fields.</p>

				<p>Let us start with the automorphisms of this theory. As was shown in Theorem 6.16 for the classical and in Theorem 7.14 for the quantized case, this theory has a nontrivial automorphism group isomorphic to R p . These symmetries can also be understood from the Lagrangian of this model (see equation (1.1) with m = 0) as they correspond to shifts of the classical field φ, i.e. transformations φ → φ + µ with µ ∈ R p . According to [Few13] one should regard the massless Klein–Gordon theory as a gauge theory of the first kind with φ playing the role of a zero-form gauge field. This is supported by the fact that the Lagrangian can also be written as L = 1 2 dφ, * dφ − φ, * J , (8.1) where * denotes the Hodge operator corresponding to M . The differentials dφ play the same role as the field strength F = dA in electromagnetism, just one differential form degree lower. Under gauge transformations φ → φ ′ = φ + µ, µ ∈ R p , the Lagrangian transforms as L → L ′ = L − µ, * J , (8.2) thus it is gauge invariant up to a φ-independent term − µ, * J , which however depends on the metric via the Hodge operator. In particular, the gauge transformations map the solution space of the inhomogeneous massless Klein–Gordon equation to itself. This global gauge invariance is exactly the one described by the automorphism groups characterized in Theorem 6.16 and Theorem 7.14. With this interpretation in mind, the observables of the theory should be identified with those elements of the Poisson or quantized algebras that are fixed under the action of the automorphism group. As described in [Few13, §3.3] this would lead in a natural way to subfunctors of PA p and QA p that can be interpreted as the &apos;theories of observables&apos;. This strategy was implemented for the massless homogeneous Klein–Gordon theory in [Few13, §5.3] and, while we have not worked through the analogue for the present models, our expectation is that it would result in the theories obtained by the following construction: For any object (M , J ) in LocSrc p we take the vector subspace PS inv p (M , J ) ⊆ PS p (M , J ) consisting of all [(ϕ, α)], such that M ϕ, µ vol M = 0 for all µ ∈ R p .</p>

				<p>It is easy to see that PS inv p : LocSrc p → PreSymp is a subfunctor of PS p and that, by the same construction as in Section 6 and Section 7, we arrive at subfunctors PA inv p : LocSrc p → PoisAlg and QA inv p : LocSrc p → * Alg of, respectively, PA p and QA p , which are gauge-invariant. (The remaining issue is whether they coincide with the fixed-point subtheories of PA p and QA p , but this is our expectation.)</p>

				<p>The role of this gauge invariance is obscured when we study globally hyperbolic perturbations (h, j) of the background (M , J ) via the relative Cauchy evolution. The stress-energy tensor (see (3.13) and set m = 0) obtained by the h-derivative of the relative Cauchy evolution is not gauge invariant under φ → φ ′ = φ + µ, µ ∈ R p ; it transforms as T ab (M ,J) [φ] → T ab (M ,J) [φ ′ ] = T ab (M ,J) [φ] + g ab µ, J , (8.3) and therefore is not an observable according to our discussion above. 7 This feature becomes again clear by looking at the transformation property of the Lagrangian (8.2): In fact, the stress-energy tensor derived from the transformed Lagrangian L ′ via taking the functional derivative along g ab does not coincide with the one obtained from the untransformed Lagrangian L due to the metricdependent extra term in the transformation law (8.2). Note, however, that smearings of the stressenergy tensor by traceless tensor fields are gauge-invariant and thus qualify as observables. Likewise, smearings of the field against test functions that are derivatives of compactly supported 1-forms also give observables. This gives an interesting perspective on some of the points made in Remark 7.20: the massless inhomogeneous theory fails to be dynamically local if one restricts to variations of background structures with relative Cauchy evolution generated by observable fields, but is dynamically local if one also allows variations generated by unobservable fields.</p>

				<p>In order to obtain a gauge invariant stress-energy tensor we might proceed as follows: If we replace the source terms J ∈ C ∞ (M, R p ) by source terms that are top-form valued</p>

				<figure>
					<trash>J ∈ Ω dim(M ) (M, R p ), the Lagrangian (8.1) can be written as L = 1 2 dφ, * dφ − φ, J . (8.4) Under gauge transformations φ → φ + µ, µ ∈ R p , the Lagrangian transforms as L → L ′ = L − µ, J , (8.5)</trash>


				</figure>

				<p>where now the φ-independent additional term does not depend on the metric. As a consequence, the stress-energy tensor obtained by the functional derivative of the Lagrangian along g ab reads T ab (M , J) [φ] = ∇ a φ, ∇ b φ − 1 2 g ab ∇ c φ, ∇ c φ (8.6) and is gauge invariant. The functorial theory with top-form valued source terms can be obtained from our functors PA p : LocSrc p → PoisAlg and QA p : LocSrc p → * Alg by noticing the following equivalence of categories: Let us define in analogy to LocSrc p (see Definition 2.1) the category LocTop p , where objects are tuples (M , J ) with J ∈ Ω dim(M ) (M, R p ) a top-form source term. The categories LocSrc p and LocTop p are equivalent via the Hodge operator. Explicitly, we define the covariant functor Hodge : LocTop p → LocSrc p on objects by Hodge(M , J ) = (M , * J ) and on morphisms by Hodge(f ) = f (with a slight abuse of notation we denote both a morphism and its underlying smooth map by the same symbol). The inverse Hodge operator provides us with the inverse functor Hodge −1 : LocSrc p → LocTop p . Hence, LocSrc p and LocTop p are equivalent categories. Composing the functor Hodge with our functors PA p and QA p we obtain the covariant functors PA p := PA p • Hodge : LocTop p → PoisAlg , (8.7a) QA p := QA p • Hodge : LocTop p → * Alg , (8.7b) which are respectively a locally covariant classical and quantum field theory. The endomorphisms of PA p and QA p of course coincide with the ones of PA p and QA p . However, as the functor Hodge mixes between the metric and the external source terms, the relative Cauchy evolution of the new theories differs from the that of the original theories. Indeed, from (3.7) and (3.9) one easily observes that, for all [(ϕ, α)] ∈</p>

				<figure>
					<trash>PA p (M , J ), rce ( PA p ) (M , J) [h, j] [(ϕ, α)]</trash>


				</figure>

				<p>= ϕ + (KG M − KG M [h] ) E M [h] (ϕ) , α − M j, E M [h]</p>

				<figure>
					<trash>(ϕ) vol M , (8.8) where now j ∈ Ω dim(M ) 0</trash>


				</figure>

				<p>(M, R p ) is a compactly supported perturbation of the top-form source term J. A similar formula holds true for the relative Cauchy evolution of QA p . Following the same steps as in Appendix A, we can extract the stress-energy tensor (up to a constant functional) from the derivative of this relative Cauchy evolution along h. In the massless case, we find exactly the one obtained from the Lagrangian, see (8.6). As already mentioned, this stress-energy tensor is gauge invariant under the gauge transformations φ → φ + µ, µ ∈ R p .</p>

			</div>
			<div>
				<head n="9">Concluding remarks</head>

				<p>Our original aim was to understand how the methods of [Few13] could be extended to the setting of locally covariant theories with external sources in order to compute the automorphism group (which should be the global gauge group) of the inhomogeneous Klein–Gordon theory. This has brought to light various shortcomings in the formulation of the theory according to the prescription of [BDS14a]: it has automorphisms that are not gauge symmetries of the original theory (cf. Theorem 4.6); furthermore, it violates a natural composition property that expresses the lack of interaction between fields in the multiplet (cf. Proposition 5.3). To remedy these problems, we have proposed an improved formulation of such theories at the classical and quantum level. We have traced the source of the pathological behavior to a failure of [BDS14a] to adequately capture the interplay between the observables spaces (described by the presymplectic vector spaces) with the solution spaces. We have reintroduced this information by studying the representation of the abstract Poisson algebras derived from these presymplectic vector spaces on the solution spaces. These representations of the Poisson algebras have a kernel, which has no corresponding analog in the category of presymplectic vector spaces. Performing the quotient by these kernels, we have obtained a functor to the category of Poisson algebras which gives an appropriate description of the classical theory of a multiplet of inhomogeneous Klein–Gordon fields. We have substantiated this claim by proving that the theory has the correct automorphism group and satisfies the composition property. In the quantized setting, we have replaced the pairing between observables and solutions with carefully defined state spaces on the CCR-algebras derived from our presymplectic vector spaces. The GNS representation of our CCR-algebras in these state spaces has a kernel, and we have shown that the quantum algebras obtained by quotienting out these kernels are given functorially. Again, we have justified our constructions by showing that the automorphism group of this improved functor is the correct one and that the composition property holds true.</p>

				<p>In this paper we have restricted ourselves to the simplest case given by a multiplet of inhomogeneous Klein–Gordon fields, as this choice made it possible to characterize explicitly the relative Cauchy evolution and the automorphism groups, which were important tools in unraveling the pathological features of the earlier approach to affine field theories [BDS14a]. However, our insights concerning the improved functors describing the classical and quantum theory of this model remain valid for generic affine field theories as described in [BDS14a]. In particular, the general presymplectic vector space functor in [BDS14a] can be promoted via CanPois to a covariant functor with values in the category of Poisson algebras. This functor can be paired with the solution space functor corresponding to the equation of motion operators, which are part of the source category in [BDS14a], and the corresponding kernel forms a Poisson ideal. The improved classical functor for generic affine field theories is then given by taking the quotient of the canonical Poisson algebras by these Poisson ideals. In the quantized setting one proceeds analogously to Section 7, i.e. one defines suitable state spaces and studies the kernels of the corresponding GNS representation. The same techniques apply to Abelian gauge theories [BDS14b, BDHS13], where however the following remark is in order: The kernel of the presymplectic spaces in [BDS14b, BDHS13] does not only consist of constant affine functionals, but also topological observables (&apos;electric charges&apos;) depending on the topology of spacetime. This implies that quotienting out the kernel of the pairing between the abstract Poisson algebras and the solution spaces does not generally yield simple Poisson algebras. The same holds true for quotienting out the kernel of the GNS representation of the CCR-algebras given by suitable state spaces. This additional degeneracy in the improved Poisson algebras (or the center in the improved quantum algebras) is the reason that Abelian gauge theories violate the injectivity axiom of locally covariant quantum field theory. As is clear from the general no-go theorem in [BDHS13], our approach does not resolve this issue and hence reconciling gauge theory with locally covariant quantum field theory remains an open problem for future work.</p>

				<p>Finally, we have shown that our improved quantum theory is equivalent to that used by Hollands and Wald [HW05] for the inhomogeneous Klein–Gordon theory – see Remark 7.11. However, we would like to stress that our techniques are more general and flexible; in fact, in cases where the theory is already affine at the kinematical level (as e.g. in Abelian gauge theory), the Borchers– Uhlmann algebra of the affine dual of the configuration space has to be considered, which will have a similar pathological behavior as our canonical algebras in Subsection 7.1 and hence has to be modified by our methods developed in Subsection 7.2. Moreover, using our techniques, we have determined a number of detailed properties of these inhomogeneous field theories and exemplified the opportunities for analyzing and distinguishing locally covariant theories by functorial invariants opened up by [Few13]. also thank Ko Sanders for prompting us to clarify the relationship between some of our results and those of reference [SDH14]. Furthermore, we thank the referees for their careful evaluation of our manuscript and their useful comments and suggestions.</p>

				<p>A Differentiation of the relative Cauchy evolution and stress-energy tensor We discuss the sense in which the relative Cauchy evolution of PS p can be differentiated, and show that it has the derivative stated in the text. Our method follows that of [FV12b, Appendix A]; however, additional care must be taken when defining a suitable topology. In [FV12b], the relative Cauchy evolution for the (homogeneous) real scalar field was differentiated using the weak symplectic topology on the spacelike compact solution space (describing the linear observables of the theory) induced by seminorms of the form |σ M ( · , φ)|, where σ M is the symplectic structure and φ ranges over the symplectic vector space. An obvious generalization to our present context is to induce a topology from the presymplectic structure on PS p (M , J ) in a similar way. However, the resulting topology does not separate points, because the presymplectic structure is degenerate.</p>

				<p>In particular, it is clear from (3.7) that the presymplectic pairing between any element with an element rce</p>

				<figure>
					<trash>(PS p ) (M ,J) [h, j] [(ϕ, α)]</trash>


				</figure>

				<p>is independent of j – it would therefore be impossible to obtain the &apos;obviously correct&apos; derivative given in (3.11b).</p>

				<p>The solution to this problem is, as at various other points in this paper, to recall that PS p (M , J ) acts as a space of functionals on the affine solution space Sol p (M , J ) of the inhomogeneous theory.</p>

				<p>Dually, therefore, each solution φ ∈ Sol p (M , J ) defines a seminorm | · , φ (M ,J) |, where the pairing · , · (M ,J) was defined in (2.9). The resulting weak- * topology does separate points and is the appropriate generalization of the weak symplectic topology used in [FV12b]. With the topology fixed, differentiability of the relative Cauchy evolution may be established as follows.</p>

				<figure>
					<trash>From (3.9) we have rce (PS p ) (M ,J) [h, j]</trash>


				</figure>

				<p>− id PS p (M ,J) [(ϕ, α)] , φ</p>

				<figure>
					<trash>(M ,J) = M (KG M − KG M [h]</trash>


				</figure>

				<p>) E M [h] (ϕ) , φ − j, E M [h] (ϕ) +(1−ρ h ) J + j, E M [h]</p>

				<figure>
					<trash>(ϕ) vol M , (A.1)</trash>


				</figure>

				<p>and the integration region may be restricted, without loss, to any strip 8 S of M containing the support of j and h. As in [FV12b, Appendix B], energy estimates entail that s → E M [sh] (ϕ) is differentiable in L 2 (S, vol M ) ⊗ C p ; moreover s → 1 − ρ sh is smooth in L 2 (S, vol M ) near s = 0, with first derivative − 1 2 g ab h ab at s = 0. It follows that M sj, E M [sh]</p>

				<figure>
					<trash>(ϕ) vol M = s M j, E M (ϕ) vol M + O(s 2 ) (A.2a) and M (1 − ρ sh ) J + sj, E M [sh] (ϕ) vol M = − s 2 M g ab h ab J , E M (ϕ) vol M + O(s 2 ) . (A.2b) Moreover, the formula M KG M − KG M [sh]</trash>


				</figure>

				<p>E M [sh]</p>

				<figure>
					<trash>(ϕ) , φ vol M = −s M KG ′ M [h] E M (ϕ) , φ vol M + O(s 2 ) (A.3) was established in [FV12b, Appendix B]</trash>


				</figure>

				<p>. Note that here φ solves the inhomogeneous equation, while its analogue in the cited reference solved the homogeneous equation. However the difference is inessential, because the only property of φ used is that it is square-integrable on the strip S.</p>

				<figure>
					<trash>Assembling these observations, d ds rce (PS p ) (M ,J) [sh, sj] [(ϕ, α)]</trash>


				</figure>

				<p>, φ</p>

				<figure>
					<trash>(M ,J ) s=0 = − T (M ,J) [h]</trash>


				</figure>

				<p>+ J (M ,J ) [j] [(ϕ, α)] , φ</p>

				<figure>
					<trash>(M ,J) (A.4) for every φ ∈ Sol p (M , J ), where T (M ,J) [h]</trash>


				</figure>

				<p>and J (M ,J) [j] were given in (3.11a) and (3.11b). Accordingly , (3.10) holds in the weak- * topology on PS p (M , J ).</p>

				<p>To relate these formulae with the classical stress-energy tensor and action, we note that KG ′ M [h] = d ds KG M [sh]</p>

				<figure>
					<trash>s=0 = −∇ a h ab ∇ b + 1 2 ∇ a h b b ∇ a (A.5)</trash>


				</figure>

				<p>(unfortunately, a sign error appears in the analogous step in [FV12b]: see the second line of the central displayed formula on p.1706 of that reference). Inserting this formula and integrating by parts we obtain T (M ,J) [h] [(ϕ, α)] , φ</p>

				<figure>
					<trash>(M ,J) = M h ab ∇ b E M (ϕ), ∇ a φ − 1 2 h b b ∇ a ∇ a E M (ϕ), φ vol M + M 1 2 g ab h ab J , E M (ϕ) vol M = M h ab ∇ b E M (ϕ), ∇ a φ − 1 2 g ab ∇ c E M (ϕ), ∇ c φ + 1 2 m 2 g ab E M (ϕ), φ + 1 2 g ab J , E M (ϕ) vol M = 1 2 d ds M h ab T ab (M ,J) [φ + s E M (ϕ)] vol M s=0 , (A.6) thus establishing (3.12</trash>


				</figure>

				<p>), where the stress-energy tensor is given by (3.13) and we have used the fact that</p>

				<figure>
					<trash>∇ a ∇ a E M (ϕ), φ = M E M (ϕ) , φ + ∇ a E M (ϕ), ∇ a φ = −m 2 E M (ϕ), φ + ∇ a E M (ϕ), ∇ a φ . (A.7)</trash>


				</figure>

				<p>To conclude, we will express the derivative of the relative Cauchy evolution using the Poisson bracket. Identifying the space of solutions Sol p (M , J ) with phase space, and identifying an element [(ϕ, α)] ∈ PS p (M ) with the functional φ → [(ϕ,</p>

				<figure>
					<trash>α)], φ (M ,J ) = M φ, ϕ vol M + α (A.8) on phase space (cf. (2.9)), we already have the Poisson bracket (cf. (2.6)) [(ϕ, α)], [(ϕ ′ , α ′ )] σ (M ,J) (φ) := [(ϕ, α)], [(ϕ ′ , α ′ )] σ (M ,J ) , φ (M ,J) = E M (ϕ, ϕ ′ ) . (A.9)</trash>


				</figure>

				<p>Unsmearing the second slot, this gives [(ϕ,</p>

				<figure>
					<trash>α)], φ(x) σ (M ,J) (φ) = − E M (ϕ) (x) , (A.10)</trash>


				</figure>

				<p>where, in an obvious way, φ(x), x ∈ M , stands for the functional φ → φ(x) on phase space. Thus, we also have for the functional φ → M f φ, φ vol M [(ϕ,</p>

				<figure>
					<trash>α)], φ → M f φ, φ vol M σ (M ,J) (φ) = 2 E M (ϕ, f φ) . (A.11) Proceeding in this way, one easily obtains the formula d ds rce (PS p ) (M ,J) [sh, sj] [(ϕ, α)] , φ (M ,J) s=0 = [(ϕ, α)], φ → M 1 2 h ab T ab (M ,J) [φ] + j, φ vol M σ (M ,J) (φ) , (A.12)</trash>


				</figure>

				<p>which can also be written in the form (6.23). In this form, it is clear that, just as the relative Cauchy evolution correctly identifies the current coupling to the metric as the stress-energy tensor, so it also correctly identifies the &apos;current&apos; coupling to the external source J as the field φ itself.</p>

			</div>
			<div>
				<head>B Pointed presymplectic spaces</head>

				<p>We briefly discuss an alternative method for obtaining a good classical and quantum theory of the inhomogeneous models. The idea is to modify the functor PS p , so that it takes values in the category of pointed presymplectic spaces @BULLETPreSymp defined as follows: Objects of @BULLETPreSymp are pairs ((V, σ V ), 1 V ), where (V, σ V ) is an object in PreSymp (so that σ V has nontrivial null space) and 1 V is a distinguished nonzero vector in the null space of σ V . A morphism L : ((V, σ V ), 1 V ) → ((W, σ W ), 1 W ) is a PreSymp morphism L : (V, σ V ) → (W, σ W ), such that L(1 V ) = 1 W . For example, in the onedimensional vector space with trivial presymplectic structure I = (R, 0) we may single out the unit of R to obtain a pointed presymplectic space (I, 1), which is then an initial object of @BULLETPreSymp – in fact, we may also regard @BULLETPreSymp as the category of arrows in PreSymp with domain I.</p>

				<p>Our modified functor @BULLETPS p : LocSrc p → @BULLETPreSymp is defined on objects by @BULLETPS p (M , J ) = PS p (M , J ), [(0, 1)] (B.1) and on morphisms by @BULLETPS p (f ) = PS p (f ), noting that the latter indeed preserve the distinguished elements [(0, 1)] ∈ PS p (M , J ), which are naturally distinguished by their action on solutions: [(0, 1)], φ (M ,J) = 1 for all φ ∈ Sol p (M , J ).</p>

				<p>The resulting theory has the expected symmetries.</p>

				<p>Theorem B.1. Every endomorphism of the covariant functor @BULLETPS p : LocSrc p → @BULLETPreSymp is an automorphism and</p>

				<figure>
					<trash>End(@BULLETPS p ) = Aut(@BULLETPS p ) ≃ {id @BULLETPS p } , for m = 0 , R p , for m = 0 , (B.2)</trash>


				</figure>

				<p>where for m = 0 the action is given by, for all [(ϕ, α)] ∈ @BULLETPS p (M , J ) and µ ∈ R p , @BULLETη(µ) (M ,J) [(ϕ, α)] = ϕ, α + M ϕ, µ vol M . (B.3)</p>

			</div>
			<div>
				<head>Proof.</head>

				<p>The forgetful functor @BULLETPreSymp → PreSymp induces a faithful homomorphism End(@BULLETPS p ) → End(PS p ) of monoids. Thus, it suffices to determine which endomorphisms of PS p lift to @BULLETPS p .</p>

				<p>By Proposition 4.1 and Theorem 4.6, we see that η(−1) (M ,J) ([(0, 1)]) = [(0, −1)] so η(−1) does not lift, leaving only the trivial group for m = 0. Similarly, by Proposition 4.2 and Theorem 4.6, we see in the massless case that η(σ, µ) (M ,J ) ([(0, 1)]) = [(0, σ)] so η(σ, µ) lifts if and only if σ = 1.</p>

				<p>The second problem identified with PS p was its failure to behave correctly with respect to the composition of systems, see Section 5. In our present context this can be remedied in the following way: The natural composition of pointed presymplectic spaces ((V, σ V ), 1 V ) and ((W, σ W ), 1 W ) is not the direct sum, but rather the direct sum with amalgamation of distinguished points</p>

				<figure>
					<trash>((V, σ V ), 1 V ) ⊕ • ((W, σ W ), 1 W ) = ((V ⊕ W )/ ∼, σ V ⊕W ), (1 V , 0) , (B.4)</trash>


				</figure>

				<p>where the equivalence relation implements a quotient by the subspace {(λ1 V , −λ1 W ) : λ ∈ R}. Note this is well-defined due to our assumption that the distinguished elements lie in the null space of the presymplectic structures. The operation ⊕ • gives a monoidal structure on @BULLETPreSymp, with monoidal unit (I, 1), just as the direct sum ⊕ does for PreSymp (with the zero-dimensional presymplectic vector space as the monoidal unit).</p>

				<p>Theorem B.2. The theory @BULLETPS p obeys the composition property, i.e., there is a natural isomor- phism @BULLETPS p ∼ = @BULLETPS p,q := ⊕ • • • PS q × @BULLETPS p−q • Split p,q . (B.5)</p>

			</div>
			<div>
				<head>Proof.</head>

				<p>For any object (M , J ) in LocSrc p , define (η p,q ) (M ,J) : @BULLETPS p,q (M , J ) → @BULLETPS p (M , J ) by, for all [(ϕ, α)] ∈ @BULLETPS q (M , J q ) and [(ψ, β)] ∈ @BULLETPS p−q (M , J p−q ), (η p,q ) (M ,J) [(ϕ, α)], [(ψ, β)] = (ϕ + ψ, α + β) , (B.6) where on the right hand side we have identified ϕ ∈ C ∞ 0 (M, R q ) and ψ ∈ C ∞ 0 (M, R p−q ) as elements in C ∞ 0 (M, R p ) (ϕ is placed in the first q and ψ in the last p − q components of R p ). This map is well-defined (because α and β are summed on the right-hand side of (B.6)), linear and it preserves the distinguished element and the presymplectic structure. Furthermore, it is invertible via @BULLETPS p (M , J ) ∋ [(ϕ, α)] → [(ϕ q , α)], [(ϕ p−q , 0)] , where ϕ = ϕ q + ϕ p−q denotes the split of ϕ ∈ C ∞ 0 (M, R p ) into the first q and last p − q components. Hence, (B.6) is an isomorphism in @BULLETPreSymp.</p>

				<p>To establish naturality, consider any morphism f : (M 1 , J 1 ) → (M 2 , J 2 ) in LocSrc p . It is straightforward to check commutativity of [(ϕ, α)], [(ψ, β)] ❴</p>

				<figure>
					<trash>@BULLETPS p,q (f ) ✤ (ηp,q ) (M 1 ,J 1 ) / / (ϕ + ψ, α + β) ❴ @BULLETPS p (f ) [(f * (ϕ), α)], [(f * (ψ), β)] ✤ (ηp,q) (M 2 ,J 2 ) / / (f * (ϕ + ψ), α + β) (B.7) for all [(ϕ, α)] ∈ @BULLETPS q (M 1 , J q 1 ) and [(ψ, β)] ∈ @BULLETPS p−q (M 1 , J p−q 1</trash>

					<figDesc>). Hence, the (η p,q ) (M ,J) form the components of a natural isomorphism. Finally, we consider the quantization of pointed presymplectic spaces via a suitable covariant functor @BULLETCCR : @BULLETPreSymp → * Alg. On objects we set @BULLETCCR((V, σ V ), 1 V ) = CCR(V, σ V )/I(V, σ V ), where I(V, σ V ) is the two-sided * -ideal generated by 1 V − 1. On morphisms L : ((V, σ V ), 1 V ) → ((W, σ W ), 1 W ) we have CCR(L)(1 V ) = 1 W and hence there is a uniquely defined injective * -algebra homomorphism @BULLETCCR(L) : @BULLETCCR((V, σ V ), 1 V ) → @BULLETCCR((W, σ W ), 1 W ) making the following diagram commute</figDesc>
					<trash>CCR(V, σ V ) CCR(L) / / CCR(W, σ W ) @BULLETCCR((V, σ V ), 1 V ) @BULLETCCR(L) / / @BULLETCCR((W, σ W ), 1 W ) (B.8)</trash>


				</figure>

				<p>where the vertical morphisms are the quotient maps (and the diagram is drawn in the category of unital * -algebras without the requirement that morphisms be monic). Our last result is simply a restatement of the definition of the improved functor QA p : LocSrc p → * Alg in Subsection 7.2.</p>

				<p>Theorem B.3. QA p = @BULLETCCR • @BULLETPS p .</p>

			</div>
			<div>
				<head>C Deformation quantization</head>

				<p>As a further alternative construction of the improved functor QA p : LocSrc p → * Alg we focus on deformation quantization. We show that, starting from the improved Poisson algebra functor PA p : LocSrc p → PoisAlg, we can obtain for each object (M , J) in LocSrc p the unital * -algebra QA p (M , J ) by deformation quantization of (the complexification of) the Poisson algebra PA p (M , J ). After this, we make some remarks on the application of Fedosov quantization [Fed94], which has been studied recently in [SDH14] (although not adhering strictly to [Fed94], as we will explain) for the inhomogeneous Maxwell field.</p>

				<figure>
					<figDesc>Let (M , J ) be any object in LocSrc p and consider the Poisson algebra PA p (M , J ) constructed in Subsection 6.2, which we shall denote also by A := PA p (M , J ) in order to simplify the notation. We define a differential graded algebra over the unital algebra A as follows: Consider the graded commutative algebra Ω • := PA p (M , J ) ⊗ • PS lin p (M ) with product defined by linearity and, for all a ⊗ λ, a ′ ⊗ λ ′ ∈ Ω • ,</figDesc>
					<trash>(a ⊗ λ) (a ′ ⊗ λ ′ ) := (a a ′ ) ⊗ (λ ∧ λ ′ ) . (C.1)</trash>


				</figure>

				<p>We define a differential d : Ω • → Ω @BULLET+1 by linearity, the graded Leibniz rule and setting, for all 1 ⊗ λ ∈ Ω • and [(ϕ, α)] ⊗ λ ∈ Ω • , d 1 ⊗ λ = 0 , d [(ϕ, α)] ⊗ λ = 1 ⊗ [ϕ]</p>

				<figure>
					<trash>lin ∧ λ . (C.2)</trash>

					<figDesc>Using the differential graded algebra (Ω • , d) over A, the Poisson bracket in PA p (M , J ) can be reformulated as, for all a, a ′ ∈ A,</figDesc>
					<trash>{a, a ′ } σ (M ,J) = Π da, da ′ , (C.3</trash>


				</figure>

				<figure>
					<figDesc>) where the Poisson tensor Π : Ω 1 × Ω 1 → A is the A-bilinear map that is defined by the following extension of σ lin M : PS</figDesc>
					<trash>lin p (M ) × PS lin p (M ) → R, for all a ⊗ λ, a ′ ⊗ λ ′ ∈ Ω 1 , Π a ⊗ λ, a ′ ⊗ λ ′ := σ lin M (λ, λ ′ ) a a ′ . (C.4)</trash>


				</figure>

				<figure>
					<figDesc>On the A-module Ω 1 there is a canonical connection ∇ : Ω 1 → Ω 1 ⊗ A Ω 1 specified by linearity and, for all a ⊗ λ ∈ Ω 1 , ∇(a ⊗ λ) := (1 ⊗ λ) ⊗ A (da) . (C.5)</figDesc>

				</figure>

				<p>The Leibniz rule ∇(ω a) = ∇(ω) a + ω ⊗ A da, for all ω ∈ Ω 1 and a ∈ A, is obviously satisfied. The torsion of ∇ is the A-module homomorphism T : Ω 1 → Ω 2 defined by, for all ω ∈</p>

				<figure>
					<trash>Ω 1 , T(ω) := ∧ ∇(ω) + dω . (C.6)</trash>

					<figDesc>One easily checks that the canonical connection ∇ is torsion free. The curvature of ∇ is the Amodule homomorphism R : Ω 1 → Ω 1 ⊗ A Ω 2 defined by, for all ω ∈ Ω 1 , R(ω) := ∇ 2 (ω) := ∇∇(ω) . (C.7) When applying ∇ the second time, the usual extension ∇ : Ω 1 ⊗ A Ω • → Ω 1 ⊗ A Ω @BULLET+1 defined by linearity and, for all ω ⊗ A ω ′ ∈ Ω 1 ⊗ A Ω • ,</figDesc>
					<trash>∇(ω ⊗ A ω ′ ) := (id Ω 1 ⊗ ∧) ∇(ω) ⊗ A ω ′ + ω ⊗ A dω ′ (C.8)</trash>


				</figure>

				<p>is implicitly understood. One easily checks that the canonical connection ∇ is flat, i.e., R = 0. As a last property, notice the canonical connection preserves the Poisson tensor Π, i.e. the A-bilinear map Q : Ω 1 × Ω 1 → Ω 1 defined by, for all ω, ω ′ ∈</p>

				<figure>
					<trash>Ω 1 , Q(ω, ω ′ ) := d Π ω, ω ′ − Π ∇(ω), ω ′ − Π ω, ∇(ω ′ ) (C.9) vanishes. 9</trash>


				</figure>

				<p>To sum up, we have shown that the canonical connection ∇ : Ω 1 → Ω 1 ⊗ A Ω 1 is a flat and torsion free Poisson connection.</p>

				<p>As the next step, we consider the tensor module E := ∞ n=0 Ω 1 ⊗ n A , which is an N 0 -graded A-module that describes tensor fields on A. The connection ∇ on Ω 1 lifts to a connection on E = ∞ n=0 E n via a recursive construction: On E 0 ≃ A we choose the connection ∇ 0 : A → A⊗ A Ω 1 ≃ Ω 1 given by the differential d. On E 1 = Ω 1 we take the canonical connection ∇ 1 = ∇ : Ω 1 → Ω 1 ⊗ A Ω 1 .</p>

				<p>Given a connection ∇ n on E n = Ω 1 ⊗ A · · ·⊗ A Ω 1 (n-times) we construct a connection ∇ n+1 : E n+1 → E n+1 ⊗ A Ω 1 on E n+1 = E n ⊗ A Ω 1 by linearity and setting, for all ω ⊗ A ω ′ ∈ E n ⊗ A Ω 1 ,</p>

				<figure>
					<trash>∇ n+1 (ω ⊗ A ω ′ ) := (id E n ⊗ τ ) ∇ n (ω) ⊗ A ω ′ + ω ⊗ A ∇ 1 (ω ′ ) , (C.10)</trash>

					<figDesc>where τ : Ω 1 ⊗ A Ω 1 → Ω 1 ⊗ A Ω 1 is the flip map, for all ω ⊗ A ω ′ , τ (ω ⊗ A ω ′ ) = ω ′ ⊗ A ω. To simplify the notation, we shall denote the resulting connection on E by ∇ E and notice that we can regard it as a linear map (of degree 1) ∇ E : E → E.</figDesc>

				</figure>

				<p>Since ∇ is a flat and torsion free Poisson connection, we can define an associative ⋆-product on the complexification of A (denoted with abuse of notation also by A), for all a, a ′ ∈</p>

				<figure>
					<trash>A, a ⋆ (Π,∇) a ′ := ∞ n=0 1 n! i 2 n Π n ∇ n E (a), ∇ n E (a ′ ) . (C.11)</trash>


				</figure>

				<p>Here ∇ n E denotes the n-times iterated application of ∇ E and Π n : E n × E n → A is the A-bilinear map specified by, for all ω 1 ,</p>

				<figure>
					<trash>. . . , ω n , ω ′ 1 , . . . , ω ′ n ∈ Ω 1 , Π n ω 1 ⊗ A · · · ⊗ A ω n , ω ′ 1 ⊗ A · · · , ⊗ A ω ′ n := Π(ω 1 , ω ′ 1 ) · · · Π(ω n , ω ′ n ) (C.12) and Π 0</trash>


				</figure>

				<p>(a, a ′ ) = a a ′ , for all a, a ′ ∈ A. Notice that the sum in (C.11) terminates, since a, a ′ ∈ A are polynomials, hence ∇ m E (a) = 0 and ∇ m ′ E (a ′ ) = 0 for sufficiently large m, m ′ ∈ N (see also (C.13) below). Furthermore, the ⋆-product ⋆ (Π,∇) is hermitian if we equip A with the involution * defined by [(ϕ 1 , α 1 )] · · · [(ϕ n , α n )] * = [(ϕ 1 , α 1 )] · · · [(ϕ n , α n )] and C-antilinear extension.</p>

				<p>It remains to show that the ⋆-product (C.11) coincides with the product in QA p (M , J ), which is defined in (7.1). For the elements [(ϕ, α)] m ∈ A we find, for all k ≤ m, ∇ k E [(ϕ, α)] m = m! (m − k)! [(ϕ, α)] m−k ⊗ [ϕ]</p>

				<figure>
					<trash>lin ⊗k , (C.13) and for k &gt; m, ∇ k E [(ϕ, α)] m = 0. Plugging this into (C.11) we obtain, for all [(ϕ, α)] m , [(ϕ ′ , α ′ )] n ∈ A, [(ϕ, α)] m ⋆ (Π,∇) [(ϕ ′ , α ′ )] n = min(m,n) k=0 iσ lin M ([ϕ]</trash>


				</figure>

				<p>lin , [ϕ ′ ] lin ) 2 k m! n! k! (m − k)! (n − k)! [(ϕ, α)] m−k [(ϕ</p>

				<figure>
					<figDesc>′ , α ′ )] n−k . (C.14)</figDesc>

				</figure>

				<p>This shows that the products (C.11) and (7.1) coincide.</p>

				<p>In view of this direct construction of the ⋆-product (C.11) given above, the application of fullfledged Fedosov quantization [Fed94] to our model is not required. However, we shall now focus on this quantization method using our algebraic approach developed in this appendix, as this will clarify certain issues in an earlier treatment of this subject [SDH14]. The basic structure entering Fedosov&apos;s approach is a bundle of CCR-algebras over a symplectic (or regular Poisson) manifold.</p>

				<p>In our algebraic approach this bundle is given by the A-module W</p>

				<figure>
					<trash>:= S ⊗ A (Ω 1 ), where S ⊗ A (Ω 1 ) 9 In (C.9) we have extended the Poisson tensor Π : Ω 1 × Ω 1 → A to A-bilinear maps (Ω 1 ⊗A Ω 1 ) × Ω 1 → Ω 1 and Ω 1 × (Ω 1 ⊗A Ω 1 ) → Ω 1 (denoted by the same symbol) by setting Π(ω ⊗A ω ′ , ω ′′ ) := Π(ω, ω ′′ ) ω ′ and Π(ω, ω ′ ⊗A ω ′′ ) := Π(ω, ω ′ ) ω ′′ , for all ω, ω ′ , ω ′′ ∈ Ω 1 .</trash>


				</figure>

				<p>is the (complexified) symmetric tensor algebra with respect to the tensor product ⊗ A of the Amodule of one-forms Ω 1 on A.</p>

				<figure>
					<trash>Using that Ω 1 = PA p (M , J ) ⊗ PS lin p (M ), W is isomorphic to PA p (M , J ) ⊗ S PS lin p (M ) . We shall suppress this isomorphism. Notice that S PS lin p (M ) is the vector space underlying the CCR-algebra B := CQA lin p (M ) = CCR PS lin p</trash>

					<figDesc>(M ) – the quantum algebra of observables of the homogeneous theory – hence, we can equip the A-module W = A ⊗ B with a (noncommutative) product, for all a ⊗ b, a ′ ⊗ b ′ ∈ A ⊗ B,</figDesc>
					<trash>(a ⊗ b) (a ′ ⊗ b ′ ) := (a a ′ ) ⊗ (b ⋆ b ′ ) . (C.15)</trash>


				</figure>

				<p>Notice that A can be identified with a commutative subalgebra of W via A → W , a → a ⊗ 1. Fedosov&apos;s idea is to characterize a subalgebra A ⋆ of W in such a way that A ⋆ is isomorphic to A as a vector space and that the induced product on A ⋆ is a deformation quantization of the Poisson structure on A. To achieve this goal, the first step is to construct a suitable connection on W as follows: Given the canonical connection ∇ on Ω 1 , we can induce a tensor product connection ∇ W on W via the prescription outlined in (C.10). This connection extends analogously to (C.8) to a linear map ∇ W : W ⊗ A Ω • → W ⊗ A Ω @BULLET+1 . Notice that W ⊗ A Ω • is an N 0 -graded algebra (the grading is inherited from that of differential forms Ω • ) by setting, for all w⊗ A ω, w ′ ⊗ A ω ′ ∈ W ⊗ A Ω • , (w⊗ A ω) (w ′ ⊗ A ω ′ ) = (w w ′ )⊗ A (ω ω ′ ). It is easy to check that ∇ W is flat, i.e. R W = ∇ 2 W = 0, since it is the tensor product connection of our flat canonical connection ∇ on Ω 1 . Furthermore, ∇ W satisfies the graded Leibniz rule on the N 0 -graded algebra, for all homogeneous elements w • , w @BULLET′ ∈ W ⊗ A Ω • ,</p>

				<figure>
					<trash>∇ W w • w @BULLET′ = ∇ W (w • ) w @BULLET′ + (−1) |w • | w • ∇ W (w @BULLET′ ) . (C.16)</trash>


				</figure>

				<p>Thus, ∇ W structures W ⊗ A Ω • as a differential graded algebra. Fedosov&apos;s idea [Fed94] is now to modify ∇ W into a differential D : W ⊗ A Ω • → W ⊗ A Ω @BULLET+1 , such that the kernel ker(D) ∩ W, which is a unital * -algebra under the product inherited from W ⊗ A Ω • , gives the desired deformation quantization of A. Because ∇ W is flat, this construction drastically simplifies and we do not have to take into account the corrections by curvature dependent terms as in [Fed94]. The Fedosov differential for our model is given by D := −δ + ∇ W , (C.17) where δ : W ⊗ A Ω • → W ⊗ A Ω @BULLET+1 is the A-module homomorphism defined by linearity and, for all a ⊗ [ϕ 1 ] lin · · · [ϕ n ]</p>

				<figure>
					<trash>lin ⊗ λ ∈ A ⊗ B ⊗ • PS lin p (M ) ≃ W ⊗ A Ω • , δ a ⊗ [ϕ 1 ]</trash>


				</figure>

				<p>lin · · · [ϕ n ] lin ⊗ λ = n j=1 a ⊗ [ϕ 1 ] lin · · · j ∨ . · · · [ϕ n ] lin ⊗ [ϕ j ] lin ∧ λ . (C.18) It is easy to check that δ satisfies the graded Leibniz rule, δ 2 = 0 and δ • ∇ W + ∇ W • δ = 0, from which it follows that D is a differential on W ⊗ A Ω • .</p>

				<p>We now come to the characterization of the kernel ker(D) ∩ W. Like in [Fed94], we are making use of the A-module homomorphism δ * : W ⊗ A Ω • → W ⊗ A Ω @BULLET−1 defined by linearity and, for all a ⊗ b ⊗ [ϕ 1 ] lin ∧ · · · ∧ [ϕ n ]</p>

				<figure>
					<trash>lin ∈ A ⊗ B ⊗ • PS lin p (M ) ≃ W ⊗ A Ω • , δ * a ⊗ b ⊗ [ϕ 1 ]</trash>


				</figure>

				<p>lin ∧ · · · ∧ [ϕ n ] lin = n j=1 (−1) j+1 a ⊗ b [ϕ j ] lin ⊗ [ϕ 1 ] lin ∧ · · · j ∨ . · · · ∧ [ϕ n ] lin .</p>

				<p>(C.19) It is easy to check that δ * 2 = 0 and that δ * • δ + δ • δ * = (n + m) id, when acting on homogeneous elements a ⊗ [ϕ 1 ] lin · · · [ϕ n ] lin ⊗ [ϕ n+1 ] lin ∧ · · · ∧ [ϕ n+m ] lin . The latter property implies that δ −1 • δ + δ • δ −1 + σ = id W⊗ A Ω • (C.20) on all of W ⊗ A Ω • , where δ −1 : W ⊗ A Ω • → W ⊗ A Ω @BULLET−1 is defined on homogeneous elements by δ −1 = δ * /(n + m) for n + m = 0 and δ −1 = 0 for n + m = 0. The linear map σ : W ⊗ A Ω • → A is the projection defined by σ(a ⊗ 1 ⊗ 1) = a and σ(a ⊗ b ⊗ λ) = 0 if the degree of b or λ is not equal to zero. Following the proof of Fedosov [Fed94], we can show that the map σ : ker(D) ∩ W → A is bijective, i.e. that for any a ∈ A there exists a unique w ∈ W, such that D(w) = 0 and σ(w) = a.</p>

				<p>We briefly sketch the relevant steps: Let w ∈ W be such that 0 = D(w) = −δw + ∇ W (w). Applying δ −1 and using (C.20) this yields the equation</p>

				<figure>
					<trash>w = σ(w) + δ −1 ∇ W (w) . (C.21)</trash>


				</figure>

				<p>Notice that σ(w) has degree (0, 0) according to the natural grading (n, m) on W ⊗ A Ω • discussed above. The map ∇ W increases the form-degree by one (n, m) → (n, m + 1), while the map δ −1 decreases the form-degree by one and increases the B-degree by one (n, m) → (n + 1, m − 1). Hence, δ −1 • ∇ W increases the B-degree by one (n, m) → (n + 1, m) and equation (C.21) can be solved uniquely by iteration for any initial condition σ(w) = a (since A is a polynomial algebra this requires just a finite number of iterations). For any initial condition σ(w) = a ∈ A, the solution w to (C.21) satisfies D(w) = 0 as a consequence of D being a differential, cf. [Fed94]. This establishes the bijection σ : ker(D) ∩ W → A and we define a ⋆-product on A by setting, for all a, a ′ ∈</p>

				<figure>
					<trash>A, a ⋆ F a ′ := σ σ −1 (a) σ −1 (a ′ ) , (C.22)</trash>


				</figure>

				<p>where the product between σ −1 (a) and σ −1 (a ′ ) is of course taken in W.</p>

				<p>It remains to show that (C.22) coincides with the product (7.1). For this let us take [(ϕ, α)] m ∈ A and notice that σ −1 [(ϕ, α)] m = m j=0 m j [(ϕ, α)] m−j ⊗ [ϕ]</p>

				<figure>
					<trash>lin j . (C.23)</trash>


				</figure>

				<p>From this expression and a slightly tedious calculation one obtains that [(ϕ, α)] m ⋆ F [(ϕ</p>

				<figure>
					<trash>′ , α ′ )] n = σ σ −1 [(ϕ, α)] m σ −1 [(ϕ ′ , α ′ )] n = [(ϕ, α)] m ⋆ [(ϕ ′ , α ′ )] n , (C.24)</trash>


				</figure>

				<p>where the product on the right hand side is (7.1). So the three products (7.1), (C.11) and (C.22) all coincide on the complexification of PA p (M , J ) and hence give the same quantum algebra QA p (M , J ).</p>

				<p>To conclude, we make some remarks on the quantization prescription pursued in [SDH14], which is described as being a Fedosov quantization, but in fact differs in essential respects from the Fedosov method [Fed94]. Briefly, the method of [SDH14] is to construct a bundle A of infinitesimal Weyl algebras over an affine space V , equipped with a Poisson structure, and then to define the quantized algebra as the algebra of flat sections in A with respect to a certain connection. While this basic idea matches exactly with the Fedosov construction, the starting point chosen in [SDH14] is an affine connection on the tangent bundle of V with prescribed affine parallel transport maps between all fibres. The problem with this choice is that the affine connection does not dualize to the cotangent bundle and in particular not to the bundle of infinitesimal Weyl algebras A. 10 This issue is sidestepped in [SDH14], by regarding elements of the infinitesimal Weyl algebras as symmetric polynomials acting on the vector space V 0 on which V is modeled, which permits a unique parallel transport between fibres in A to be defined. This could be regarded as a slightly ad hoc mixture of the quantized and classical theories, because V 0 is analogous to the classical solution space of the homogeneous theory. By contrast, our prescriptions for improved theories are based on classical structures in the classical case and quantum structures in the quantum case. The connection thus employed in [SDH14] is much more rigid than that of [Fed94], which does not integrate to a unique parallel transport between fibres (see [Fed94, p. 222]). 11 With these thoughts in mind, the approach in [SDH14] might be better described as &apos;Fedosov-inspired&apos; rather than an application of Fedosov&apos;s method as such; nonetheless, this procedure does lead to the correct &apos;improved algebra&apos;.</p>

			</div>

			<note place="foot">* Present address: Department of Mathematics, Heriot-Watt University, Edinburgh EH14 4AS, United Kingdom. Maxwell Institute for Mathematical Sciences, Edinburgh, United Kingdom. The Tait Institute, Edinburgh, United Kingdom. Email: as880@hw.ac.uk Supported by a Research Fellowship of Deutsche Forschungsgemeinschaft (DFG).</note>

			<note place="foot" n="1"> In Appendix B, however, we explain a formulation using pointed presymplectic spaces.</note>

			<note place="foot" n="2"> In [BDS14a] this functor was denoted by PhSp and it was called the &quot; phase space functor &quot; . We avoid this notation in our present work, since the presymplectic vector spaces obtained by PhSp are just labeling spaces for functionals and not what one typically calls the phase space (i.e. the space of initial data or the space of solutions).</note>

			<note place="foot" n="4"> For clarity, in this discussion we shall indicate the LocSrcp object with respect to which the equivalence relation is understood.</note>

			<note place="foot" n="5"> Note that the derivative of the relative Cauchy evolution involves minus the derivative of the Klein–Gordon operator. The BFV paper [BFV03] contains an error [or unconventional terminology] on p.61, where an advanced solution is given support in the causal future of the source, leading to the opposite overall sign in the analogous expression for the derivative on p.62 and hence in their Theorem 4.3. 6 The minus sign before the functional derivative appears because we differentiate with respect to the covariant form of the metric.</note>

			<note place="foot" n="7"> The stress-energy tensor does not actually belong to the algebras we have considered; here we have in mind an extended (quantum) algebra containing (Wick) products.</note>

			<note place="foot" n="8"> Identifying M diffeomorphically with a product manifold of form R × Σ, so that {t} × Σ is spacelike for all t, a strip of M is any subset of the form I × Σ where I ⊂ R is a closed interval.</note>

			<note place="foot" n="10"> The correct dualization would be to the vector dual bundle of the tangent bundle regarded in the category of affine bundles, but this would lead to the following logical problem: Instead of replacing the problem of quantizing affine Poisson spaces by quantizing linear Poisson spaces (which Fedosov&apos;s method does, as explained above), the choice of affine connection in [SDH14] replaces the problem of quantizing affine Poisson spaces by quantizing affine Poisson spaces in the fibres.</note>

			<note place="foot" n="11"> Unique parallel transport depends on theorems on existence and uniqueness of solutions to differential equations that do not necessarily apply to bundles with infinite-dimensional fibres (beyond the Banach case). A related point is that [Fed94] obtains a deformation of the algebra of all smooth functions on the classical phase space, while the result of [SDH14] is more analogous to a deformation of an algebra of certain polynomial functions. In our algebraic version of Fedosov&apos;s procedure, the restriction to polynomial functions appears naturally; it should also be possible to extend our construction to cover Wick polynomials by modifying the underlying Poisson algebra, but without modifying the fibre algebras, whereas the corresponding extension of [SDH14] would require modification of the fibres.</note>
		</body>
		<back>

			<div type="acknowledgement">
				<head>Acknowledgements</head>
				<p>AS would like to thank the Department of Mathematics of the University of York for hospitality during a visit in September 2013. CJF and AS thank the Mathematisches Forschungsinstitut Oberwolfach for support and hospitality during the Mini-Workshop &quot; New Crossroads between Mathematics and Field Theory &quot; , at which this work commenced, and also thank the workshop organizers. CJF thanks Atsushi Higuchi, Daniel Siemssen and Katarzyna Rejzner for useful discussions. We</p>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">Introduction to algebraic and constructive quantum field theory,&apos; Princeton Series in Physics</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<forename type="middle">[ Bsz92 ] J C E</forename>
				<surname>Baez</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Segal</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Zhou</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1992" />
			<publisher>Princeton University Press</publisher>
			<pubPlace>Princeton</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Perturbative Algebraic Quantum Field Theory and the Renormalization Groups</title>
		<author>
			<persName>
				<surname>Bdf09 ] R</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Brunetti</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Duetsch</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Fredenhagen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Theor. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">1541</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">A C * -algebra for quantized principal U (1)-connections on globally hyperbolic Lorentzian manifolds</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">[ Bdhs13 ] M</forename>
				<surname>Benini</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T.-P</forename>
				<surname>Dappiaggi</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Hack</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Schenkel</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Com- munications in Mathematical Physics</title>
		<imprint/>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Quantum field theory on affine bundles</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">M</forename>
				<surname>Bds14a</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Benini</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Dappiaggi</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Schenkel</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annales Henri Poincaré</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="171" to="211" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Quantized Abelian principal connections on Lorentzian manifolds</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Benini</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Dappiaggi</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Schenkel</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">330</biblScope>
			<biblScope unit="issue">123</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">On structure of the algebra of field operators</title>
		<author>
			<persName>
				<forename type="first">] H.-J</forename>
				<surname>Bor62</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Borchers</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nuovo Cimento</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="214" to="236" />
			<date type="published" when="1962" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m" type="main">Quantum gravity from the point of view of locally covariant quantum field theory</title>
		<author>
			<persName>
				<surname>Bfr13 ] R</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Brunetti</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Fredenhagen</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Rejzner</surname>
			</persName>
		</author>
		<imprint/>
	</monogr>
	<note>math. -ph]</note>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">The generally covariant locality principle: A New paradigm for local quantum field theory</title>
		<author>
			<persName>
				<surname>Bfv03 ] R</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Brunetti</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Fredenhagen</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Verch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">237</biblScope>
			<biblScope unit="page">31</biblScope>
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">A Simple geometrical construction of deformation quantization</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">B V</forename>
				<surname>Fed94</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Fedosov</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Diff. Geom</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page">213</biblScope>
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Dynamical Locality of the nonminimally coupled scalar field and enlarged algebra of Wick polynomials</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">M</forename>
				<surname>Fer13</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Ferguson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annales Henri Poincaré</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">853</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
	<note>math. -ph/1203.2151]</note>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Quantum energy inequalities and local covariance. II. Categorical formula- tion</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">C J</forename>
				<surname>Few07</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Fewster</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Gen. Rel. Grav</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page">1855</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Endomorphisms and automorphisms of locally covariant quantum field theories</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">C J</forename>
				<surname>Few13</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Fewster</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Rev. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page">1350008</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Quantum energy inequalities and local covariance. I. Globally hyperbolic spacetimes</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">[ Fp06 ] C J J</forename>
				<surname>Fewster</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Pfenning</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">47</biblScope>
			<biblScope unit="page">082303</biblScope>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Batalin-Vilkovisky formalism in perturbative algebraic quantum field theory</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">[ Fr13 ] K</forename>
				<surname>Fredenhagen</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Rejzner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">317</biblScope>
			<biblScope unit="issue">697</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Dynamical locality and covariance: What makes a physical theory the same in all spacetimes?</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">C J</forename>
				<surname>Fv12a</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Fewster</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Verch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annales Henri Poincare</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">161311064785</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Dynamical locality of the free scalar field</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">C J</forename>
				<surname>Fv12b</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Fewster</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Verch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annales Henri Poincare</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">1675</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Local Wick polynomials and time ordered products of quantum fields in curved space-time</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">[ Hw01 ] S M</forename>
				<surname>Hollands</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Wald</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">223</biblScope>
			<biblScope unit="page">289</biblScope>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Existence of local covariant time ordered products of quan- tum fields in curved space-time</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">[ Hw02 ] S M</forename>
				<surname>Hollands</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Wald</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">231</biblScope>
			<biblScope unit="page">309</biblScope>
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Conservation of the stress tensor in interacting quantum field theory in curved spacetimes</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">[ Hw05 ] S M</forename>
				<surname>Hollands</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Wald</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Rev. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page">227</biblScope>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">Quantum Field Theory</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">[ Iz80 ] C B</forename>
				<surname>Itzykson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Zuber</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1980" />
			<publisher>McGraw-Hill</publisher>
			<pubPlace>New York, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Translation-invariant linear forms and a formula for the Dirac measure</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">G H</forename>
				<surname>Mei71</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Meisters</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Functional Analysis</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="173" to="188" />
			<date type="published" when="1971" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">The commutation laws of relativistic field theory</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">E</forename>
				<surname>Peierls</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Roy. Soc. A 214</title>
		<meeting>. Roy. Soc. A 214</meeting>
		<imprint>
			<date type="published" when="1952" />
			<biblScope unit="page" from="143" to="157" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">Scale-Invariant Curvature Fluctuations from an Extended Semiclassical Gravity</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">N</forename>
				<surname>Ps13a</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Pinamonti</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Siemssen</surname>
			</persName>
		</author>
		<imprint/>
	</monogr>
	<note>gr. -qc]</note>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">Global Existence of Solutions of the Semiclassical Einstein Equation</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">N</forename>
				<surname>Ps13b</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Pinamonti</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Siemssen</surname>
			</persName>
		</author>
		<imprint/>
	</monogr>
	<note>math. -ph]</note>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Electromagnetism, local covariance, the Aharonov-Bohm effect and Gauss&apos; law</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">[ Sdh14 ] K</forename>
				<surname>Sanders</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T.-P</forename>
				<surname>Dappiaggi</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Hack</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">3286420</biblScope>
			<biblScope unit="issue">625</biblScope>
			<biblScope unit="page">1211</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
	<note>math. -ph]]</note>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">¨ Uber die Definition der Quantenfelder nach Wightman und Haag</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">A</forename>
				<surname>Uhl62</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Uhlmann</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Wiss. Zeit. Karl Marx Univ</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="213" to="217" />
			<date type="published" when="1962" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">A spin statistics theorem for quantum fields on curved space-time manifolds in a generally covariant framework</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">R</forename>
				<surname>Ver01</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Verch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Math. Phys</title>
		<imprint>
			<biblScope unit="volume">223</biblScope>
			<biblScope unit="page">261</biblScope>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title level="m" type="main">Local covariance, renormalization ambiguity, and local thermal equilibrium in cosmology, &quot; in Quantum Field Theory and Gravity. Conceptual and mathematical advances in the search for a unified framework</title>
		<author>
			<persName>
				<forename type="first">]</forename>
				<forename type="middle">R</forename>
				<surname>Ver12</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Verch</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Finster</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Mü</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Nardmann</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Tolksdorf</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Zeidler</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="229" to="256" />
		</imprint>
	</monogr>
	<note>gr. -qc]]</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
